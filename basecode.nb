(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    259637,       6046]
NotebookOptionsPosition[    258364,       6010]
NotebookOutlinePosition[    259150,       6035]
CellTagsIndexPosition[    259107,       6032]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Minor", " ", "Modules"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.688413374061702*^9, 3.688413375285242*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getTransQ", "[", 
     RowBox[{
     "\[CapitalDelta]c_", ",", "U_", ",", "popsize_", ",", "exactflag_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q0", ",", "ssq"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q0", "=", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"popsize", " ", "\[CapitalDelta]c"}], "]"}], "/", 
          RowBox[{"Log", "[", 
           RowBox[{"\[CapitalDelta]c", "/", "U"}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "[", "q_", "]"}], ":=", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"Log", "[", 
            RowBox[{"popsize", " ", "q", " ", "\[CapitalDelta]c"}], "]"}]}], 
          RowBox[{"Log", "[", 
           RowBox[{
            FractionBox["\[CapitalDelta]c", "U"], 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"q", "-", "1"}], ")"}], 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Pi]", "/", "q"}], "]"}]}], 
             RowBox[{"\[Pi]", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"EulerGamma", " ", "/", "q"}], "]"}]}]]}], "]"}]], "-",
          "q"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ssq", "=", 
        RowBox[{"If", "[", 
         RowBox[{"exactflag", ",", 
          RowBox[{"q", "/.", 
           RowBox[{
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{"f", "[", "q", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"q", ",", "q0"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", "q0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "ssq"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTransV", "[", 
    RowBox[{
    "\[CapitalDelta]c_", ",", "U_", ",", "popsize_", ",", "exactflag_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q0", ",", "\[Tau]0", ",", "v0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q0", "=", 
       RowBox[{"getTransQ", "[", 
        RowBox[{
        "\[CapitalDelta]c", ",", "U", ",", "popsize", ",", "exactflag"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]0", "=", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"q0", "-", "1"}], ")"}], "\[CapitalDelta]c"}]], 
        RowBox[{"Log", "[", 
         RowBox[{
          FractionBox["\[CapitalDelta]c", "U"], " ", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"q0", "-", "1"}], ")"}], 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Pi]", "/", "q0"}], "]"}]}], 
           RowBox[{"\[Pi]", " ", 
            RowBox[{"Exp", "[", 
             RowBox[{"EulerGamma", "/", "q0"}], " ", "]"}]}]]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"v0", "=", 
       FractionBox["\[CapitalDelta]c", "\[Tau]0"]}], ";", 
      "\[IndentingNewLine]", "v0"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printRegimeDetails", "[", 
    RowBox[{
    "\[CapitalDelta]c1_", ",", "\[CapitalDelta]c2_", ",", "U1_", ",", "U2_", 
     ",", "popsize_", ",", "exactflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", "SRflag", ",", "t", ",", "v"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Or", "[", 
          RowBox[{
           RowBox[{"U1", "\[Equal]", "0"}], ",", 
           RowBox[{"\[CapitalDelta]c1", "\[Equal]", "0"}]}], "]"}], ",", "0", 
         ",", 
         RowBox[{"getTransQ", "[", 
          RowBox[{
          "\[CapitalDelta]c1", ",", "U1", ",", "popsize", ",", "exactflag"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SRflag", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Or", "[", 
          RowBox[{
           RowBox[{"U1", "\[Equal]", "0"}], ",", 
           RowBox[{"\[CapitalDelta]c1", "\[Equal]", "0"}]}], "]"}], ",", 
         "True", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"popsize", " ", "\[CapitalDelta]c1"}], "]"}], "/", 
             RowBox[{"Log", "[", 
              RowBox[{"\[CapitalDelta]c1", "/", "U1"}], "]"}]}]}], "<", " ", 
           "2"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Or", "[", 
          RowBox[{
           RowBox[{"U1", "\[Equal]", "0"}], ",", 
           RowBox[{"\[CapitalDelta]c1", "\[Equal]", "0"}]}], "]"}], ",", "0", 
         ",", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"\[CapitalDelta]c1", "/", "U1"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[CapitalDelta]c1", " ", 
            RowBox[{"(", 
             RowBox[{"q", "-", "1"}], ")"}]}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Or", "[", 
          RowBox[{
           RowBox[{"U1", "\[Equal]", "0"}], ",", 
           RowBox[{"\[CapitalDelta]c1", "\[Equal]", "0"}]}], "]"}], ",", "0", 
         ",", 
         RowBox[{
          SuperscriptBox["\[CapitalDelta]c1", "2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"q", "-", "1"}], ")"}], "/", 
           RowBox[{"Log", "[", 
            RowBox[{"\[CapitalDelta]c1", "/", "U1"}], "]"}]}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Trait 1 q = \>\"", ",", "q", ",", "\"\< in \>\"", ",", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "[", 
           RowBox[{
            RowBox[{"U1", "\[Equal]", "0"}], ",", 
            RowBox[{"\[CapitalDelta]c1", "\[Equal]", "0"}]}], "]"}], ",", 
          "\"\< No Evolution Regime \>\"", ",", 
          RowBox[{"If", "[", 
           RowBox[{
           "SRflag", ",", "\"\<Successional Regime\>\"", ",", 
            "\"\<Concurrent Mutations Regime\>\""}], "]"}]}], "]"}], ",", 
        " ", "\"\< with expected time scale \>\"", ",", "t", ",", " ", 
        "\"\< and rate of adaptation \>\"", ",", "v"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Or", "[", 
          RowBox[{
           RowBox[{"U2", "\[Equal]", "0"}], ",", 
           RowBox[{"\[CapitalDelta]c2", "\[Equal]", "0"}]}], "]"}], ",", "0", 
         ",", 
         RowBox[{"getTransQ", "[", 
          RowBox[{
          "\[CapitalDelta]c2", ",", "U2", ",", "popsize", ",", "exactflag"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SRflag", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Or", "[", 
          RowBox[{
           RowBox[{"U2", "\[Equal]", "0"}], ",", 
           RowBox[{"\[CapitalDelta]c2", "\[Equal]", "0"}]}], "]"}], ",", 
         "True", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"popsize", " ", "\[CapitalDelta]c2"}], "]"}], "/", 
             RowBox[{"Log", "[", 
              RowBox[{"\[CapitalDelta]c2", "/", "U2"}], "]"}]}]}], "<", " ", 
           "2"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Or", "[", 
          RowBox[{
           RowBox[{"U2", "\[Equal]", "0"}], ",", 
           RowBox[{"\[CapitalDelta]c2", "\[Equal]", "0"}]}], "]"}], ",", "0", 
         ",", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"\[CapitalDelta]c2", "/", "U2"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[CapitalDelta]c2", " ", 
            RowBox[{"(", 
             RowBox[{"q", "-", "1"}], ")"}]}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Or", "[", 
          RowBox[{
           RowBox[{"U2", "\[Equal]", "0"}], ",", 
           RowBox[{"\[CapitalDelta]c2", "\[Equal]", "0"}]}], "]"}], ",", "0", 
         ",", 
         RowBox[{
          SuperscriptBox["\[CapitalDelta]c2", "2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"q", "-", "1"}], ")"}], "/", 
           RowBox[{"Log", "[", 
            RowBox[{"\[CapitalDelta]c2", "/", "U2"}], "]"}]}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Trait 2 q = \>\"", ",", "q", ",", "\"\< in \>\"", ",", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "[", 
           RowBox[{
            RowBox[{"U2", "\[Equal]", "0"}], ",", 
            RowBox[{"\[CapitalDelta]c2", "\[Equal]", "0"}]}], "]"}], ",", 
          "\"\< No Evolution Regime \>\"", ",", 
          RowBox[{"If", "[", 
           RowBox[{
           "SRflag", ",", "\"\<Successional Regime\>\"", ",", 
            "\"\<Concurrent Mutations Regime\>\""}], "]"}]}], "]"}], ",", 
        " ", "\"\< with expected time scale \>\"", ",", "t", ",", " ", 
        "\"\< and rate of adaptation \>\"", ",", "v"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintTauDetails", "[", 
    RowBox[{
    "\[CapitalDelta]c_", ",", "U_", ",", "popsize_", ",", "exactflag_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q0", ",", "\[Tau]0", ",", "meantau", ",", "vartau"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q0", "=", 
       RowBox[{"getTransQ", "[", 
        RowBox[{
        "\[CapitalDelta]c", ",", "U", ",", "popsize", ",", "exactflag"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"meantau", "=", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"q0", "-", "1"}], ")"}], "\[CapitalDelta]c"}]], 
        RowBox[{"Log", "[", 
         RowBox[{
          FractionBox["\[CapitalDelta]c", "U"], " ", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"q0", "-", "1"}], ")"}], 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Pi]", "/", "q0"}], "]"}]}], 
           RowBox[{"\[Pi]", " ", 
            RowBox[{"Exp", "[", 
             RowBox[{"EulerGamma", "/", "q0"}], " ", "]"}]}]]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vartau", "=", " ", 
       RowBox[{
        FractionBox[
         SuperscriptBox["\[Pi]", "2"], "6"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"q0", "-", "1"}], ")"}], " ", "\[CapitalDelta]c"}], 
             ")"}], "2"]], "-", 
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q0", " ", "\[CapitalDelta]c"}], ")"}], "2"]]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Expected \[Tau] = \>\"", ",", "meantau", ",", 
        "\"\<, with variance = \>\"", ",", "vartau"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getInitialDFdistribution", "[", 
    RowBox[{"popsize_", ",", "\[CapitalDelta]c_", ",", "U_", ",", "trait_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q0", ",", "\[Tau]0", ",", "DFgenotypes", ",", "DFabundances"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q0", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"2", " ", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"popsize", " ", "\[CapitalDelta]c"}], "]"}], "/", 
          RowBox[{"Log", "[", 
           RowBox[{"\[CapitalDelta]c", "/", "U"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Tau]0", "=", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"\[CapitalDelta]c", "/", "U"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"\[CapitalDelta]c", 
          RowBox[{"(", 
           RowBox[{"q0", "-", "1"}], ")"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DFabundances", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "i"}], " ", "\[CapitalDelta]c", " ", "\[Tau]0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"Abs", "[", 
               RowBox[{"q0", "-", "j"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", " ", "q0"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DFabundances", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"popsize", "/", 
          RowBox[{"Total", "[", "DFabundances", "]"}]}], ")"}], 
        "DFabundances"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DFgenotypes", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"trait", "\[Equal]", "1"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "+", "i"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{
              RowBox[{"2", " ", "q0"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"1", "+", "i"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{
              RowBox[{"2", " ", "q0"}], "-", "1"}]}], "}"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"DFgenotypes", ",", "DFabundances"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getInitial2Ddistribution", "[", 
    RowBox[{
    "n_", ",", "popsize_", ",", "\[CapitalDelta]c1_", ",", 
     "\[CapitalDelta]c2_", ",", "U1_", ",", "U2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "genotypes2D", ",", "abundances2D", ",", "t1", ",", "t2", ",", 
       "\[Tau]1", ",", "\[Tau]2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "here", " ", "n", " ", "is", " ", "the", " ", "length", " ", "of", " ", 
       "the", " ", "wedge", " ", "along", " ", "each", " ", "dimension"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[CapitalDelta]c1", " ", "\[Equal]", "0"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"U1", "\[Equal]", "0"}], ")"}]}], ",", 
       RowBox[{"getInitialDFdistribution", "[", 
        RowBox[{"popsize", ",", "\[CapitalDelta]c2", ",", "U2", ",", "2"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[CapitalDelta]c2", " ", "\[Equal]", "0"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"U2", "\[Equal]", "0"}], ")"}]}], ",", 
       RowBox[{"getInitialDFdistribution", "[", 
        RowBox[{"popsize", ",", "\[CapitalDelta]c1", ",", "U1", ",", "1"}], 
        "]"}], ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"genotypes2D", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Tau]1", "=", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Log", "[", 
            RowBox[{"\[CapitalDelta]c1", "/", "U1"}], "]"}], "2"], "/", 
          RowBox[{"(", 
           RowBox[{"\[CapitalDelta]c1", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                RowBox[{"popsize", " ", "\[CapitalDelta]c1"}], "]"}]}], "-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[CapitalDelta]c1", "/", "U1"}], "]"}]}], ")"}]}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Tau]2", "=", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Log", "[", 
            RowBox[{"\[CapitalDelta]c2", "/", "U2"}], "]"}], "2"], "/", 
          RowBox[{"(", 
           RowBox[{"\[CapitalDelta]c2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                RowBox[{"popsize", " ", "\[CapitalDelta]c2"}], "]"}]}], "-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[CapitalDelta]c2", "/", "U2"}], "]"}]}], ")"}]}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"genotypes2D", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"genotypes2D", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"j", ",", "i"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"n", "-", "j", "+", "1"}]}], "}"}]}], "]"}]}], 
             "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"abundances2D", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"t1", ",", "t2"}], "}"}], "=", 
             RowBox[{"genotypes2D", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"t1", 
                  RowBox[{"(", 
                   RowBox[{"t1", "-", "1"}], ")"}], "\[CapitalDelta]c1", " ", 
                  "\[Tau]1"}], "+", 
                 RowBox[{"t2", 
                  RowBox[{"(", 
                   RowBox[{"t2", "-", "1"}], ")"}], "\[CapitalDelta]c2", " ", 
                  "\[Tau]2"}]}], ")"}]}], "/", "2.0"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "genotypes2D", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"abundances2D", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"popsize", "/", 
            RowBox[{"Total", "[", "abundances2D", "]"}]}], ")"}], 
          "abundances2D"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"genotypes2D", ",", "abundances2D"}], "}"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getUniqueGenotype", "[", "genotypeElem_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"genotypeElem", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", 
      RowBox[{"10", "^", "i"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testGenoType", "[", 
    RowBox[{"genotype_", ",", "fitnesscriteria_", ",", "indx_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"genotype", "[", 
       RowBox[{"[", "indx", "]"}], "]"}], "\[Equal]", "fitnesscriteria"}], 
     ",", "True", ",", "False"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getMaxTraitValue", "[", 
    RowBox[{"genotypes_", ",", "traitnumber_"}], "]"}], ":=", 
   RowBox[{"Max", "[", 
    RowBox[{"genotypes", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "traitnumber"}], "]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getMinTraitValue", "[", 
    RowBox[{"genotypes_", ",", "traitnumber_"}], "]"}], ":=", 
   RowBox[{"Min", "[", 
    RowBox[{"genotypes", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "traitnumber"}], "]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"groupNewMutantsList", "[", "newmutantgenotypes_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sortedmutantlist", ",", "mutantparentlist"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sortedmutantlist", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"newmutantgenotypes", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"{", "}"}], ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "newmutantgenotypes", "]"}]}], "}"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"mutantparentlist", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"newmutantgenotypes", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "==", 
              RowBox[{
               RowBox[{"sortedmutantlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"sortedmutantlist", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"sortedmutantlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mutantparentlist", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "2"}], "]"}], "]"}], "}"}]}], "]"}]}], 
            ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "mutantparentlist", "]"}]}], "}"}]}], 
          "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "sortedmutantlist", "]"}]}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "sortedmutantlist"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getNumGenotypes", "[", "genotypes_", "]"}], ":=", 
  RowBox[{"Length", "[", "genotypes", "]"}]}]}], "Input",
 CellChangeTimes->{{3.688412471806587*^9, 3.6884124739186907`*^9}, {
   3.6884132220453863`*^9, 3.688413269712187*^9}, {3.688413500791074*^9, 
   3.6884135113346977`*^9}, {3.688413551542964*^9, 3.688413552382203*^9}, {
   3.688413624055681*^9, 3.68841365115879*^9}, {3.688413734422659*^9, 
   3.688413752695053*^9}, {3.688413791375156*^9, 3.68841384148593*^9}, {
   3.688416450710711*^9, 3.6884164662284517`*^9}, {3.689022809875592*^9, 
   3.689022894822641*^9}, {3.689022985796865*^9, 3.6890230361401987`*^9}, 
   3.68902350645082*^9, {3.689023538898521*^9, 3.6890235912829323`*^9}, {
   3.689023824555873*^9, 3.689023825017283*^9}, {3.68936074856649*^9, 
   3.689360862614729*^9}, {3.689360921734653*^9, 3.689360967022915*^9}, {
   3.689360997238782*^9, 3.689361049622375*^9}, {3.689361084100686*^9, 
   3.689361382991395*^9}, {3.6893649535009527`*^9, 3.6893650064649467`*^9}, {
   3.689432984987524*^9, 3.689433049354416*^9}, {3.6894331198100224`*^9, 
   3.689433387880692*^9}, {3.689433433456827*^9, 3.689433439856921*^9}, {
   3.689433524816661*^9, 3.689433623697349*^9}, {3.689433670927103*^9, 
   3.689433791735464*^9}, {3.6894338475605392`*^9, 3.689433873462957*^9}, {
   3.689434129974052*^9, 3.6894341471895*^9}, {3.689434485803258*^9, 
   3.689434495203923*^9}, {3.689439513123231*^9, 3.689439527746624*^9}, {
   3.689440389854795*^9, 3.689440393510035*^9}, {3.689440448566277*^9, 
   3.689440449191861*^9}, {3.689541048214299*^9, 3.689541417470614*^9}, {
   3.6896134559829807`*^9, 3.689613459873115*^9}, {3.689613543486578*^9, 
   3.6896135751904373`*^9}, {3.689618656735084*^9, 3.689618657319641*^9}, {
   3.6896191061374903`*^9, 3.689619143497912*^9}, {3.6896191810974913`*^9, 
   3.689619222921636*^9}, {3.689619257809943*^9, 3.689619258846815*^9}, {
   3.689619310402206*^9, 3.689619325532127*^9}, {3.689619396522592*^9, 
   3.689619424585968*^9}, {3.689619467931018*^9, 3.6896194747700453`*^9}, {
   3.6896195255712214`*^9, 3.689619528754867*^9}, {3.689619563674999*^9, 
   3.689619593491666*^9}, {3.6896196342995663`*^9, 3.689619636147263*^9}, {
   3.689632284004088*^9, 3.689632317779997*^9}, {3.689632349116199*^9, 
   3.689632351396144*^9}, {3.689632386044806*^9, 3.689632421412462*^9}, {
   3.6896324624846478`*^9, 3.6896324760069237`*^9}, {3.689632563013093*^9, 
   3.689632570365114*^9}, {3.689632671164804*^9, 3.689632809998295*^9}, {
   3.689632859990484*^9, 3.6896329163827972`*^9}, {3.68963294835081*^9, 
   3.68963322546914*^9}, {3.6896332794566298`*^9, 3.689633321409637*^9}, {
   3.6896334816095257`*^9, 3.689633492572557*^9}, 3.689633543346375*^9, {
   3.689633664266124*^9, 3.689633702146152*^9}, {3.689633759499207*^9, 
   3.689633890267881*^9}, {3.689634034419132*^9, 3.689634039580454*^9}, {
   3.689706687444705*^9, 3.689706911104314*^9}, {3.689707073394923*^9, 
   3.689707210089472*^9}, {3.689707240793353*^9, 3.689707250250153*^9}, {
   3.689707315267625*^9, 3.689707337633005*^9}, {3.689707377504327*^9, 
   3.689707487812552*^9}, {3.689707520147138*^9, 3.689707557602331*^9}, {
   3.689707590765932*^9, 3.689707632867414*^9}, {3.68970806155194*^9, 
   3.6897080622809668`*^9}, {3.6897095864918537`*^9, 
   3.6897096478396606`*^9}, {3.689964826877388*^9, 3.689965131196097*^9}, {
   3.6899651732121687`*^9, 3.689965187253381*^9}, {3.689965217659198*^9, 
   3.689965330415948*^9}, {3.689965457246358*^9, 3.6899655263415422`*^9}, {
   3.689969275991559*^9, 3.689969280756843*^9}, {3.690031822355171*^9, 
   3.690031936450992*^9}, {3.690031973683144*^9, 3.6900321004704437`*^9}, {
   3.690032137915729*^9, 3.690032372837318*^9}, {3.6900324485413513`*^9, 
   3.690032453507702*^9}, {3.690141666854476*^9, 3.69014174288325*^9}, {
   3.690141784862824*^9, 3.6901418726060133`*^9}, {3.690143905194457*^9, 
   3.690143999954196*^9}, {3.694539188448215*^9, 3.694539197760193*^9}, {
   3.697464349799634*^9, 3.697464372709033*^9}, {3.698078688117323*^9, 
   3.698078688557488*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"collectMyData", "[", 
    RowBox[{
    "dataamount_", ",", "globaltime_", ",", "addtime_", ",", "genotypes_", 
     ",", "genotypeabundances_", ",", "popsize_", ",", "\[CapitalDelta]c1_", 
     ",", "\[CapitalDelta]c2_", ",", "mutpfix_", ",", "mutgenotype_"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "timestamp", ",", "meanfitness", ",", " ", "trait1meanfitness", ",", 
       "trait2meanfitness", ",", "fitnessvariance", ",", 
       "trait1fitnessvariance", ",", "trait2fitnessvariance", ",", 
       "traitfitnesscovariances", ",", "subload", ",", "truepopsize", ",", 
       "mutboundary", ",", "linkagedisequilibria", ",", "genotypefrequencies",
        ",", "unitmatrix"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timestamp", "=", 
       RowBox[{"globaltime", "+", "addtime"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"changetype", " ", "indicates", " ", "0"}], "=", "start"}], 
        ",", 
        RowBox[{"1", "=", "adapt"}], ",", 
        RowBox[{"2", "=", "env"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"COLLECT", " ", "SUMMARY", " ", "DATA", " ", 
         RowBox[{"ONLY", ":", " ", 
          RowBox[{"{", 
           RowBox[{"TIMESTAMP", ",", " ", 
            RowBox[{"MEAN", " ", "FITNESSES"}], ",", " ", "VARIANCES", ",", 
            " ", "COVARIANCES", ",", " ", 
            RowBox[{"SUBSTITUTIONAL", " ", "LOAD"}]}], "}"}]}]}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dataamount", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"truepopsize", "=", 
          RowBox[{"Total", "[", "genotypeabundances", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mutboundary", "=", 
          RowBox[{"getNextMutants", "[", 
           RowBox[{
           "genotypes", ",", "genotypeabundances", ",", "\[CapitalDelta]c1", 
            ",", "\[CapitalDelta]c2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mutboundary", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mutboundary", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "mutboundary", "]"}]}], "}"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"mutboundary", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"genotypes", ",", "mutboundary"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"trait1meanfitness", "=", 
          RowBox[{"\[CapitalDelta]c1", " ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], 
              RowBox[{
               RowBox[{"genotypeabundances", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"trait2meanfitness", "=", 
          RowBox[{"\[CapitalDelta]c2", " ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], 
              RowBox[{
               RowBox[{"genotypeabundances", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"meanfitness", "=", 
          RowBox[{"1", "+", "trait1meanfitness", "+", "trait2meanfitness"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"traitfitnesscovariances", "=", 
          RowBox[{"(", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalDelta]c1", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                "trait1meanfitness"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalDelta]c2", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], " ", "-", 
                "trait2meanfitness"}], ")"}], 
              RowBox[{
               RowBox[{"genotypeabundances", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}], 
           ")"}]}], " ", ";", "\[IndentingNewLine]", 
         RowBox[{"trait1fitnessvariance", "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalDelta]c1", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                "trait1meanfitness"}], ")"}], "2"], " ", 
             RowBox[{
              RowBox[{"genotypeabundances", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"trait2fitnessvariance", "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalDelta]c2", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "-", 
                "trait2meanfitness"}], ")"}], "2"], " ", 
             RowBox[{
              RowBox[{"genotypeabundances", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"fitnessvariance", "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"\[CapitalDelta]c1", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                RowBox[{"\[CapitalDelta]c2", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "-", "meanfitness"}], 
               ")"}], "2"], " ", 
             RowBox[{
              RowBox[{"genotypeabundances", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"subload", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"\[CapitalDelta]c1", " ", 
                 RowBox[{
                  RowBox[{"mutboundary", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                RowBox[{"\[CapitalDelta]c2", " ", 
                 RowBox[{
                  RowBox[{"mutboundary", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "-", 
              "meanfitness"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "mutboundary", "]"}]}], "}"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"linkagedisequilibria", "=", " ", 
          RowBox[{"genotypefrequencies", " ", "-", " ", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"subload", "<", "0"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<boundary and genotypes are \>\"", ",", "mutboundary", 
                ",", "\"\<, abundances are \>\"", ",", "genotypeabundances", 
                ",", "\"\<, mean fitness = \>\"", ",", "meanfitness", ",", 
                "\"\<, fit1= \>\"", ",", "trait1meanfitness", ",", 
                "\"\<, fit2= \>\"", ",", "trait2meanfitness"}], "]"}], ";"}], 
             ",", "Null"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Sow", "[", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "timestamp", ",", "trait1meanfitness", ",", "trait2meanfitness", 
              ",", "meanfitness", ",", "traitfitnesscovariances", ",", 
              "trait1fitnessvariance", ",", "trait2fitnessvariance", ",", 
              "fitnessvariance", ",", "subload", ",", "truepopsize", ",", 
              "mutpfix", ",", "mutgenotype"}], "}"}], ",", "16"}], "]"}], 
          "]"}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"COLLECT", " ", "ALL", " ", 
          RowBox[{"DATA", ":", " ", 
           RowBox[{"{", 
            RowBox[{
            "TIMESTAMP", ",", " ", "GENOTYPES", ",", " ", 
             "GENOTYPEABUNDANCES"}], "}"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dataamount", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"truepopsize", "=", 
          RowBox[{"Total", "[", "genotypeabundances", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"trait1meanfitness", "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"genotypes", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{
              RowBox[{"genotypeabundances", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"trait2meanfitness", "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"genotypes", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{
              RowBox[{"genotypeabundances", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Sow", "[", 
          RowBox[{"{", 
           RowBox[{
           "timestamp", ",", "genotypes", ",", "genotypeabundances", ",", 
            RowBox[{"{", 
             RowBox[{"trait1meanfitness", ",", "trait2meanfitness"}], "}"}], 
            ",", "mutgenotype"}], "}"}], "]"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"dataamount", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"unitmatrix", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "#1", " ", "#2"}]}], ")"}], " ", "&"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "-", 
                RowBox[{"Min", "[", 
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "+", "1"}], 
               ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "-", 
                RowBox[{"Min", "[", 
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "+", 
                "1"}]}], "}"}]}], "]"}], "\[Transpose]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genotypefrequencies", "=", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"0", "#1", " ", "#2"}], ")"}], " ", "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"genotypes", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "-", 
               RowBox[{"Min", "[", 
                RowBox[{"genotypes", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "+", "1"}], 
              ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"genotypes", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "-", 
               RowBox[{"Min", "[", 
                RowBox[{"genotypes", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "+", "1"}]}],
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"genotypefrequencies", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"Min", "[", 
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "+", "1"}], 
               ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"Min", "[", 
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "+", 
                "1"}]}], "]"}], "]"}], "=", 
            RowBox[{"genotypeabundances", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"genotypefrequencies", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"Total", "[", 
              RowBox[{"Flatten", "[", "genotypefrequencies", "]"}], "]"}]}], 
            ")"}], "genotypefrequencies"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"linkagedisequilibria", "=", 
          RowBox[{"genotypefrequencies", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"genotypefrequencies", ".", "unitmatrix"}], ")"}], ".", 
            "genotypefrequencies"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"truepopsize", "=", 
          RowBox[{"Total", "[", "genotypeabundances", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mutboundary", "=", 
          RowBox[{"getNextMutants", "[", 
           RowBox[{
           "genotypes", ",", "genotypeabundances", ",", "\[CapitalDelta]c1", 
            ",", "\[CapitalDelta]c2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mutboundary", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mutboundary", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "mutboundary", "]"}]}], "}"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"mutboundary", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"genotypes", ",", "mutboundary"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"trait1meanfitness", "=", 
          RowBox[{"\[CapitalDelta]c1", " ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], 
              RowBox[{
               RowBox[{"genotypeabundances", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"trait2meanfitness", "=", 
          RowBox[{"\[CapitalDelta]c2", " ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], 
              RowBox[{
               RowBox[{"genotypeabundances", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"meanfitness", "=", 
          RowBox[{"1", "+", "trait1meanfitness", "+", "trait2meanfitness"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"traitfitnesscovariances", "=", 
          RowBox[{"(", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalDelta]c1", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                "trait1meanfitness"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalDelta]c2", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], " ", "-", 
                "trait2meanfitness"}], ")"}], 
              RowBox[{
               RowBox[{"genotypeabundances", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}], 
           ")"}]}], " ", ";", "\[IndentingNewLine]", 
         RowBox[{"trait1fitnessvariance", "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalDelta]c1", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                "trait1meanfitness"}], ")"}], "2"], " ", 
             RowBox[{
              RowBox[{"genotypeabundances", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"trait2fitnessvariance", "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalDelta]c2", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "-", 
                "trait2meanfitness"}], ")"}], "2"], " ", 
             RowBox[{
              RowBox[{"genotypeabundances", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"fitnessvariance", "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"\[CapitalDelta]c1", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                RowBox[{"\[CapitalDelta]c2", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "-", "meanfitness"}], 
               ")"}], "2"], " ", 
             RowBox[{
              RowBox[{"genotypeabundances", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"subload", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"\[CapitalDelta]c1", " ", 
                 RowBox[{
                  RowBox[{"mutboundary", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                RowBox[{"\[CapitalDelta]c2", " ", 
                 RowBox[{
                  RowBox[{"mutboundary", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "-", 
              "meanfitness"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "mutboundary", "]"}]}], "}"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"subload", "<", "0"}], ",", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<boundary and genotypes are \>\"", ",", "mutboundary", ",", 
              "\"\<, abundances are \>\"", ",", "genotypeabundances", ",", 
              "\"\<, mean fitness = \>\"", ",", "meanfitness", ",", 
              "\"\<, fit1= \>\"", ",", "trait1meanfitness", ",", 
              "\"\<, fit2= \>\"", ",", "trait2meanfitness"}], "]"}], ";"}], 
           ",", "Null"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Sow", "[", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "timestamp", ",", "trait1meanfitness", ",", "trait2meanfitness", 
              ",", "meanfitness", ",", "traitfitnesscovariances", ",", 
              "trait1fitnessvariance", ",", "trait2fitnessvariance", ",", 
              "fitnessvariance", ",", "subload", ",", "truepopsize", ",", 
              "mutpfix", ",", "mutgenotype", ",", "linkagedisequilibria"}], 
             "}"}], ",", "16"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.676057217710558*^9, 3.676057257543845*^9}, {
   3.676057313582016*^9, 3.676057330942709*^9}, {3.6760574615549297`*^9, 
   3.6760574839326487`*^9}, {3.676139454986308*^9, 3.67613947117892*^9}, 
   3.679678585386517*^9, {3.6796793377317533`*^9, 3.679679355731744*^9}, 
   3.679679397947184*^9, {3.679679514947815*^9, 3.679679549708643*^9}, {
   3.679679659508453*^9, 3.679679722403511*^9}, {3.679679765539963*^9, 
   3.6796798085641212`*^9}, {3.679680042637319*^9, 3.679680045044932*^9}, {
   3.6797465829771423`*^9, 3.679746607425165*^9}, 3.6797481496574306`*^9, {
   3.67974857410098*^9, 3.6797485776874113`*^9}, {3.679748804526732*^9, 
   3.679748875214695*^9}, {3.680264010592164*^9, 3.680264026418696*^9}, {
   3.688413387638962*^9, 3.68841339254344*^9}, {3.688413536310575*^9, 
   3.688413537304462*^9}, {3.688499283941951*^9, 3.688499409020886*^9}, {
   3.688499661363214*^9, 3.688499719266878*^9}, {3.68849978660354*^9, 
   3.688499802258658*^9}, {3.688499845250732*^9, 3.688499888178404*^9}, {
   3.688499946490108*^9, 3.688500020954081*^9}, {3.688500100177619*^9, 
   3.688500122641273*^9}, {3.6885004343420877`*^9, 3.688500445143436*^9}, {
   3.688500479135149*^9, 3.6885008203978767`*^9}, {3.688500859214384*^9, 
   3.68850094380514*^9}, {3.68850097563783*^9, 3.688501171965311*^9}, {
   3.6885012110843077`*^9, 3.688501220183997*^9}, {3.688501255708239*^9, 
   3.688501264566325*^9}, {3.688501372667622*^9, 3.688501447819745*^9}, {
   3.688501491420123*^9, 3.688501674579803*^9}, {3.688501711722807*^9, 
   3.6885018429386787`*^9}, {3.688501893162464*^9, 3.6885019020103607`*^9}, {
   3.688501959818295*^9, 3.6885023485532618`*^9}, {3.6885024203688498`*^9, 
   3.688502559223229*^9}, {3.688699770775094*^9, 3.6886997743551693`*^9}, {
   3.688699808835582*^9, 3.688699813280896*^9}, {3.688701414293068*^9, 
   3.688701442878735*^9}, {3.688701599287324*^9, 3.688701606645568*^9}, {
   3.688701716110155*^9, 3.6887017202034388`*^9}, {3.6887018808592243`*^9, 
   3.688701906301113*^9}, {3.688739898802807*^9, 3.688740023523638*^9}, {
   3.688740056579624*^9, 3.688740102652411*^9}, {3.688740584387495*^9, 
   3.688740598176127*^9}, {3.6887534527274513`*^9, 3.688753498066927*^9}, {
   3.688753529303651*^9, 3.688753552337517*^9}, {3.689357067141979*^9, 
   3.689357113071896*^9}, {3.689358014326524*^9, 3.689358026646245*^9}, {
   3.68936723099859*^9, 3.689367295135015*^9}, {3.68936767931957*^9, 
   3.689367743903286*^9}, {3.689368439959461*^9, 3.6893684610554047`*^9}, 
   3.6893694823203573`*^9, {3.689426175940833*^9, 3.689426179619925*^9}, {
   3.689438319399035*^9, 3.6894383483341007`*^9}, {3.6894383809185257`*^9, 
   3.6894384143431587`*^9}, {3.689438458061956*^9, 3.689438527757937*^9}, {
   3.689439018755101*^9, 3.689439038435278*^9}, {3.689439077731921*^9, 
   3.689439084692482*^9}, {3.6894393932025213`*^9, 3.68943939822511*^9}, {
   3.68944125248882*^9, 3.68944128930484*^9}, {3.689441349080769*^9, 
   3.689441377855089*^9}, {3.6894414162966337`*^9, 3.689441475904031*^9}, {
   3.6894415471995583`*^9, 3.689441589521233*^9}, {3.6894416363593073`*^9, 
   3.689441656759499*^9}, {3.68945384971353*^9, 3.6894539376576653`*^9}, {
   3.689453995648777*^9, 3.6894540523572283`*^9}, {3.689454084224292*^9, 
   3.689454099161302*^9}, {3.690032573498331*^9, 3.6900326055951443`*^9}, {
   3.690032652730451*^9, 3.6900327068579407`*^9}, {3.697201610544409*^9, 
   3.697201629032106*^9}, {3.697201659344121*^9, 3.697201761929751*^9}, {
   3.697201820425222*^9, 3.697201824762344*^9}, {3.697202277075926*^9, 
   3.697202282146859*^9}, {3.6972023556298723`*^9, 3.697202507437818*^9}, {
   3.6972025912544622`*^9, 3.6972026616620903`*^9}, {3.6972027095663767`*^9, 
   3.6972027288871098`*^9}, {3.69720276373482*^9, 3.697202768046702*^9}, {
   3.697202803239305*^9, 3.697202829726984*^9}, {3.697202945607668*^9, 
   3.697203050121335*^9}, 3.697203102144354*^9, {3.6972031473522577`*^9, 
   3.697203295874695*^9}, {3.697203345530189*^9, 3.697203362129621*^9}, {
   3.6972035675803347`*^9, 3.69720392073985*^9}, {3.697203950972847*^9, 
   3.697203999015189*^9}, {3.697204065349353*^9, 3.697204084869459*^9}, {
   3.697463676163353*^9, 3.697463777876505*^9}, {3.6974638248527203`*^9, 
   3.6974638338207693`*^9}, {3.697465455568074*^9, 3.697465498597948*^9}, {
   3.697554920317305*^9, 3.6975549569740562`*^9}, {3.69936959164509*^9, 
   3.699369654389179*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"myCovDSelectionTest", "[", 
    RowBox[{
    "popsize_", ",", "\[CapitalDelta]c1_", ",", "\[CapitalDelta]c2_", ",", 
     "genotypes_", ",", "genotypeabundances_", ",", "tsim_", ",", "tstep_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "system", ",", "sol", ",", "unitmatrix", ",", "steps", ",", 
       "tempabundances", ",", "genotypefrequencies", ",", " ", 
       "linkagedisequilibria", ",", "dr1", ",", "dr2", ",", "result", ",", 
       "trait1meanfitness", ",", "trait2meanfitness", ",", "meanfitness", ",",
        "truepopsize", ",", "traitfitnesscovariances", ",", "mintrait1", ",", 
       "mintrait2", ",", "maxtrait1", ",", "maxtrait2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Module", " ", "evolves", " ", "population", " ", "using", " ", 
       "SolvDiffEqs", " ", "and", " ", "returns", " ", "dynamics", " ", 
       "traitcovariance", " ", "at", " ", "tstep", " ", "sampling", " ", 
       "points"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "set", " ", "initial", " ", "values", " ", "of", " ", "module", " ", 
       "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mintrait1", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"genotypes", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mintrait2", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"genotypes", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxtrait1", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"genotypes", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxtrait2", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"genotypes", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"unitmatrix", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"0", "#1", " ", "#2"}]}], ")"}], " ", "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"maxtrait1", "-", "mintrait1", "+", "1"}], ",", 
            RowBox[{"maxtrait2", "-", "mintrait2", "+", "1"}]}], "}"}]}], 
         "]"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"tsim", "/", "tstep"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"system", ",", "sol"}], "}"}], "=", 
       RowBox[{"SolveDiffEqs", "[", 
        RowBox[{
        "popsize", ",", "\[CapitalDelta]c1", ",", "\[CapitalDelta]c2", ",", 
         "genotypeabundances", ",", "genotypes", ",", "tsim"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Sample", " ", "covariance", " ", "and", " ", "D", " ", "over", " ", 
        "time"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempabundances", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ToExpression", "[", 
                 RowBox[{"\"\<n\>\"", "<>", 
                  RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<[t]\>\""}], 
                 "]"}], "/.", 
                RowBox[{"sol", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/.", 
              RowBox[{"t", "\[Rule]", 
               RowBox[{"tstep", " ", "i"}]}]}], ")"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"truepopsize", "=", 
          RowBox[{"Total", "[", "tempabundances", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genotypefrequencies", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", " ", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"maxtrait1", "-", "mintrait1", "+", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"maxtrait2", "-", "mintrait2", "+", "1"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"genotypefrequencies", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", "mintrait1", "+", "1"}],
                ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "mintrait2", "+", 
                "1"}]}], "]"}], "]"}], "=", 
            RowBox[{"tempabundances", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"genotypefrequencies", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"Total", "[", 
              RowBox[{"Flatten", "[", "genotypefrequencies", "]"}], "]"}]}], 
            ")"}], "genotypefrequencies"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"linkagedisequilibria", "=", 
          RowBox[{"genotypefrequencies", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"genotypefrequencies", ".", "unitmatrix"}], ")"}], ".", 
            "genotypefrequencies"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"trait1meanfitness", "=", 
          RowBox[{"\[CapitalDelta]c1", " ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], 
              RowBox[{
               RowBox[{"tempabundances", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", 
               RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"trait2meanfitness", "=", 
          RowBox[{"\[CapitalDelta]c2", " ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], 
              RowBox[{
               RowBox[{"tempabundances", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", 
               RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"meanfitness", "=", 
          RowBox[{"1", "+", "trait1meanfitness", "+", "trait2meanfitness"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"traitfitnesscovariances", "=", 
          RowBox[{"(", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalDelta]c1", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                "trait1meanfitness"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalDelta]c2", " ", 
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], " ", "-", 
                "trait2meanfitness"}], ")"}], 
              RowBox[{
               RowBox[{"tempabundances", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", 
               RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}], 
           ")"}]}], " ", ";", "\[IndentingNewLine]", 
         RowBox[{"dr1", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[CapitalDelta]c1", " ", "k"}], "-", 
              "trait1meanfitness"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"Min", "[", 
               RowBox[{"genotypes", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"Max", "[", 
               RowBox[{"genotypes", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dr2", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[CapitalDelta]c2", " ", "k"}], "-", 
              "trait2meanfitness"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"Min", "[", 
               RowBox[{"genotypes", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"Max", "[", 
               RowBox[{"genotypes", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"result", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", " ", "tstep"}], ",", " ", 
               "traitfitnesscovariances", ",", "dr1", ",", "dr2", ",", 
               "linkagedisequilibria"}], "}"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Clear", "[", 
          RowBox[{
          "traitfitnesscovariances", ",", "dr1", ",", "dr2", ",", 
           "linkagedisequilibria"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "steps"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.697492879579562*^9, 3.697492880775054*^9}, {
   3.697492912179634*^9, 3.6974931582772303`*^9}, {3.69749341636062*^9, 
   3.697493497838881*^9}, 3.697493569591435*^9, {3.697493630511785*^9, 
   3.69749364769062*^9}, {3.6974937008525753`*^9, 3.697493723019567*^9}, {
   3.697493757242775*^9, 3.697493816019052*^9}, {3.697494215725171*^9, 
   3.697494266630381*^9}, {3.697550071587494*^9, 3.697550241701522*^9}, {
   3.6975502783248653`*^9, 3.697550331918643*^9}, {3.697550462118266*^9, 
   3.697550558262113*^9}, {3.697550609206573*^9, 3.697550626915189*^9}, {
   3.697550678510469*^9, 3.697550742150857*^9}, {3.6975507775591097`*^9, 
   3.697550900424364*^9}, {3.697550983617723*^9, 3.6975510164000883`*^9}, {
   3.697551247290629*^9, 3.697551392291383*^9}, 3.6975517563969593`*^9, {
   3.697551826405629*^9, 3.697551858469455*^9}, {3.697551929646141*^9, 
   3.697551931846189*^9}, {3.6975535690298862`*^9, 3.697553577734013*^9}, {
   3.697553628871169*^9, 3.697553650422496*^9}, {3.6975537206152*^9, 
   3.697553753119067*^9}, {3.6975537886464357`*^9, 3.69755378984766*^9}, {
   3.697553887872011*^9, 3.6975539124873667`*^9}, {3.697554141360876*^9, 
   3.697554154760168*^9}, {3.697554248697392*^9, 3.697554327049959*^9}, {
   3.697554357233953*^9, 3.697554500138239*^9}, 3.697554563147287*^9, {
   3.697554639643402*^9, 3.697554777731946*^9}, {3.697554837347722*^9, 
   3.6975548732363977`*^9}, {3.697554972668679*^9, 3.697554988588969*^9}, {
   3.6994599575774937`*^9, 3.699459963766165*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getMeanPDF", "[", "results_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "truepopsize", ",", "trait1mean", ",", "trait2mean", ",", "meanPDF", 
       ",", "matchflag"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"initialize", " ", "local", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"meanPDF", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"matchflag", "=", "False"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Loop", " ", "through", " ", "all", " ", "possible", " ", "results"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"truepopsize", " ", "=", " ", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"results", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"trait1mean", "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"results", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"trait2mean", "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"results", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "For", " ", "each", " ", "result", " ", "run", " ", "through", 
             " ", "current", " ", "list", " ", "in", " ", "meanPDF"}], ",", 
            " ", 
            RowBox[{"check", " ", "if", " ", 
             RowBox[{"fit", ".", "class"}], " ", "present"}], ",", " ", 
            RowBox[{
            "then", " ", "add", " ", "abundance", " ", "or", " ", 
             "update"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Do", "[", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Run", " ", "through", " ", "list", " ", "of", " ", "current", 
               " ", "meanPDF"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"meanPDF", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "0"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"meanPDF", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "=", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"meanPDF", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "-", 
                    RowBox[{"{", 
                    RowBox[{"trait1mean", ",", "trait2mean"}], "}"}]}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"meanPDF", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "=", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"meanPDF", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "truepopsize"}], ")"}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"meanPDF", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "-", 
                    RowBox[{"{", 
                    RowBox[{"trait1mean", ",", "trait2mean"}], "}"}]}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"meanPDF", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "l", "]"}], "]"}], "+=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "truepopsize"}], ")"}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}]}], ";", " ", 
                    RowBox[{"matchflag", "=", "True"}], ";"}]}], "]"}], 
                  ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", 
                RowBox[{"Max", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"meanPDF", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "}"}]}],
              "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", "matchflag"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"meanPDF", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"meanPDF", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "-", 
                    RowBox[{"{", 
                    RowBox[{"trait1mean", ",", "trait2mean"}], "}"}]}], 
                   "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"meanPDF", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"meanPDF", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "truepopsize"}], ")"}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}],
               ",", 
              RowBox[{"matchflag", "=", "False"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{"results", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "results", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"meanPDF", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"Total", "[", 
           RowBox[{"meanPDF", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], 
        RowBox[{"meanPDF", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "meanPDF"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.69945997186078*^9, 3.699460012177884*^9}, {
   3.699460647894208*^9, 3.6994606613675604`*^9}, {3.6994607170120444`*^9, 
   3.6994607521207485`*^9}, {3.699460792733494*^9, 3.6994608229712915`*^9}, {
   3.699460893358542*^9, 3.699460903520007*^9}, {3.6994609702291927`*^9, 
   3.6994609717443323`*^9}, {3.6994610044241657`*^9, 
   3.6994611748431416`*^9}, {3.699461268094165*^9, 3.6994612950834513`*^9}, {
   3.6994613844559765`*^9, 3.699461485842282*^9}, {3.6994615683213778`*^9, 
   3.6994616133421044`*^9}, {3.6994618504149466`*^9, 
   3.6994619416562104`*^9}, {3.6994619769784536`*^9, 
   3.6994624138505907`*^9}, {3.699462551123654*^9, 3.6994626087161713`*^9}, {
   3.6994627145501847`*^9, 3.6994627210054092`*^9}, {3.699462798150902*^9, 
   3.6994628706728888`*^9}, {3.6994629176282773`*^9, 3.699463035144134*^9}, {
   3.699463105612623*^9, 3.6994631325672708`*^9}, {3.699463172054128*^9, 
   3.6994631798722005`*^9}, {3.699463446865477*^9, 3.6994634582897625`*^9}, {
   3.699463623298255*^9, 3.69946367270846*^9}, {3.699463709319599*^9, 
   3.699463716571039*^9}, {3.699463751634181*^9, 3.699463759993215*^9}, {
   3.69946391487965*^9, 3.699463927070861*^9}, {3.6994640127858205`*^9, 
   3.6994640698546333`*^9}, {3.699464153125561*^9, 3.6994641823524837`*^9}, {
   3.6994642125918813`*^9, 3.699464306533024*^9}, {3.699464368161023*^9, 
   3.699464444476204*^9}, {3.6994644849264*^9, 3.6994644938449116`*^9}, {
   3.6994645470681796`*^9, 3.69946456838107*^9}, 3.699464722124406*^9, {
   3.6994706084158983`*^9, 3.699470646242558*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getRandomFitDistr", "[", 
    RowBox[{
    "popsize_", ",", "trait1range_", ",", "trait2range_", ",", "type_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "maxfitnessclasses", ",", "genotypes", ",", "genotypeabundances"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"maxfitnessclasses", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"trait1range", " ", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"trait1range", " ", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"trait2range", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"trait2range", " ", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"genotypes", "=", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"RandomInteger", "[", 
           RowBox[{"trait1range", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "maxfitnessclasses"}], "}"}]}], "]"}], ",", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"trait2range", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "maxfitnessclasses"}], "}"}]}], "]"}]}], "]"}],
         "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"genotypes", "=", 
       RowBox[{"DeleteDuplicates", "[", "genotypes", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"type", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"genotypeabundances", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ")"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"genotypeabundances", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"popsize", "/", 
             RowBox[{"Total", "[", "genotypeabundances", "]"}]}], ")"}], 
           "genotypeabundances"}]}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{"type", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"genotypeabundances", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"genotypeabundances", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"popsize", "/", 
             RowBox[{"Total", "[", "genotypeabundances", "]"}]}], ")"}], 
           "genotypeabundances"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"genotypes", ",", "genotypeabundances"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.697551942171969*^9, 3.6975520484017067`*^9}, {
   3.697552167826447*^9, 3.697552208618759*^9}, {3.697552251498816*^9, 
   3.697552263163097*^9}, {3.697552296915498*^9, 3.6975524252923117`*^9}, {
   3.6975526608056*^9, 3.69755266370507*^9}, 3.697552709717496*^9, {
   3.697552742317492*^9, 3.697552792366166*^9}, {3.697552860470416*^9, 
   3.697552915550868*^9}, {3.697553204928303*^9, 3.697553264888204*^9}, {
   3.6975533950819597`*^9, 3.697553396341263*^9}, {3.69755515305064*^9, 
   3.697555205467024*^9}, 3.697555241414515*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getSummarizedResults", "[", 
    RowBox[{
    "resultsIndxd_", ",", "\[CapitalDelta]c1_", ",", "\[CapitalDelta]c2_", 
     ",", "popsize_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "timestamp", ",", "mean1", ",", "mean2", ",", "mean", ",", "covar", ",",
        "var1", ",", "var2", ",", "var", ",", "subload", ",", "truepopsize", 
       ",", "types", ",", "abundances", ",", "rbar", ",", "summarizedresults",
        ",", "mutboundary"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"summarizedresults", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "resultsIndxd", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"timestamp", "=", 
          RowBox[{
           RowBox[{"resultsIndxd", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"truepopsize", "=", 
          RowBox[{"Total", "[", "abundances", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mutboundary", "=", 
          RowBox[{"getNextMutants", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"resultsIndxd", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"resultsIndxd", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "\[CapitalDelta]c1", ",", 
            "\[CapitalDelta]c2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mutboundary", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mutboundary", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "mutboundary", "]"}]}], "}"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"mutboundary", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"resultsIndxd", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "mutboundary"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"types", "=", 
          RowBox[{
           RowBox[{"resultsIndxd", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"abundances", "=", 
          RowBox[{
           RowBox[{"resultsIndxd", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mean1", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"resultsIndxd", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mean2", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"resultsIndxd", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rbar", "=", 
          RowBox[{"1", "+", 
           RowBox[{"mean1", " ", "\[CapitalDelta]c1"}], "+", 
           RowBox[{"mean2", " ", "\[CapitalDelta]c2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"covar", "=", 
          RowBox[{"\[CapitalDelta]c1", " ", "\[CapitalDelta]c2", " ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"types", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", "mean1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"types", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "mean2"}], ")"}], 
              RowBox[{
               RowBox[{"abundances", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "types", "]"}]}], "}"}]}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"var1", "=", 
          RowBox[{
           SuperscriptBox["\[CapitalDelta]c1", "2"], "  ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"types", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", "mean1"}], ")"}], "2"], 
              RowBox[{
               RowBox[{"abundances", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "types", "]"}]}], "}"}]}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"var2", "=", 
          RowBox[{
           SuperscriptBox["\[CapitalDelta]c2", "2"], "  ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"types", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", "mean2"}], ")"}], "2"], 
              RowBox[{
               RowBox[{"abundances", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "types", "]"}]}], "}"}]}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"var", " ", "=", " ", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{
                 RowBox[{
                  RowBox[{"types", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "\[CapitalDelta]c1"}], 
                "+", 
                RowBox[{
                 RowBox[{
                  RowBox[{"types", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "\[CapitalDelta]c2"}], 
                "-", "rbar"}], ")"}], "2"], 
             RowBox[{
              RowBox[{"abundances", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/", "truepopsize"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "types", "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"subload", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{
                RowBox[{"mutboundary", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "\[CapitalDelta]c1"}], 
              "+", 
              RowBox[{
               RowBox[{
                RowBox[{"mutboundary", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "\[CapitalDelta]c2"}], 
              "-", "rbar"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "mutboundary", "]"}]}], "}"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"summarizedresults", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"{", 
           RowBox[{"timestamp", ",", 
            RowBox[{"\[CapitalDelta]c1", " ", "mean1"}], ",", 
            RowBox[{"\[CapitalDelta]c2", " ", "mean2"}], ",", "rbar", ",", 
            "covar", ",", "var1", ",", "var2", ",", "var", ",", "subload", 
            ",", "truepopsize", ",", "mutboundary"}], "}"}]}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "resultsIndxd", "]"}]}], "}"}]}], "]"}], ";",
       "\[IndentingNewLine]", "summarizedresults"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6893580316218433`*^9, 3.6893580537226*^9}, {
   3.689358301877377*^9, 3.6893583019428883`*^9}, {3.689358336872244*^9, 
   3.689358337060124*^9}, {3.689614844501265*^9, 3.689614941149366*^9}, {
   3.6896166336530523`*^9, 3.68961664906905*^9}, {3.689616721654586*^9, 
   3.689616735593315*^9}, {3.689616894790782*^9, 3.689616937566642*^9}, {
   3.689616983319069*^9, 3.689616988003171*^9}, {3.689617192000428*^9, 
   3.689617194944036*^9}, {3.690032458192461*^9, 3.69003245912251*^9}, {
   3.690032736833989*^9, 3.690032765059684*^9}, {3.6900328045291157`*^9, 
   3.690032805112669*^9}, 3.697550453517386*^9, 3.699369691076132*^9, {
   3.6993697221243687`*^9, 3.6993697470603857`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SolveDiffEqs", "[", 
    RowBox[{
    "popsize_", ",", "\[CapitalDelta]c1_", ",", "\[CapitalDelta]c2_", ",", 
     "genotypeabundances_", ",", "genotypes_", ",", "timestep_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIABLES"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "C", ",", "diffeqarray", ",", "X", ",", "system", ",", "sol", ",", 
       "numgenotypes", ",", "rbar"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"INITIALIZE", " ", "LOCAL", " ", "VARIABLES"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"C", "=", 
       RowBox[{"genotypeabundances", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numgenotypes", "=", 
       RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"SOLVE", " ", "DETERMINISTIC", " ", "EQUATIONS"}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"numgenotypes", "\[Equal]", "1"}], "\[IndentingNewLine]", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"IF", " ", "ONLY", " ", "ONE", " ", "GENOTYPE"}], ",", " ", 
          
          RowBox[{"THEN", " ", "USE", " ", "EXACT", " ", "SOLUTION"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"system", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              SuperscriptBox["n1", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"n1", "[", "t", "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
                
                RowBox[{
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}]}], 
               ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"n1", "[", "t", "]"}], "/", "popsize"}]}], ")"}]}]}],
             ",", 
            RowBox[{
             RowBox[{"n1", "[", "0", "]"}], "\[Equal]", "C"}]}], "}"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"sol", "=", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"n1", "[", "t", "]"}], "\[Rule]", 
             RowBox[{"popsize", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"popsize", "/", "C"}], "-", "1"}], ")"}], 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"genotypes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], 
                    "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"genotypes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}]}], 
                    ")"}]}], "t"}], "]"}]}], "+", "1"}], ")"}]}]}], "}"}], 
           "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
         "ELSE", " ", "MORE", " ", "THAN", " ", "ONE", " ", "GENOTYPE", " ", 
          "SO", " ", "FORM", " ", "DERIVATIVE", " ", "AND", " ", "HAVE", " ", 
          "MATHEMATICA", " ", "SOLVE", " ", "THE", " ", "SYSTEM"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"X", "[", "t_", "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<n\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<[t]\>\""}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", "numgenotypes", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rbar", "[", "t_", "]"}], "=", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
                
                RowBox[{
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}]}], 
               ")"}], 
              RowBox[{
               RowBox[{"X", "[", "t", "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}], "/", 
           "popsize"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"diffeqarray", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"X", "[", "t", "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}], "-", 
               RowBox[{"rbar", "[", "t", "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"system", " ", "=", " ", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "\[Equal]", "#2"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"X", "[", "t", "]"}], ",", "t"}], "]"}], ",", 
                "diffeqarray"}], "}"}]}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{"see", " ", 
              RowBox[{"tutorial", "/", "DSolveSystemsOfLinearODEs"}]}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "\[Equal]", "#2"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"X", "[", "t", "]"}], "/.", 
                 RowBox[{"t", "\[Rule]", "0"}]}], ",", "genotypeabundances"}],
                "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sol", "=", 
          RowBox[{"NDSolve", "[", 
           RowBox[{"system", ",", " ", 
            RowBox[{"X", "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "timestep"}], "}"}]}], "]"}]}], 
         ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"RETURN", ":", " ", 
        RowBox[{"SYSTEM", " ", "AND", " ", "SOLUTION"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"system", ",", "sol"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQLbC//URf1WtHDosVl0D093l8r0H0ledWYLqAe9tP
EC107wmYltjqztAPpKcXsnOB6CW1X/hA9ImZLQIg+ty5XFEQ3dJ7Qx1EX7qw
VgdEb0k+DqYlMtk9QXR09l0vEC2gvCcURPu+jA0H0euX1USD6J8T38eDaI6d
8d0g+ouW7UQQ/YipYgaYv+nfYhAt08e7BUSbRS3aBaLVnOrjJwDpvLwXCSDa
6/wiYfHq144K721EQTQPW7Y0iNb4MxlM625asRpEz56vugZEB6gs3wKiky/+
BNPrlkustwfSPg89wfSjX3ufgOh8pikvQTQAdfSk+w==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PruneUnfitClasses", "[", 
    RowBox[{"genotypes_", ",", "genotypeabundances_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIABLES"}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "newgenotypes", ",", "newgenotypeabundances", ",", 
       "genotypeskeptindx"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"INITIALIZE", " ", "LOCAL", " ", "VARIABLES"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"genotypeskeptindx", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newgenotypes", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newgenotypeabundances", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "PRUNE", " ", "FITNESS", " ", "CLASSES", " ", "WITH", " ", 
         "ABUNDANCES"}], " ", "<", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i", ">", "0"}], "\[IndentingNewLine]", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
         "RUN", " ", "THROUGH", " ", "GENOTYPE", " ", "LIST", " ", "AND", " ",
           "CHECK", " ", "ABUNDANCES"}], " ", "*)"}], " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"genotypeabundances", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<", "1"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"IF", " ", "genotypeabundance"}], " ", "<", " ", "1"}], 
             ",", " ", 
             RowBox[{
             "GENOTYPE", " ", "WILL", " ", "NOT", " ", "BE", " ", "SAVED", 
              " ", "INTO", " ", "NEW", " ", "LIST"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}], "\[Equal]", "0"}], ",", 
                RowBox[{"newgenotypes", "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"(", "verbose", ")"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{
               "Print", "[", "\"\<WARNING: population extinction!\>\"", "]"}],
                ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"i", "=", 
             RowBox[{"i", "-", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"ELSE", " ", "genotypeabundance"}], " ", ">", " ", 
              "1"}], ",", " ", 
             RowBox[{
             "SO", " ", "SAVE", " ", "TO", " ", "NEW", " ", "LIST"}]}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newgenotypeabundances", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"genotypeabundances", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
               "newgenotypeabundances"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"genotypeskeptindx", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "i", "}"}], ",", "genotypeskeptindx"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"newgenotypes", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"genotypes", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", "newgenotypes"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"i", "=", 
             RowBox[{"i", "-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", 
       RowBox[{"END", "-", "WHILE", "-", "LOOP"}], "*)"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "REPORT", " ", "THE", " ", "NUMBER", " ", "OF", " ", "GENOTYPES", " ", 
        "THAT", " ", "WERE", " ", "DROPPED"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", "veryverbose", ")"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Dropped \>\"", ",", 
           RowBox[{
            RowBox[{"getNumGenotypes", "[", "genotypes", "]"}], "-", 
            RowBox[{"getNumGenotypes", "[", "newgenotypes", "]"}]}], ",", 
           "\"\< unfit genotype class(es) from \>\"", ",", 
           RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], "]"}], 
         ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"RETURN", ":", " ", 
         RowBox[{
         "NEW", " ", "GENOTYPE", " ", "LIST", " ", "AND", " ", "RESPECTIVE", 
          " ", "ABUNDANCES"}]}], ",", " ", 
        RowBox[{
        "AS", " ", "WELL", " ", "AS", " ", "INDICES", " ", "OF", " ", "THOSE",
          " ", "THAT", " ", "WERE", " ", "KEPT", " ", "TO", " ", "REFERENCE", 
         " ", "THEM", " ", "IN", " ", "COMPUTED", " ", "SOLUTIONS"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "newgenotypes", ",", "newgenotypeabundances", ",", 
        "genotypeskeptindx"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getNextMutants", "[", 
    RowBox[{
    "genotypes_", ",", "genotypeabundances_", ",", "\[CapitalDelta]c1_", ",", 
     "\[CapitalDelta]c2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIABLES"}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "trait1min", ",", " ", "trait1max", ",", "trait2min", ",", "trait2max", 
       ",", "newmutantgenotypes", ",", "getFitnessSlice", ",", 
       "trait1fitslice", ",", "trait2fitslice", ",", "trait1new", ",", 
       "trait2new", ",", "trait1mean", ",", "trait2mean"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"INITIALIZE", " ", "LOCAL", " ", "VARIABLES"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"trait1min", ",", "trait1max"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"getMinTraitValue", "[", 
          RowBox[{"genotypes", ",", "1"}], "]"}], ",", 
         RowBox[{"getMaxTraitValue", "[", 
          RowBox[{"genotypes", ",", "1"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"trait2min", ",", "trait2max"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"getMinTraitValue", "[", 
          RowBox[{"genotypes", ",", "2"}], "]"}], ",", 
         RowBox[{"getMaxTraitValue", "[", 
          RowBox[{"genotypes", ",", "2"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newmutantgenotypes", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"trait1mean", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"Total", "[", "genotypeabundances", "]"}]}], ")"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"genotypes", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], 
           RowBox[{"genotypeabundances", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"trait2mean", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"Total", "[", "genotypeabundances", "]"}]}], ")"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"genotypes", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], 
           RowBox[{"genotypeabundances", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "GET", " ", "NEW", " ", "MUTANTS", " ", "ALONG", " ", "SLICES", " ", 
        "IN", " ", "TRAIT", " ", "2", " ", "FITNESS", " ", "DIMENSION"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"getFitnessSlice", "[", "genotypeelem_", "]"}], ":=", 
          RowBox[{"testGenoType", "[", 
           RowBox[{"genotypeelem", ",", "i", ",", "2"}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "This", " ", "function", " ", "will", " ", "choose", " ", "will", 
            " ", "help", " ", "select", " ", "all", " ", "the", " ", 
            "fitness", " ", "classes", " ", "with", " ", "trait2"}], 
           "\[Equal]", "i"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"trait2fitslice", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"genotypes", ",", "getFitnessSlice"}], "]"}]}], ";", "  ", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "select", " ", "all", " ", "fitness", " ", "classes", " ", "with", 
            " ", "trait2"}], "\[Equal]", "i"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"trait2fitslice", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "IF", " ", "RELATIVE", " ", "FITNESS", " ", "SLICES", " ", "IS", 
             " ", "NOT", " ", "EMPTY", " ", "THEN", " ", "CHECK", " ", "IF", 
             " ", "BETTER", " ", "FITNESS", " ", "CLASS", " ", "AT", " ", 
             "BOUNDARY"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"trait1new", ",", "trait2new"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{"trait2fitslice", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "+", "1"}],
                ",", "i"}], "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"getFitnessSlice", "[", "genotypeelem_", "]"}], ":=", 
             RowBox[{"testGenoType", "[", 
              RowBox[{"genotypeelem", ",", "trait1new", ",", "1"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"trait1fitslice", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"genotypes", ",", "getFitnessSlice"}], "]"}]}], ";", 
            "\[IndentingNewLine]", " ", 
            RowBox[{"(*", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Or", "[", 
                RowBox[{
                 RowBox[{"trait2new", ">", 
                  RowBox[{"Max", "[", 
                   RowBox[{"trait1fitslice", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
                 RowBox[{"trait1fitslice", "\[Equal]", " ", 
                  RowBox[{"{", "}"}]}]}], "]"}], ","}], " "}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Or", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"trait1new", "-", "trait1mean"}], ")"}], 
                   "\[CapitalDelta]c1"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"trait2new", "-", "trait2mean"}], ")"}], 
                   "\[CapitalDelta]c2"}]}], ">", "0"}], " ", ",", 
                RowBox[{"trait1fitslice", "\[Equal]", " ", 
                 RowBox[{"{", "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newmutantgenotypes", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"newmutantgenotypes", ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"genotypes", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"trait1new", "-", "1"}], ",", "trait2new"}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"{", 
                    RowBox[{"trait1new", ",", "trait2new"}], "}"}]}], "}"}], 
                   "}"}]}], "]"}]}], ";"}]}], "]"}], ";"}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "last", " ", "two", " ", "zeros", " ", "are", " ", "slots", " ", 
             "for", " ", "mutation", " ", "time", " ", "calculations", " ", 
             "in", " ", "calling", " ", "function"}], " ", "*)"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "ELSE", " ", "RELATIVE", " ", "FITNESS", " ", "SLICE", " ", "IS", 
             " ", "EMPTY", " ", "SO", " ", "NO", " ", "BOUNDARY", " ", 
             "FITNESS", " ", "CLASS", " ", "TO", " ", "ADD"}], " ", "*)"}], 
           "\[IndentingNewLine]", "Null"}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "trait2min", ",", "trait2max"}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "GET", " ", "NEW", " ", "MUTANTS", " ", "ALONG", " ", "SLICES", " ", 
        "IN", " ", "TRAIT", " ", "1", " ", "FITNESS", " ", "DIMENSION"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"getFitnessSlice", "[", "genotypeelem_", "]"}], ":=", 
          RowBox[{"testGenoType", "[", 
           RowBox[{"genotypeelem", ",", "i", ",", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"trait1fitslice", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"genotypes", ",", "getFitnessSlice"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"trait1fitslice", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "IF", " ", "ABSOLUTE", " ", "FITNESS", " ", "SLICE", " ", "IS", 
             " ", "NOT", " ", "EMPTY", " ", "THEN", " ", "CHECK", " ", "IF", 
             " ", "BETTER", " ", "FITNESS", " ", "CLASS", " ", "AT", " ", 
             "BOUNDARY"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"trait1new", ",", "trait2new"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{"trait1fitslice", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "+", 
                "1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"getFitnessSlice", "[", "genotypeelem_", "]"}], ":=", 
             RowBox[{"testGenoType", "[", 
              RowBox[{"genotypeelem", ",", "trait2new", ",", "2"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"trait2fitslice", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"genotypes", ",", "getFitnessSlice"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Or", "[", 
                RowBox[{
                 RowBox[{"trait1new", ">", 
                  RowBox[{"Max", "[", 
                   RowBox[{"trait2fitslice", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
                 RowBox[{"trait2fitslice", "\[Equal]", " ", 
                  RowBox[{"{", "}"}]}]}], "]"}], ","}], " "}], "*)"}], 
            "\[IndentingNewLine]", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Or", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"trait1new", "-", "trait1mean"}], ")"}], 
                   "\[CapitalDelta]c1"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"trait2new", "-", "trait2mean"}], ")"}], 
                   "\[CapitalDelta]c2"}]}], ">", "0"}], ",", 
                RowBox[{"trait2fitslice", "\[Equal]", " ", 
                 RowBox[{"{", "}"}]}]}], "]"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newmutantgenotypes", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"newmutantgenotypes", ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"genotypes", ",", 
                    RowBox[{"{", 
                    RowBox[{"trait1new", ",", 
                    RowBox[{"trait2new", "-", "1"}]}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2", ",", 
                    RowBox[{"{", 
                    RowBox[{"trait1new", ",", "trait2new"}], "}"}]}], "}"}], 
                   "}"}]}], "]"}]}], ";"}]}], "]"}], ";"}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "last", " ", "two", " ", "zeros", " ", "are", " ", "slots", " ", 
             "for", " ", "mutation", " ", "time", " ", "calculations", " ", 
             "in", " ", "calling", " ", "function"}], " ", "*)"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "ELSE", " ", "ABSOLUTE", " ", "FITNESS", " ", "SLICE", " ", "IS", 
             " ", "EMPTY", " ", "SO", " ", "NO", " ", "BOUNDARY", " ", 
             "FITNESS", " ", "CLASS", " ", "TO", " ", "ADD"}], " ", "*)"}], 
           "\[IndentingNewLine]", "Null"}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "trait1min", ",", "trait1max"}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"newmutantgenotypes", "=", 
       RowBox[{"groupNewMutantsList", "[", "newmutantgenotypes", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"RETURN", " ", "NEW", " ", "MUTANT", " ", "INFORMATION"}], 
         " ", "-", " ", 
         RowBox[{"LIST", " ", "OF", " ", "FORM", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"z1_i", ",", " ", "z2_i"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"y1_ij", ",", " ", "y2_ij"}], "}"}], "}"}], ",", " ", 
             "w1_i", ",", " ", "w2_i"}], "}"}], "}"}], " ", "FOR", " ", 
          "i"}]}], " ", "=", " ", 
        RowBox[{
        "ALL", " ", "MUTANT", " ", "FITNESS", " ", "CLASSES", " ", "POSSIBLE",
          " ", "ON", " ", "BOUNDARY"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"z1", " ", "=", " ", "\"\<abs_fit of mutant\>\""}], ",", " ", 
        
        RowBox[{"z2", " ", "=", " ", "\"\<rel_fit of mutant\>\""}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "y1", " ", "=", " ", 
         "\"\<index of genotype that generated mutant\>\""}], ",", " ", 
        RowBox[{
        "y2", " ", "=", " ", 
         "\"\<indicator of whether generated on \
trait1_dimension=1/trait2_dimension=2\>\""}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "w1", " ", "=", " ", "\"\<mutation time, set initially to zero\>\""}],
         ",", " ", 
        RowBox[{
        "w2", " ", "=", " ", 
         "\"\<no. of replications, set initially to zero\>\""}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "newmutantgenotypes"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.688388637496106*^9, 3.6883886500477448`*^9}, {
   3.688407091607911*^9, 3.688407193174913*^9}, {3.6884073473918123`*^9, 
   3.688407447207672*^9}, {3.6884074816635313`*^9, 3.688407494311516*^9}, {
   3.6884075388555307`*^9, 3.688407541439126*^9}, {3.688407607703397*^9, 
   3.688407609990333*^9}, {3.6884077816472397`*^9, 3.688407791110772*^9}, {
   3.6884080307106543`*^9, 3.688408077759555*^9}, {3.688409070199697*^9, 
   3.68840933727011*^9}, {3.688409367893943*^9, 3.688409398461399*^9}, {
   3.688409610358603*^9, 3.688409618134457*^9}, {3.688409689262982*^9, 
   3.688409700045207*^9}, {3.6884103818288794`*^9, 3.688410387220907*^9}, {
   3.6884106263880167`*^9, 3.688410651491928*^9}, {3.688411324085638*^9, 
   3.688411328284094*^9}, 3.68841249683856*^9, {3.6884126066116257`*^9, 
   3.688412672393848*^9}, {3.6884136637598543`*^9, 3.688413668696025*^9}, {
   3.688416506087736*^9, 3.688416525239599*^9}, {3.699310957794427*^9, 
   3.699311014098439*^9}, {3.699311072747064*^9, 3.699311115899822*^9}, {
   3.699366803206854*^9, 3.699366976599895*^9}, {3.6993670499919653`*^9, 
   3.6993670546720877`*^9}, {3.699367094640757*^9, 3.699367103176506*^9}, {
   3.699368475110579*^9, 3.699368497614932*^9}, {3.6993708162192698`*^9, 
   3.6993708234105387`*^9}, {3.699371027083659*^9, 3.699371041235577*^9}, {
   3.6993716230221663`*^9, 3.699371711902821*^9}, {3.699389792062358*^9, 
   3.699389855438548*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NextMutation", "[", 
    RowBox[{
    "popsize_", ",", "\[CapitalDelta]c1_", ",", "\[CapitalDelta]c2_", ",", 
     "U1_", ",", "U2_", ",", "sol_", ",", "genotypes_", ",", 
     "genotypeabundances_", ",", "starttime_", ",", "timestep_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIABLES"}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "U", ",", "F", ",", "numgenotypes", ",", "newbirths", ",", "newmutants",
        ",", "nummutants", ",", "nextmutationtime", ",", "mutantindx", ",", 
       "rbar", ",", "newmutantfixation", ",", "newmutantpfix", ",", 
       "parentfitclassindices", ",", "m"}], "}"}], ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"INITIALIZE", " ", "LOCAL", " ", "VARIABLES"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numgenotypes", "=", 
       RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newmutants", "=", 
       RowBox[{"getNextMutants", "[", 
        RowBox[{
        "genotypes", ",", "genotypeabundances", ",", "\[CapitalDelta]c1", ",",
          "\[CapitalDelta]c2"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "get", " ", "set", " ", "of", " ", "mutants", " ", "on", " ", "the", 
        " ", "boundary"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"nummutants", "=", 
       RowBox[{"getNumGenotypes", "[", "newmutants", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nextmutationtime", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"U", "=", 
       RowBox[{"{", 
        RowBox[{"U1", ",", "U2"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"F", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nummutants"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newmutantfixation", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"newmutantpfix", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "FORM", " ", "ALGEBRAIC", " ", "EXPRESSIONS", " ", "FOR", " ", 
        "SOLUTION", " ", "VECTOR", " ", 
        RowBox[{"X", "[", "t", "]"}], "AND", " ", "MEAN", " ", "FITNESS", " ", 
        RowBox[{"rbar", "[", "t", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "[", "t_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<n\>\"", "<>", 
           RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<[t]\>\""}], "]"}], 
         "&"}], "/@", 
        RowBox[{"Range", "[", "numgenotypes", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rbar", "[", "t_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
             RowBox[{
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}]}], ")"}], 
           RowBox[{
            RowBox[{"X", "[", "t", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}], "/", 
        "popsize"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "COMPUTE", " ", "MUTATION", " ", "TIME", " ", "AND", " ", 
         "REPLICATIONS", " ", "FOR", " ", "EACH", " ", "MUTANT", " ", "CLASS",
          " ", "ON", " ", "BOUNDARY"}], " ", "-", " ", 
        RowBox[{
        "FILL", " ", "QUEUE", " ", "TO", " ", "BE", " ", "EXAMINED"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"newmutants", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], "+=", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"ExponentialDistribution", "[", "1", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newbirths", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"X", "[", "t", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"genotypes", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], 
                    "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"genotypes", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}], 
                    "-", 
                    RowBox[{"rbar", "[", "t", "]"}]}], ")"}]}], " ", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                  ")"}], "/.", 
                 RowBox[{"sol", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/.", 
               RowBox[{"t", "\[Rule]", "#"}]}], ")"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ">", "0"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"NDSolveValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"y", "'"}], "[", "t", "]"}], "\[Equal]", 
               RowBox[{"newbirths", "[", "t", "]"}]}], ",", 
              RowBox[{
               RowBox[{"y", "[", "starttime", "]"}], "\[Equal]", "0"}]}], 
             "}"}], ",", "y", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "starttime", ",", "timestep"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Sometimes", " ", "when", " ", "pop", " ", "is", " ", 
            "declining"}], ",", " ", 
           RowBox[{
            RowBox[{"no", " ", 
             RowBox[{"F", "[", "t", "]"}], " ", "will", " ", "ever", " ", 
             "be", " ", "high", " ", "enough"}], ";", " ", 
            RowBox[{"check", " ", "for", " ", "this"}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"F", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", "timestep", "]"}], "<", 
            RowBox[{
             RowBox[{"newmutants", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "IF", " ", "MUTATION", " ", "TIME", " ", "OCCURED", " ", "AFTER", 
             " ", "timeuntilnextenvchange"}], " ", "*)"}], " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"newmutants", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"timestep", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "ELSE", " ", "MUTATION", " ", "TIME", " ", "OCCURS", " ", 
              "PRIOR", " ", "TO", " ", "timeuntilnextenvchange"}], ",", " ", 
             RowBox[{
             "SO", " ", "SOLVE", " ", "FOR", " ", "MUTATION", " ", "TIME"}]}],
             " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"newmutants", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "=", 
             RowBox[{"(", 
              RowBox[{"tm", "/.", 
               RowBox[{"FindRoot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"F", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "tm", "]"}], 
                  "\[Equal]", 
                  RowBox[{
                   RowBox[{"newmutants", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], " ", ",", 
                 RowBox[{"{", 
                  RowBox[{"tm", ",", "starttime", ",", "timestep"}], "}"}], 
                 ",", 
                 RowBox[{"Method", "->", "\"\<Brent\>\""}]}], "]"}]}], 
              ")"}]}], ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nummutants"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"LOOP", " ", "THROUGH", " ", "MUTANT", " ", "LIST"}], ",", 
        " ", 
        RowBox[{
        "FIND", " ", "MINUMUM", " ", "MUTATION", " ", "TIME", " ", "AND", " ",
          "CHECK", " ", "FOR", " ", 
         RowBox[{"ESTABLISHMENT", ".", " ", "IF"}], " ", "DOES", " ", "NOT", 
         " ", "ESTABLISH", " ", "UPDATE", " ", "MUTATION", " ", "TIME", " ", 
         "TO", " ", "SECOND", " ", "MUTATION", " ", "OCCURRENCE"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "CONTINUE", " ", "CHECKING", " ", "FOR", " ", "ESTABLISHEMENT", " ", 
        "BY", " ", "ORDER", " ", "OF", " ", "MUTATION", " ", 
        RowBox[{"TIME", "/", " ", "OR"}], " ", "TAKE", " ", 
        "\"\<timeuntilnextenvchange+1\>\"", " ", "IF", " ", "NO", " ", 
        "MUTATION", " ", "TIMES", " ", "OCCUR", " ", "BEFORE", " ", 
        "\"\<timeuntilnextenvchange\>\""}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"!", "newmutantfixation"}], " ", "&&", " ", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"nextmutationtime", " ", ">", " ", "timestep"}], ")"}]}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"STEP", " ", "1"}], ":", " ", 
          RowBox[{
          "FIND", " ", "THE", " ", "NEXT", " ", "MINIMUM", " ", "MUTATION", 
           " ", "TIME", " ", "AND", " ", "CHECK", " ", "THAT", " ", "ITS", 
           " ", "SMALLER", " ", "THAN", " ", 
           RowBox[{"timeuntilnextenvchange", ".", " ", "IF"}], " ", "NOT", 
           " ", "EXIT", " ", "LOOP", " ", "WITH", " ", "NO", " ", 
           "ESTABLISHMENT", " ", "EVENT", " ", "AND", " ", "PROCEED", " ", 
           "WITH", " ", "EXITING", " ", "MODULE"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mutantindx", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"newmutants", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{"newmutants", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "get", " ", "index", " ", "of", " ", "mutant", " ", "class", " ", 
           "with", " ", "lowest", " ", "mutation", " ", "time"}], " ", "*)"}],
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"STEP", " ", "2"}], ":", " ", 
            RowBox[{
            "FOR", " ", "MINIMUM", " ", "MUTATION", " ", "TIME", " ", 
             "FOUND"}]}], ",", " ", 
           RowBox[{"CHECK", " ", "IF", " ", "IT", " ", 
            RowBox[{"ESTABLISHES", ".", " ", "IF"}], " ", "SO", " ", "EXIT", 
            " ", "LOOP", " ", "WITH", " ", "ESTABLISHEMENT", " ", "INFO"}], 
           ",", " ", 
           RowBox[{
           "OTHERWISE", " ", "UPDATE", " ", "MUTATION", " ", "TIME", " ", 
            "FOR", " ", "MUTANT", " ", "CHECKED", " ", "AND", " ", "LOOP", 
            " ", "AGAIN"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"newmutants", "[", 
             RowBox[{"[", 
              RowBox[{"mutantindx", ",", "3"}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"(", 
             RowBox[{"timestep", "+", "1"}], ")"}]}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "IF", " ", "NEXT", " ", "MUTATION", " ", "EVENT", " ", "DOES", 
             " ", "NOT", " ", "OCCUR", " ", "BEFORE", " ", 
             "timeuntilnextenvchange"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nextmutationtime", "=", 
             RowBox[{"newmutants", "[", 
              RowBox[{"[", 
               RowBox[{"mutantindx", ",", "3"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"parentfitclassindices", "=", 
             RowBox[{"{", "}"}]}], ";", "  ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "This", " ", "is", " ", "needed", " ", "in", " ", "the", " ", 
               "main", " ", "module", " ", "to", " ", "track", " ", "growth", 
               " ", "of", " ", "the", " ", "mutant", " ", "fitness", " ", 
               "class"}], ",", " ", 
              RowBox[{
              "should", " ", "be", " ", "empty", " ", "if", " ", "not", " ", 
               "new", " ", "mutant", " ", "establishes"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"newmutants", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", "veryverbose", ")"}], ",", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Next mutation not estimated before \>\"", ",", 
                 "timestep", ",", "\"\<, starting at \>\"", ",", 
                 "starttime"}], "]"}], ";"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "ELSE", " ", "A", " ", "MUTATION", " ", "DID", " ", "OCCUR", " ", 
             "BEFORE", " ", "timeuntilnextenvchange", " ", "SO", " ", "CHECK",
              " ", "IF", " ", "IT", " ", "FIXES", " ", "AND", " ", "PROCEED", 
             " ", "ACCORDINGLY"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nextmutationtime", "=", 
             RowBox[{"newmutants", "[", 
              RowBox[{"[", 
               RowBox[{"mutantindx", ",", "3"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"newmutantpfix", "=", 
             RowBox[{"CalcPfix", "[", 
              RowBox[{
              "popsize", ",", "\[CapitalDelta]c1", ",", "\[CapitalDelta]c2", 
               ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"rbar", "[", "t", "]"}], ")"}], "/.", 
                   RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], " ", "/.", 
                 RowBox[{"t", "\[Rule]", "nextmutationtime"}]}], ")"}], ",", 
               RowBox[{
                RowBox[{"newmutants", "[", 
                 RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"newmutantfixation", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"RandomReal", "[", "]"}], "<", "newmutantpfix"}], 
              ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"!", "newmutantfixation"}], ")"}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
              RowBox[{"(*", " ", 
               RowBox[{
               "IF", " ", "NEW", " ", "MUTANT", " ", "DID", " ", "NOT", " ", 
                "FIX", " ", "UPDATE", " ", "ITS", " ", "MUTATION", " ", 
                "TIME"}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"newmutants", "[", 
                  RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "+=", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"ExponentialDistribution", "[", "1", "]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"F", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", "timestep", 
                   "]"}], "<", 
                  RowBox[{
                   RowBox[{"newmutants", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", 
                 ",", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "IF", " ", "NEXT", " ", "MUTATION", " ", "TIME", " ", 
                   "OCCURED", " ", "AFTER", " ", "timeuntilnextenvchange"}], 
                  " ", "*)"}], " ", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
                   RowBox[{"timestep", "+", "1"}]}], ";"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                   "ELSE", " ", "NEXT", " ", "MUTATION", " ", "TIME", " ", 
                    "OCCURS", " ", "PRIOR", " ", "TO", " ", 
                    "timeuntilnextenvchange"}], ",", " ", 
                   RowBox[{
                   "SO", " ", "SOLVE", " ", "FOR", " ", "MUTATION", " ", 
                    "TIME"}]}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "=", 
                   RowBox[{"(", 
                    RowBox[{"tm", "/.", 
                    RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"F", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", "tm", "]"}],
                     "\[Equal]", 
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], " ", ",", 
                    RowBox[{"{", 
                    RowBox[{"tm", ",", 
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "timestep"}], "}"}], 
                    ",", 
                    RowBox[{"Method", "->", "\"\<Brent\>\""}]}], "]"}]}], 
                    ")"}]}], ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
              "\[IndentingNewLine]", ",", " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"ELSE", " ", "NEW", " ", "MUTANT", " ", "FIXED"}], 
                ",", " ", 
                RowBox[{
                "SO", " ", "EXIT", " ", "LOOP", " ", "AND", " ", "RETURN", 
                 " ", "NEW", " ", "MUTANT", " ", "DATA"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"parentfitclassindices", "=", 
                RowBox[{
                 RowBox[{"newmutants", "[", 
                  RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"newmutants", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"newmutants", "[", 
                   RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}]}], ";", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"(", "veryverbose", ")"}], ",", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<establishment probability = \>\"", ",", 
                    "newmutantpfix", ",", 
                    "\"\<, new mutant established = \>\"", ",", " ", 
                    "newmutantfixation", ",", "\"\<, at time = \>\"", ",", 
                    RowBox[{"globaltime", "+", "nextmutationtime"}]}], "]"}], 
                  ";"}]}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"END", " ", "WHILE", " ", "LOOP"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "RETURN", " ", "EARLIEST", " ", "OCCURING", " ", "MUTANT", " ", 
        "FITNESS", " ", "CLASS", " ", "THAT", " ", 
        RowBox[{"FIXES", "/", "OR"}], " ", 
        RowBox[{"{", "}"}], " ", "IF", " ", "IT", " ", "DOES", " ", "NOT", 
        " ", "EXISTS"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "The", " ", "returned", " ", "type", " ", "is", " ", "a", " ", 
        "single", " ", "list", " ", "of", " ", "type", " ", 
        RowBox[{"{", 
         RowBox[{"t1", ",", 
          RowBox[{"{", 
           RowBox[{"z1", ",", "z2"}], "}"}], ",", "f1", ",", "p1"}], "}"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "t1", " ", "=", " ", "\"\<time until next establishing mutation\>\""}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"z1", " ", "=", " ", "\"\<trait1 of mutant\>\""}], ",", " ", 
        RowBox[{"z2", " ", "=", " ", "\"\<trait2 of mutant\>\""}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "f1", " ", "=", " ", 
        "\"\<flag designating whether new mutant has established\>\""}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "p1", " ", "=", " ", 
        "\"\<fixation probability of new mutant class\>\""}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "nextmutationtime", ",", "newmutants", ",", "newmutantfixation", ",", 
        "newmutantpfix", ",", "parentfitclassindices"}], "}"}]}]}], " ", 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.67605872922714*^9, 3.676058785879277*^9}, {
   3.6760589728838377`*^9, 3.6760589775291224`*^9}, {3.676059046446055*^9, 
   3.676059088142056*^9}, {3.676059208336916*^9, 3.6760592634544363`*^9}, {
   3.6760593199371643`*^9, 3.6760593204670677`*^9}, {3.680263663362485*^9, 
   3.6802636698576508`*^9}, {3.68026373026501*^9, 3.68026373336432*^9}, {
   3.680263790405897*^9, 3.6802638464847517`*^9}, {3.688388774289509*^9, 
   3.6883887961130447`*^9}, 3.688388861616127*^9, {3.6883889567695217`*^9, 
   3.688388977068997*^9}, 3.688389074474472*^9, {3.6884141123182783`*^9, 
   3.688414123634696*^9}, {3.688414160233964*^9, 3.688414232762239*^9}, {
   3.688414376002849*^9, 3.6884145270576878`*^9}, {3.688414580443822*^9, 
   3.6884146131386414`*^9}, {3.688414681123252*^9, 3.6884147163384857`*^9}, {
   3.688414769978508*^9, 3.6884148546227007`*^9}, {3.6884150816828423`*^9, 
   3.688415111085552*^9}, {3.6884154290658092`*^9, 3.6884154326890697`*^9}, {
   3.6884154678897552`*^9, 3.6884154704196253`*^9}, {3.688415702705751*^9, 
   3.68841570925344*^9}, {3.688415758985351*^9, 3.688415818738036*^9}, {
   3.688416079776984*^9, 3.688416084274168*^9}, {3.688416167536558*^9, 
   3.6884161755912113`*^9}, {3.688416667304035*^9, 3.688416769281951*^9}, {
   3.688495426699238*^9, 3.688495520837965*^9}, {3.688495583114293*^9, 
   3.68849564794582*^9}, {3.688496248279244*^9, 3.6884962739112253`*^9}, {
   3.688496999099991*^9, 3.688497047142899*^9}, {3.688574671243636*^9, 
   3.688574707907712*^9}, {3.688574745400867*^9, 3.688574845922297*^9}, {
   3.688688032319854*^9, 3.688688038236038*^9}, {3.688688106368167*^9, 
   3.688688114129993*^9}, {3.688688176839487*^9, 3.688688183182222*^9}, {
   3.6886883017409554`*^9, 3.6886883268500767`*^9}, {3.688688477094051*^9, 
   3.6886884913428164`*^9}, {3.6886885256758003`*^9, 3.688688547714519*^9}, {
   3.6886885918554068`*^9, 3.68868861114928*^9}, {3.68868866534132*^9, 
   3.688688665826858*^9}, {3.68868870947077*^9, 3.6886887402960377`*^9}, {
   3.688689136996621*^9, 3.6886891741796103`*^9}, {3.688689231729515*^9, 
   3.688689232599723*^9}, {3.688689267455682*^9, 3.688689279116002*^9}, {
   3.688689311109185*^9, 3.688689318779788*^9}, {3.688689419289076*^9, 
   3.6886894204835653`*^9}, 3.6886895795391283`*^9, {3.688689632599852*^9, 
   3.688689680969531*^9}, {3.688689781529714*^9, 3.688689811691188*^9}, {
   3.688689842647768*^9, 3.688689917312696*^9}, {3.688690025279429*^9, 
   3.688690052889867*^9}, {3.688690169159748*^9, 3.688690217991741*^9}, {
   3.68869061831262*^9, 3.688690627572927*^9}, {3.688690807181691*^9, 
   3.6886908196930656`*^9}, {3.68869085034577*^9, 3.6886908608454723`*^9}, {
   3.688690901367303*^9, 3.688690963868598*^9}, {3.688691151616807*^9, 
   3.6886912969604807`*^9}, 3.688691433547421*^9, {3.6887052389707623`*^9, 
   3.688705249822854*^9}, {3.688705305073885*^9, 3.6887053155013943`*^9}, {
   3.6887056749476843`*^9, 3.6887057047805443`*^9}, 3.69003116968622*^9, {
   3.690031468098833*^9, 3.690031468786695*^9}, 3.699369764494238*^9, {
   3.699369833678035*^9, 3.6993698406138287`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CalcPfix", "[", 
    RowBox[{
    "popsize_", ",", "\[CapitalDelta]c1_", ",", "\[CapitalDelta]c2_", ",", 
     "rbar_", ",", "newmutants_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIABLES"}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "RETURN", " ", "ANALYTICAL", " ", "FIXATION", " ", "PROBABILITY", " ", 
       "ASSUMING", " ", "N", " ", "CONSTANT", " ", 
       RowBox[{"(", 
        RowBox[{"demographic", " ", "equilibrium"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"newmutants", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
           RowBox[{
            RowBox[{"newmutants", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}]}], ")"}], 
         "-", "rbar"}], ">", "0"}], "\[IndentingNewLine]", ",", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "IF", " ", "PER", " ", "BIRTH", " ", "RATE", " ", "EXCEED", " ", 
          "DEATH", " ", "RATE"}], ",", " ", 
         RowBox[{
         "RETURN", " ", "ANALYTIC", " ", "FIXATION", " ", "PROBABILITY"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"newmutants", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
          RowBox[{
           RowBox[{"newmutants", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}], "-", 
          "rbar"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{
           RowBox[{"newmutants", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
          RowBox[{
           RowBox[{"newmutants", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}], "-", 
          "rbar"}], ")"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"IF", " ", "DEATH", " ", "RATE", " ", "GREATER"}], ",", " ", 
         
         RowBox[{"THEN", " ", "RETURN", " ", "0", " ", "PROBABILITY"}]}], " ",
         "*)"}], "\[IndentingNewLine]", "0"}], "]"}]}], "\[IndentingNewLine]",
     "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.6760570728175077`*^9, {3.688495054072056*^9, 3.6884952444872713`*^9}, {
   3.688495278909875*^9, 3.688495304110862*^9}, {3.6884953345264893`*^9, 
   3.688495345926388*^9}, {3.688702932224207*^9, 3.6887029731882887`*^9}, {
   3.688704265758654*^9, 3.6887042966066017`*^9}, {3.688704328447584*^9, 
   3.688704334533352*^9}, {3.688704432118758*^9, 3.6887045030850563`*^9}, {
   3.688704561724106*^9, 3.688704584512712*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CalcEstablishmentTime", "[", "pfix_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIALBES"}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ran", ",", "v0"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "GET", " ", "INITIAL", " ", "SIZE", " ", "OF", " ", "ESTABLISHED", " ", 
       "MUTANT"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ran", "=", 
       RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v0", "=", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", "ran"}], "]"}], "pfix"]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "RETURN", " ", "ESTABLISHEMENT", " ", "TIME", " ", "AND", " ", 
        "INITIAL", " ", "SIZE"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ran", ",", "v0"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{3.67605708473843*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RunSimulationCheckEachMutation2", "[", 
    RowBox[{
    "popsize_", ",", "\[CapitalDelta]c1_", ",", "\[CapitalDelta]c2_", ",", 
     "U1_", ",", "U2_", ",", "maxtime_", ",", "timestepsize_", ",", 
     "initgenotype_", ",", "initgenotypeabundances_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIABLES"}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "genotypeabundances", ",", "genotypes", ",", "globaltime", ",", 
       "numgenotypes", ",", "system", ",", "sol", ",", "mutationtime", ",", 
       "pfix", ",", "v0", ",", "\[IndentingNewLine]", "establishtimeran", ",",
        "fixation", ",", "fixationran", ",", "timestep", ",", "q", ",", 
       "history", ",", "newmutants", ",", "oldgenotypesindx", ",", 
       "parentindices"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"ivals", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"qvals", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"INITIALIZE", " ", "LOCAL", " ", "VARIABLES"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"genotypes", ",", "genotypeabundances"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"initgenotype", ",", "initgenotypeabundances"}], "}"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"numgenotypes", "=", 
       RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"globaltime", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"timestep", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"timestepsize", ",", "maxtime"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fixation", "=", "False"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Weird", " ", "context", " ", "conflicts", " ", "were", " ", 
        "occuring", " ", "when", " ", "using", " ", "Parallel", " ", "unless",
         " ", "these", " ", "symbols", " ", "have", " ", "already", " ", 
        "been", " ", 
        RowBox[{"used", ".", " ", "Ideally"}], " ", "should", " ", "not", " ",
         "be", " ", 
        RowBox[{"here", "!"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "n1", ",", "n2", ",", "n3", ",", "n4", ",", "n5", ",", "n6", ",", "n7",
         ",", "n8", ",", "n9", ",", "n10", ",", "n11", ",", "n12", ",", "n13",
         ",", "n14", ",", "n15", ",", "n16", ",", "n17", ",", "n18", ",", 
        "n19", ",", "n20", ",", "n21", ",", "n22", ",", "n23", ",", "n24", 
        ",", "n25", ",", "n26", ",", "n27", ",", "n28", ",", "n29", ",", 
        "n30", ",", "n31", ",", "n32", ",", "\[IndentingNewLine]", "n33", ",",
         "n34", ",", "n35", ",", "n36", ",", "n37", ",", "n38", ",", "n39", 
        ",", "n40", ",", "n41", ",", "n42", ",", "n43", ",", "n44", ",", 
        "n45", ",", "n46", ",", "n47", ",", "n48", ",", "n49", ",", "n50", 
        ",", "n51", ",", "n52", ",", "n53", ",", "n54", ",", "n55", ",", 
        "n56", ",", "n57", ",", "n58", ",", "n59", ",", "n60", ",", "n61", 
        ",", "n62", ",", "\[IndentingNewLine]", "n63", ",", "n64", ",", "n65",
         ",", "n66", ",", "n67", ",", "n68", ",", "n69", ",", "n70", ",", 
        "n71", ",", "n72", ",", "n73", ",", "n74", ",", "n75", ",", "n76", 
        ",", "n77", ",", "n78", ",", "n79", ",", "n80", ",", "n81", ",", 
        "n82", ",", "n83", ",", "n84", ",", "n85", ",", "n86", ",", "n87", 
        ",", "n88", ",", "n89", ",", "n90", ",", "n91", ",", "n92", ",", 
        "\[IndentingNewLine]", "n93", ",", "n94", ",", "n95", ",", "n96", ",",
         "n97", ",", "n98", ",", "n99", ",", "n100"}], "}"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"MAIN", " ", "CODE", " ", "FOR", " ", "SIMULATION"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"history", "=", "\[IndentingNewLine]", 
       RowBox[{"Reap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"collectMyData", "[", 
          RowBox[{
          "fulldata", ",", "globaltime", ",", "0", ",", "genotypes", ",", 
           "genotypeabundances", ",", "popsize", ",", "\[CapitalDelta]c1", 
           ",", "\[CapitalDelta]c2", ",", "0", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"globaltime", "<", "maxtime"}], " ", "\[IndentingNewLine]",
            "\[IndentingNewLine]", ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "WHILE", " ", "LOCAL", " ", "TIME", " ", "OF", " ", "SIMULATION", 
             " ", "IS", " ", "LESS", " ", "THAN", " ", "maxtime"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", "veryverbose", ")"}], ",", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Step starting at time = \>\"", ",", "globaltime", ",", 
                 "\"\<, next time step size = \>\"", ",", "timestep", ",", 
                 "\"\<, genotypeabundances = \>\"", ",", 
                 "genotypeabundances"}], "]"}], ";"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"system", ",", "sol"}], "}"}], "=", 
             RowBox[{"SolveDiffEqs", "[", 
              RowBox[{
              "popsize", ",", "\[CapitalDelta]c1", ",", "\[CapitalDelta]c2", 
               ",", "genotypeabundances", ",", "genotypes", ",", "timestep"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"fixation", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{"pfix", "=", "0"}], ";", "\[IndentingNewLine]", 
            RowBox[{"mutationtime", "=", "0"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"GET", " ", "NEXT", " ", "ESTABLISHING", " ", "MUTANT"}],
              " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "mutationtime", ",", "newmutants", ",", "fixation", ",", "pfix",
                ",", "parentindices"}], "}"}], "=", 
             RowBox[{"NextMutation", "[", 
              RowBox[{
              "popsize", ",", "\[CapitalDelta]c1", ",", "\[CapitalDelta]c2", 
               ",", "U1", ",", "U2", ",", "sol", ",", "genotypes", ",", 
               "genotypeabundances", ",", "mutationtime", ",", "timestep"}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "ASSIGN", " ", "NEW", " ", "MUTATION", " ", "THAT", " ", "HAS", 
               " ", "ESTABLISHED", " ", "BEFORE", " ", "timestep", " ", "AN", 
               " ", "ABUNDANCE", " ", "AND", " ", "UPDATE", " ", "GENOTYPE", 
               " ", "INFO"}], ",", " ", 
              RowBox[{"IF", " ", "IT", " ", "EXISTS"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"fixation", " ", "&&", " ", 
                RowBox[{"mutationtime", "<", "timestep"}]}], ")"}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "IF", " ", "MUTANT", " ", "HAS", " ", "ESTABLISHED", " ", 
                 "BEFORE", " ", "timestep"}], ",", " ", 
                RowBox[{
                "GET", " ", "ITS", " ", "INITIAL", " ", "SIZE", " ", "AND", 
                 " ", "UPDATE", " ", 
                 RowBox[{"genotypes", "/", "genotypeabundances"}], " ", "AND",
                  " ", "PRUNE", " ", "CLASSES"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"establishtimeran", ",", "v0"}], "}"}], "=", 
                RowBox[{"CalcEstablishmentTime", "[", "pfix", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"(", "veryverbose", ")"}], ",", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<establishes at freq=\>\"", ",", "v0", ",", " ", 
                    "\"\< at local time=\>\"", ",", "mutationtime", ",", 
                    "\"\<+global time \>\"", ",", "globaltime"}], "]"}], 
                  ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"globaltime", "=", 
                RowBox[{"globaltime", "+", "mutationtime"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"timestep", "=", 
                RowBox[{"timestep", "-", "mutationtime"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"genotypeabundances", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", 
                   RowBox[{"t", "\[Rule]", "mutationtime"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "genotypes", ",", "genotypeabundances", ",", 
                  "oldgenotypesindx"}], "}"}], "=", 
                RowBox[{"PruneUnfitClasses", "[", 
                 RowBox[{"genotypes", ",", "genotypeabundances"}], "]"}]}], 
               ";", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                "odlgenotypesindx", " ", "stores", " ", "old", " ", "index", 
                 " ", "of", " ", "new", " ", "trimmed", " ", "genotypes", " ",
                  "list"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"genotypeabundances", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"oldgenotypesindx", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", 
                    RowBox[{"t", "\[Rule]", "mutationtime"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "oldgenotypesindx", "]"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"{", "v0", "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"genotypes", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"genotypes", ",", "newmutants"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"numgenotypes", "=", 
                RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"(", "veryverbose", ")"}], ",", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<add a genotype class, genotypeabundances = \>\"", ",",
                     "genotypeabundances", ",", " ", "\"\< time = \>\"", ",", 
                    "mutationtime", ",", "\"\<, global time \>\"", ",", 
                    "globaltime", ",", " ", "\"\< genotypes=\>\"", ",", 
                    "genotypes"}], "]"}], ";"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"collectMyData", "[", 
                RowBox[{
                "fulldata", ",", "globaltime", ",", "0", ",", "genotypes", 
                 ",", "genotypeabundances", ",", "popsize", ",", 
                 "\[CapitalDelta]c1", ",", "\[CapitalDelta]c2", ",", "pfix", 
                 ",", 
                 RowBox[{"newmutants", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "ELSE", " ", "NO", " ", "NEW", " ", "MUTANT", " ", 
                 "ESTABLISHED"}], ",", " ", 
                RowBox[{
                "SO", " ", "JUST", " ", "PRUNE", " ", "CLASSES", " ", "AND", 
                 " ", "PROGRESS", " ", "TO", " ", "timestep"}]}], " ", "*)"}],
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fixation", "=", "False"}], ";", "\[IndentingNewLine]", 
               RowBox[{"globaltime", "=", 
                RowBox[{"globaltime", "+", "timestep"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"genotypeabundances", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", 
                   RowBox[{"t", "\[Rule]", "timestep"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"timestep", "=", 
                RowBox[{"Min", "[", 
                 RowBox[{"timestepsize", ",", 
                  RowBox[{"maxtime", "-", "globaltime"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"(", "veryverbose", ")"}], ",", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<time step reached at \>\"", ",", " ", "timestep", 
                    ",", "\"\< before mutant at time \>\"", ",", 
                    "mutationtime", ",", "\"\<+\>\"", ",", "globaltime", ",", 
                    "\"\<=\>\"", ",", 
                    RowBox[{"mutationtime", "+", "globaltime"}], ",", 
                    "\"\< abundances=\>\"", ",", "genotypeabundances"}], 
                   "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "genotypes", ",", "genotypeabundances", ",", 
                  "oldgenotypesindx"}], "}"}], "=", 
                RowBox[{"PruneUnfitClasses", "[", 
                 RowBox[{"genotypes", ",", "genotypeabundances"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"numgenotypes", "=", 
                RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"collectMyData", "[", 
                RowBox[{
                "fulldata", ",", "globaltime", ",", "0", ",", "genotypes", 
                 ",", "genotypeabundances", ",", "popsize", ",", 
                 "\[CapitalDelta]c1", ",", "\[CapitalDelta]c2", ",", "0", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "]"}], 
         RowBox[{"(*", 
          RowBox[{"END", "-", "WHILE", "-", "LOOP"}], "*)"}], ";"}], 
        "\[IndentingNewLine]", "]"}]}], 
      RowBox[{"(*", 
       RowBox[{"END", "-", "REAP"}], "*)"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"RETURN", " ", "history"}], " ", "*)"}], "\[IndentingNewLine]",
       "history"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 PageWidth->Infinity,
 CellChangeTimes->{{3.670356562190632*^9, 3.670356567643033*^9}, {
   3.670356693408765*^9, 3.670356710731172*^9}, {3.670356807531117*^9, 
   3.6703568257650003`*^9}, {3.670356862160179*^9, 3.670356871153842*^9}, {
   3.67035694380952*^9, 3.670356953576495*^9}, {3.670356985759572*^9, 
   3.67035699268412*^9}, {3.670357033929352*^9, 3.670357041410798*^9}, {
   3.670357239351856*^9, 3.670357316284492*^9}, {3.670357392261166*^9, 
   3.670357393340271*^9}, {3.6703574382955437`*^9, 3.6703574408478737`*^9}, {
   3.670357723027022*^9, 3.6703577235488243`*^9}, {3.670359709642407*^9, 
   3.670359834821047*^9}, {3.670360565381609*^9, 3.6703605685879*^9}, {
   3.6703606043738623`*^9, 3.670360651244526*^9}, {3.6703607296486692`*^9, 
   3.67036073515836*^9}, {3.6703607790714397`*^9, 3.670360847021422*^9}, {
   3.670361918124465*^9, 3.670362012670764*^9}, {3.670362077384261*^9, 
   3.6703620859434347`*^9}, {3.670362258961775*^9, 3.670362283670586*^9}, {
   3.670362338548586*^9, 3.670362340113411*^9}, {3.6703646936317167`*^9, 
   3.670364718469558*^9}, {3.670364773911393*^9, 3.6703648556097803`*^9}, {
   3.670365341275918*^9, 3.670365353570187*^9}, {3.6703658337925873`*^9, 
   3.670365859401249*^9}, {3.670516779082911*^9, 3.6705168402920322`*^9}, {
   3.670516900500416*^9, 3.670516993430625*^9}, {3.670523364798726*^9, 
   3.670523377202325*^9}, {3.670523463200057*^9, 3.670523490498218*^9}, 
   3.670523565137623*^9, {3.670523707724503*^9, 3.670523735680366*^9}, 
   3.670523780266176*^9, {3.670523823756312*^9, 3.670523851685417*^9}, {
   3.670523972230878*^9, 3.670524009821166*^9}, {3.6705240719958763`*^9, 
   3.670524160411227*^9}, {3.670524194415951*^9, 3.670524246722595*^9}, {
   3.670524293397299*^9, 3.670524296772727*^9}, {3.670524349035576*^9, 
   3.670525033210642*^9}, {3.6705250972354307`*^9, 3.670525953821394*^9}, {
   3.6705259885761967`*^9, 3.670526186975424*^9}, {3.67052622847024*^9, 
   3.670526334174573*^9}, {3.670526504292678*^9, 3.6705265076348677`*^9}, {
   3.670526565054915*^9, 3.6705268845202827`*^9}, {3.6705269721217823`*^9, 
   3.670527008567441*^9}, {3.6705270460735893`*^9, 3.6705270832388783`*^9}, {
   3.670527116953678*^9, 3.6705273832576923`*^9}, {3.6705274429563828`*^9, 
   3.670527499209242*^9}, {3.67052754124842*^9, 3.670527574670185*^9}, 
   3.670527826401846*^9, 3.670528071735876*^9, 3.6705281738248262`*^9, {
   3.670528270480358*^9, 3.67052827864258*^9}, {3.670528358394718*^9, 
   3.670528485842485*^9}, {3.670528554345542*^9, 3.670528634609971*^9}, 
   3.6705286752348423`*^9, 3.670528706169422*^9, {3.670528747952447*^9, 
   3.670528843644143*^9}, {3.670528882239346*^9, 3.67052895920405*^9}, {
   3.6705289946439943`*^9, 3.670529097423847*^9}, {3.6705291665343*^9, 
   3.670529177423895*^9}, 3.67052928871332*^9, {3.6705293998547993`*^9, 
   3.670529400182781*^9}, {3.670529457349422*^9, 3.670529532356968*^9}, {
   3.670529730480777*^9, 3.670529793022018*^9}, {3.670529825238182*^9, 
   3.670529835298493*^9}, {3.6705299236020308`*^9, 3.670530036566554*^9}, {
   3.670530074053618*^9, 3.670530107832684*^9}, {3.670530138346479*^9, 
   3.6705301692949333`*^9}, {3.6705311540518017`*^9, 3.670531159062324*^9}, {
   3.6705312032253923`*^9, 3.6705312330911818`*^9}, {3.670531297168397*^9, 
   3.670531331363014*^9}, {3.670531362933538*^9, 3.670531433807078*^9}, 
   3.670531574612813*^9, 3.670531643561922*^9, {3.670531910371409*^9, 
   3.670531922221066*^9}, {3.670532252646906*^9, 3.670532254701584*^9}, {
   3.67053230825454*^9, 3.670532317303954*^9}, {3.670532411135992*^9, 
   3.670532414520883*^9}, {3.67053252552943*^9, 3.670532758547863*^9}, {
   3.670532860217764*^9, 3.670532888078017*^9}, {3.670532940182729*^9, 
   3.670532974595663*^9}, {3.670533315363595*^9, 3.670533370794919*^9}, {
   3.670534014854618*^9, 3.670534033421879*^9}, {3.670534400166285*^9, 
   3.670534606020483*^9}, {3.6705346459664593`*^9, 3.670534672105516*^9}, {
   3.67053501132838*^9, 3.670535023352476*^9}, {3.6705354052316732`*^9, 
   3.67053545382314*^9}, {3.670535601784696*^9, 3.6705356730325317`*^9}, {
   3.6705357553947573`*^9, 3.6705357768684883`*^9}, {3.6705359473618393`*^9, 
   3.6705359483509817`*^9}, {3.670536069346773*^9, 3.670536070074139*^9}, {
   3.6705362282242126`*^9, 3.670536232345647*^9}, {3.670536502360993*^9, 
   3.670536508769745*^9}, {3.670536603692418*^9, 3.67053665853302*^9}, {
   3.6705367076989527`*^9, 3.670536708155847*^9}, {3.670536789965708*^9, 
   3.670536791436079*^9}, {3.670536842459796*^9, 3.670536842935246*^9}, {
   3.670537414845881*^9, 3.6705376031120977`*^9}, {3.670537736022749*^9, 
   3.670537756296533*^9}, {3.6705380961508837`*^9, 3.670538114402482*^9}, {
   3.6705386432388268`*^9, 3.670538780149303*^9}, {3.670538903069407*^9, 
   3.670538910349527*^9}, {3.6705389702811327`*^9, 3.67053897832115*^9}, {
   3.670539013595799*^9, 3.67053905488877*^9}, {3.6705391201163177`*^9, 
   3.670539120547078*^9}, {3.6705398988850603`*^9, 3.6705399222435207`*^9}, {
   3.670540026032256*^9, 3.6705400774509172`*^9}, {3.670540211297657*^9, 
   3.670540235511104*^9}, {3.670540265993376*^9, 3.670540324521476*^9}, {
   3.670540871055225*^9, 3.670540923109696*^9}, {3.670540960907531*^9, 
   3.6705410776452923`*^9}, {3.6705411091428843`*^9, 
   3.6705411092866497`*^9}, {3.67054118069937*^9, 3.6705412009870853`*^9}, {
   3.67054263798612*^9, 3.670542642202742*^9}, 3.670542810202125*^9, {
   3.670542854152804*^9, 3.670542957300795*^9}, {3.670543003796193*^9, 
   3.670543081619728*^9}, {3.670543320604617*^9, 3.670543353890668*^9}, 
   3.670543594156927*^9, {3.6705436965881033`*^9, 3.670543697240726*^9}, {
   3.6705437981853313`*^9, 3.6705438680670643`*^9}, {3.670543908903754*^9, 
   3.670543909374093*^9}, {3.670543941134489*^9, 3.67054394599268*^9}, {
   3.6705440197190228`*^9, 3.67054402001597*^9}, {3.670544131421336*^9, 
   3.6705441564550037`*^9}, {3.670544492526307*^9, 3.6705444935838633`*^9}, {
   3.670544691291791*^9, 3.6705447011075563`*^9}, {3.670544938214341*^9, 
   3.670544940795288*^9}, {3.6705451158577137`*^9, 3.670545120590414*^9}, {
   3.670545197953994*^9, 3.670545209089452*^9}, {3.670545376588293*^9, 
   3.670545377767112*^9}, {3.670545427228798*^9, 3.670545470717579*^9}, {
   3.670545509423564*^9, 3.670545512812866*^9}, {3.67054559361694*^9, 
   3.670545609632379*^9}, {3.670545672906041*^9, 3.670545673271845*^9}, {
   3.670545763677589*^9, 3.6705457718461113`*^9}, {3.6705464717355003`*^9, 
   3.670546479828764*^9}, 3.670546903349882*^9, {3.670546974277256*^9, 
   3.670547083005207*^9}, {3.670547113757298*^9, 3.670547136781336*^9}, {
   3.6705473108618813`*^9, 3.670547369981491*^9}, {3.6705486834636917`*^9, 
   3.670548699311245*^9}, {3.670548900335397*^9, 3.670548934500874*^9}, {
   3.6705490250348883`*^9, 3.670549038127067*^9}, {3.670549080022711*^9, 
   3.6705490904740677`*^9}, {3.670549130816181*^9, 3.6705491435036297`*^9}, {
   3.670549305555669*^9, 3.6705493105193644`*^9}, {3.670549378599478*^9, 
   3.670549422808186*^9}, {3.6705495442433853`*^9, 3.670549550904387*^9}, {
   3.6705496249027576`*^9, 3.670549625378272*^9}, {3.670549781290946*^9, 
   3.670549803433857*^9}, {3.6705505601499*^9, 3.670550615760517*^9}, {
   3.67055100149368*^9, 3.670551077181278*^9}, {3.670551198924508*^9, 
   3.670551255200418*^9}, {3.670551294401877*^9, 3.670551313347643*^9}, {
   3.670551380728045*^9, 3.670551382906291*^9}, {3.670551860490925*^9, 
   3.670551915734779*^9}, {3.670552226834111*^9, 3.670552249769073*^9}, {
   3.670586953558219*^9, 3.670586954924114*^9}, {3.67058827873197*^9, 
   3.6705882936037827`*^9}, {3.6705885090384703`*^9, 3.670588509373764*^9}, {
   3.670588548021658*^9, 3.67058856940521*^9}, {3.6711940654913816`*^9, 
   3.671194080793737*^9}, {3.671199707513309*^9, 3.671199729255982*^9}, {
   3.671200731738317*^9, 3.6712007589457912`*^9}, {3.671200801276085*^9, 
   3.6712009487720213`*^9}, {3.671201005572872*^9, 3.6712010341466007`*^9}, {
   3.671201082469863*^9, 3.671201109816463*^9}, {3.671201149754551*^9, 
   3.671201183307169*^9}, {3.6712016213724613`*^9, 3.671201628743011*^9}, 
   3.671201682813333*^9, {3.671201916132823*^9, 3.671201919172264*^9}, {
   3.671202282410433*^9, 3.671202343004863*^9}, {3.671202492533311*^9, 
   3.671202522252872*^9}, {3.6712028423508797`*^9, 3.671202915805457*^9}, {
   3.671203131919198*^9, 3.6712031448347073`*^9}, {3.67120324274104*^9, 
   3.671203251518977*^9}, {3.671203303309552*^9, 3.6712033454981833`*^9}, {
   3.6712033778001328`*^9, 3.671203408527597*^9}, {3.671203548038331*^9, 
   3.6712035543466663`*^9}, {3.671203601884531*^9, 3.6712038170340347`*^9}, {
   3.6712045343874483`*^9, 3.671204534486915*^9}, {3.671204627639621*^9, 
   3.6712046277317057`*^9}, {3.671204880972237*^9, 3.671204883337672*^9}, {
   3.67120686737704*^9, 3.671206932757902*^9}, {3.671207029372373*^9, 
   3.671207048769476*^9}, {3.671207134049567*^9, 3.671207134554914*^9}, {
   3.67120759043025*^9, 3.671207611188944*^9}, {3.671208411071556*^9, 
   3.671208419457506*^9}, {3.671208451175344*^9, 3.671208451873219*^9}, {
   3.671208526657365*^9, 3.671208530604973*^9}, {3.671208852600308*^9, 
   3.67120920013632*^9}, {3.6712095220527678`*^9, 3.6712095224432*^9}, {
   3.671210895833181*^9, 3.671210979984849*^9}, {3.671211278340674*^9, 
   3.671211287787136*^9}, {3.671211323095389*^9, 3.671211353713006*^9}, {
   3.6712114245246677`*^9, 3.671211427110957*^9}, {3.671211556195915*^9, 
   3.671211558842135*^9}, {3.671211589696371*^9, 3.67121160397545*^9}, 
   3.671211653059739*^9, {3.671211806616798*^9, 3.671211826280311*^9}, {
   3.671211897557344*^9, 3.671211899880557*^9}, 3.671211936072083*^9, {
   3.671212183288465*^9, 3.671212230363537*^9}, {3.6712123010224047`*^9, 
   3.671212484558601*^9}, {3.671212526345896*^9, 3.67121252661933*^9}, {
   3.671212604153481*^9, 3.6712126082223*^9}, {3.671212937376696*^9, 
   3.6712129535598*^9}, {3.671214629641066*^9, 3.671214656477254*^9}, {
   3.671215413394806*^9, 3.671215426035392*^9}, {3.671215820841425*^9, 
   3.671215840265011*^9}, {3.671216028448979*^9, 3.6712160376448298`*^9}, {
   3.671216268043681*^9, 3.6712162685435534`*^9}, {3.6712163509957*^9, 
   3.671216359299574*^9}, {3.6712165001284037`*^9, 3.671216500907797*^9}, {
   3.671218535642226*^9, 3.6712185439605637`*^9}, {3.671221987720746*^9, 
   3.6712220201312304`*^9}, {3.671222213831801*^9, 3.67122222352055*^9}, {
   3.6716385511762743`*^9, 3.6716385731616488`*^9}, {3.671638734361377*^9, 
   3.6716387346644*^9}, {3.671638766074671*^9, 3.671638836684657*^9}, 
   3.671640764411723*^9, {3.6716409061674633`*^9, 3.671640945995964*^9}, 
   3.6716461373130207`*^9, {3.671646496245761*^9, 3.671646534408902*^9}, 
   3.6716466871487722`*^9, {3.6716467531474733`*^9, 3.6716467726451197`*^9}, {
   3.671647961184664*^9, 3.671647994747402*^9}, {3.6716487164225197`*^9, 
   3.671648771928178*^9}, {3.671649024324279*^9, 3.67164902766835*^9}, {
   3.671654379008458*^9, 3.671654411277875*^9}, 3.671654457525532*^9, 
   3.671655283342457*^9, 3.67173330761314*^9, {3.67173471960561*^9, 
   3.671734719779223*^9}, {3.671737961963223*^9, 3.671738004040555*^9}, {
   3.671742737443988*^9, 3.671742750314929*^9}, {3.6717428124328423`*^9, 
   3.671742820482506*^9}, {3.671743461057829*^9, 3.6717434641117563`*^9}, {
   3.6718425809602957`*^9, 3.671842582323599*^9}, {3.6724071124393997`*^9, 
   3.672407210399076*^9}, {3.672407387937533*^9, 3.672407390313285*^9}, {
   3.672407446379964*^9, 3.6724074916042957`*^9}, {3.672408220545745*^9, 
   3.672408232681695*^9}, {3.672667627893003*^9, 3.672667655194415*^9}, {
   3.6726677395404587`*^9, 3.67266774739662*^9}, {3.672667779276676*^9, 
   3.6726678435909843`*^9}, {3.672667886548992*^9, 3.672668047214531*^9}, {
   3.6726680799108467`*^9, 3.672668312354904*^9}, {3.6726684003987293`*^9, 
   3.672668430607095*^9}, {3.672668472694881*^9, 3.6726685555112667`*^9}, {
   3.6726685855272617`*^9, 3.672668637319372*^9}, {3.672668742735978*^9, 
   3.6726688011626*^9}, {3.672668891083778*^9, 3.672668922452417*^9}, {
   3.67266895883585*^9, 3.6726690303263407`*^9}, {3.672669134809958*^9, 
   3.672669146373296*^9}, {3.672669247011711*^9, 3.672669283516217*^9}, {
   3.672669352043758*^9, 3.672669373322082*^9}, 3.67266942268687*^9, {
   3.6726697347186003`*^9, 3.6726697516521597`*^9}, {3.672689011426238*^9, 
   3.672689044806589*^9}, {3.6726891245788116`*^9, 3.672689145318737*^9}, {
   3.672689183941723*^9, 3.672689290097014*^9}, {3.672689358723166*^9, 
   3.672689369085565*^9}, {3.67268962325987*^9, 3.672689727690465*^9}, {
   3.672689822470252*^9, 3.6726898735505238`*^9}, {3.672689913738142*^9, 
   3.6726899201738567`*^9}, {3.6726899622609158`*^9, 3.672690106149609*^9}, {
   3.672690256230131*^9, 3.672690274503188*^9}, 3.6726903406064*^9, {
   3.672690415064909*^9, 3.672690656738212*^9}, {3.672690697183647*^9, 
   3.672690711591754*^9}, {3.6726907962826853`*^9, 3.672690840550642*^9}, 
   3.672690987282339*^9, {3.6726910179071503`*^9, 3.6726911268437443`*^9}, {
   3.672691168049294*^9, 3.672691174305048*^9}, {3.672691296913415*^9, 
   3.672691630291977*^9}, {3.672691730974183*^9, 3.67269174723531*^9}, {
   3.672691779380065*^9, 3.672691786445977*^9}, {3.672691831193062*^9, 
   3.672691857291298*^9}, {3.6726918910996227`*^9, 3.672691906571472*^9}, {
   3.6726919424034033`*^9, 3.6726919710113993`*^9}, {3.672692025523993*^9, 
   3.6726921249641647`*^9}, {3.672692373378798*^9, 3.672692397463386*^9}, {
   3.67269252810394*^9, 3.672692550112605*^9}, {3.672692594134253*^9, 
   3.672692766458047*^9}, {3.672692824505804*^9, 3.672692853980986*^9}, {
   3.672692885233768*^9, 3.672693094279583*^9}, {3.6726931305951138`*^9, 
   3.6726931398587027`*^9}, {3.672693524387909*^9, 3.672693551548135*^9}, {
   3.6726935998847713`*^9, 3.672693632749387*^9}, {3.6726937259568768`*^9, 
   3.672693843370707*^9}, 3.672693944613657*^9, {3.67269400844032*^9, 
   3.672694067189702*^9}, {3.67269409898378*^9, 3.672694112539206*^9}, {
   3.672694187083549*^9, 3.672694189222487*^9}, {3.672694246525628*^9, 
   3.6726943536472473`*^9}, {3.672694391943015*^9, 3.672694505181711*^9}, {
   3.672694559350322*^9, 3.672694577814125*^9}, {3.672694655718596*^9, 
   3.6726946930611486`*^9}, {3.672694723990568*^9, 3.672694724943056*^9}, {
   3.672694855166526*^9, 3.672694913155439*^9}, {3.6726951553099422`*^9, 
   3.672695203101695*^9}, {3.67269536826511*^9, 3.6726953821282473`*^9}, {
   3.672695552854991*^9, 3.6726955738793983`*^9}, {3.672695752262329*^9, 
   3.672695752365918*^9}, {3.672695824490589*^9, 3.6726958792152853`*^9}, {
   3.6726959431211042`*^9, 3.6726959670481873`*^9}, {3.672696017918066*^9, 
   3.6726960274815683`*^9}, {3.67269613970462*^9, 3.6726962229860067`*^9}, {
   3.672696287737165*^9, 3.672696328547615*^9}, {3.67269747154923*^9, 
   3.672697472038979*^9}, {3.6726976914140797`*^9, 3.672697695460619*^9}, {
   3.672698102387224*^9, 3.672698105180998*^9}, {3.672700035264449*^9, 
   3.672700040152289*^9}, {3.672700084672333*^9, 3.672700087320628*^9}, {
   3.672700708068287*^9, 3.6727007117081633`*^9}, {3.6727007995159807`*^9, 
   3.672700803338045*^9}, {3.672701089065866*^9, 3.6727010919369802`*^9}, {
   3.672701484781591*^9, 3.672701497144752*^9}, {3.672701560355649*^9, 
   3.6727015682250757`*^9}, {3.672701677753438*^9, 3.6727016928572617`*^9}, 
   3.6727017587797937`*^9, {3.672701807251649*^9, 3.6727018077472687`*^9}, {
   3.672701854353104*^9, 3.672701878565934*^9}, {3.672702057929041*^9, 
   3.672702061744937*^9}, {3.6727021234171047`*^9, 3.672702180689454*^9}, {
   3.672702218665371*^9, 3.67270224271599*^9}, {3.6727023372226152`*^9, 
   3.672702356533304*^9}, {3.672702400161747*^9, 3.672702475109668*^9}, {
   3.672702570700927*^9, 3.672702571142228*^9}, {3.672702636017701*^9, 
   3.672702703568791*^9}, {3.67270273385254*^9, 3.6727027347396*^9}, {
   3.672702807871664*^9, 3.672702811483864*^9}, {3.6727529627228603`*^9, 
   3.672752979883024*^9}, {3.672753129734693*^9, 3.672753130282076*^9}, {
   3.672753696974927*^9, 3.672753697108047*^9}, 3.67301208212906*^9, {
   3.6730322972644587`*^9, 3.673032304888184*^9}, {3.673098271982088*^9, 
   3.673098281902074*^9}, {3.673101061992713*^9, 3.6731010928408623`*^9}, {
   3.67310178520047*^9, 3.673101820768058*^9}, {3.673101876656198*^9, 
   3.6731018837285633`*^9}, {3.673101927024683*^9, 3.673101941432461*^9}, {
   3.6731020301070757`*^9, 3.6731020662405367`*^9}, {3.673358025075101*^9, 
   3.673358115418865*^9}, {3.673358165658869*^9, 3.6733581805141573`*^9}, {
   3.673358250105185*^9, 3.6733584613533907`*^9}, 3.673358661304319*^9, {
   3.673358967757855*^9, 3.6733590035256166`*^9}, {3.673874817913553*^9, 
   3.673874917256021*^9}, {3.6738749685463123`*^9, 3.673874984842207*^9}, 
   3.673877075691533*^9, {3.6738875993359833`*^9, 3.6738876013905573`*^9}, {
   3.6738876605762444`*^9, 3.673887709029273*^9}, 3.673888007843915*^9, {
   3.6738882524999228`*^9, 3.673888271283836*^9}, {3.6738883377377357`*^9, 
   3.67388834674135*^9}, {3.6738886113558397`*^9, 3.673888652243003*^9}, {
   3.673888707700097*^9, 3.6738887308344193`*^9}, {3.673891909775126*^9, 
   3.673891915972452*^9}, {3.6738949101254883`*^9, 3.673894955517169*^9}, {
   3.673895004301632*^9, 3.673895040812294*^9}, {3.67389509656043*^9, 
   3.673895113555835*^9}, {3.6739019536232233`*^9, 3.67390195959647*^9}, {
   3.673901995605878*^9, 3.673902059752323*^9}, {3.673902090853119*^9, 
   3.673902094812497*^9}, {3.6739033080192547`*^9, 3.673903310722788*^9}, {
   3.673903375076022*^9, 3.673903378009913*^9}, {3.673903734485278*^9, 
   3.673903736746828*^9}, {3.673904556289222*^9, 3.6739045769191723`*^9}, {
   3.673904760102078*^9, 3.673904810167603*^9}, 3.673906316462513*^9, 
   3.673906862727273*^9, 3.673906894778244*^9, {3.6739069759109163`*^9, 
   3.6739069791259317`*^9}, {3.673907687048004*^9, 3.673907734416007*^9}, {
   3.673980640599923*^9, 3.6739806410445147`*^9}, {3.674211377975418*^9, 
   3.674211454469534*^9}, {3.674211681028718*^9, 3.674211683262289*^9}, {
   3.6742118312275133`*^9, 3.6742119378369226`*^9}, {3.67421270242515*^9, 
   3.67421271783281*^9}, {3.674212794200244*^9, 3.674212826918982*^9}, {
   3.6742409601830187`*^9, 3.6742409798948803`*^9}, {3.6742427859287252`*^9, 
   3.674242788599822*^9}, {3.6742435455748463`*^9, 3.674243575568511*^9}, {
   3.674244107045616*^9, 3.6742441578368587`*^9}, {3.674248146569025*^9, 
   3.674248147824648*^9}, {3.674248474542336*^9, 3.674248524526622*^9}, {
   3.674248676541396*^9, 3.674248688363146*^9}, {3.6742487235025167`*^9, 
   3.674248807116983*^9}, 3.6742489704306602`*^9, {3.6742490355443687`*^9, 
   3.6742490619659348`*^9}, {3.6742492033108387`*^9, 
   3.6742492331107817`*^9}, {3.67424929212682*^9, 3.674249408694014*^9}, {
   3.674249449913291*^9, 3.674249512337346*^9}, {3.674249544233197*^9, 
   3.6742495454066343`*^9}, {3.674249613822822*^9, 3.674249663504469*^9}, {
   3.674249796963423*^9, 3.6742497989818983`*^9}, {3.674249852433365*^9, 
   3.674249996755879*^9}, {3.6742501171241426`*^9, 3.674250122276148*^9}, {
   3.6742501985826387`*^9, 3.674250201742154*^9}, {3.674250238231061*^9, 
   3.674250359041584*^9}, {3.6742996530171537`*^9, 3.674299863008119*^9}, {
   3.6742999394414253`*^9, 3.6743000104326143`*^9}, {3.674301427391222*^9, 
   3.67430149153786*^9}, {3.674301523251935*^9, 3.6743015620399733`*^9}, {
   3.674301595660828*^9, 3.67430161392607*^9}, {3.674301657180964*^9, 
   3.6743016966962442`*^9}, {3.674301733103218*^9, 3.674301871217772*^9}, {
   3.674301943013172*^9, 3.67430195447812*^9}, {3.6743019955890207`*^9, 
   3.674302027987605*^9}, {3.674302078423712*^9, 3.6743021256987553`*^9}, {
   3.67430216578376*^9, 3.67430222351124*^9}, {3.674302267613106*^9, 
   3.674302493443345*^9}, {3.674302634084964*^9, 3.674302685517054*^9}, {
   3.674302780708331*^9, 3.6743028063311*^9}, {3.674302845460978*^9, 
   3.67430287427168*^9}, {3.6743033328080053`*^9, 3.674303376831204*^9}, {
   3.674303516527814*^9, 3.674303523395761*^9}, {3.674303932152179*^9, 
   3.674304041208248*^9}, 3.674304873373579*^9, 3.6743050159308233`*^9, {
   3.6743051297394857`*^9, 3.674305140745101*^9}, {3.674305238749601*^9, 
   3.674305297444996*^9}, {3.674306246397758*^9, 3.6743062826777*^9}, {
   3.67430631979215*^9, 3.674306395709548*^9}, {3.674308656461747*^9, 
   3.674308660589966*^9}, {3.6743086966783524`*^9, 3.674308740730666*^9}, {
   3.674308778843265*^9, 3.6743087806005983`*^9}, {3.6743093775854673`*^9, 
   3.674309413336793*^9}, {3.6743094544435883`*^9, 3.674309483867872*^9}, {
   3.6743095994088507`*^9, 3.6743096711395884`*^9}, {3.6743101220279303`*^9, 
   3.674310154693549*^9}, {3.6743102638356752`*^9, 3.6743102724535427`*^9}, {
   3.6743103441851177`*^9, 3.674310397153015*^9}, {3.674310427633232*^9, 
   3.674310432697427*^9}, {3.674313282541847*^9, 3.674313292312448*^9}, {
   3.674313382664526*^9, 3.6743133851872053`*^9}, {3.6743350805814877`*^9, 
   3.6743351096853867`*^9}, {3.674335141237241*^9, 3.6743352042262487`*^9}, {
   3.67434293719524*^9, 3.67434296561924*^9}, {3.674343378287632*^9, 
   3.674343400605236*^9}, {3.674344321745956*^9, 3.674344326260524*^9}, {
   3.674344375946013*^9, 3.674344395756649*^9}, {3.674344434747725*^9, 
   3.674344451059972*^9}, {3.674344521364704*^9, 3.674344524474246*^9}, {
   3.674346183576919*^9, 3.674346262446266*^9}, {3.674346299553946*^9, 
   3.674346339587463*^9}, {3.674346410423072*^9, 3.6743464663933*^9}, {
   3.674346496793838*^9, 3.674346515720117*^9}, {3.67434656623132*^9, 
   3.674346706325735*^9}, {3.674346745424098*^9, 3.6743467913708963`*^9}, {
   3.674346893019315*^9, 3.6743469015448523`*^9}, {3.674347085557316*^9, 
   3.674347086835973*^9}, {3.6743471621534986`*^9, 3.674347172462667*^9}, {
   3.674347229228416*^9, 3.674347263706582*^9}, {3.6743474493846407`*^9, 
   3.674347455711891*^9}, {3.67434748716045*^9, 3.674347506663555*^9}, {
   3.674347583847559*^9, 3.6743475873631496`*^9}, {3.6743486580983458`*^9, 
   3.6743487051469297`*^9}, {3.674409869008679*^9, 3.674409887140244*^9}, {
   3.674409924193639*^9, 3.674409970123204*^9}, {3.674410079978239*^9, 
   3.674410101492516*^9}, 3.6744871906523542`*^9, {3.6760471531214123`*^9, 
   3.676047170677*^9}, {3.676048547819709*^9, 3.676048549423305*^9}, {
   3.676048616616145*^9, 3.676048700056699*^9}, {3.676048798061676*^9, 
   3.676048806136372*^9}, {3.676049106306778*^9, 3.6760492732588654`*^9}, {
   3.67604931427066*^9, 3.6760495029459476`*^9}, {3.6760496400118427`*^9, 
   3.676049666152979*^9}, {3.676049700568548*^9, 3.676049938399273*^9}, {
   3.676050097851817*^9, 3.6760502323341618`*^9}, {3.676050265189188*^9, 
   3.676050456243586*^9}, {3.6760505983396606`*^9, 3.676050725889217*^9}, {
   3.676050819053259*^9, 3.676050883983387*^9}, {3.6760509750434732`*^9, 
   3.676050993779171*^9}, {3.676051174094154*^9, 3.676051215595016*^9}, {
   3.676051247906414*^9, 3.676051281994763*^9}, {3.6760515117992277`*^9, 
   3.676051532945312*^9}, {3.676051574525729*^9, 3.6760516308808737`*^9}, {
   3.676051701373907*^9, 3.676051738187151*^9}, {3.676051768990121*^9, 
   3.6760517713241463`*^9}, {3.676051875375017*^9, 3.676051877066955*^9}, 
   3.676051946292514*^9, {3.676052013153243*^9, 3.676052014753112*^9}, {
   3.67605206152334*^9, 3.676052099456677*^9}, {3.6760522887177153`*^9, 
   3.676052316513753*^9}, {3.676052409730052*^9, 3.6760524422800713`*^9}, {
   3.676053289435965*^9, 3.676053290620812*^9}, {3.676053324845545*^9, 
   3.676053353404633*^9}, {3.676053388513157*^9, 3.676053492047226*^9}, {
   3.676053603425272*^9, 3.6760536994379063`*^9}, {3.676053732819481*^9, 
   3.6760537409668503`*^9}, {3.676053803887218*^9, 3.676053820667923*^9}, {
   3.676053883298531*^9, 3.676053903443747*^9}, {3.6760539349272747`*^9, 
   3.676053961825531*^9}, {3.676054153510824*^9, 3.676054215339883*^9}, {
   3.6760543099133673`*^9, 3.676054325454887*^9}, {3.676054411504983*^9, 
   3.676054433028955*^9}, {3.676054503428403*^9, 3.676054678368531*^9}, 
   3.676054711966275*^9, {3.676054753106022*^9, 3.6760548133113413`*^9}, {
   3.676055533410301*^9, 3.676055973210986*^9}, {3.676056048223258*^9, 
   3.6760561940897293`*^9}, {3.6760568301374273`*^9, 3.676056830320964*^9}, 
   3.676056872559063*^9, {3.676056914066873*^9, 3.676057025438158*^9}, {
   3.676057067158854*^9, 3.676057087970922*^9}, 3.6760575343916807`*^9, {
   3.676057790459848*^9, 3.676057889167351*^9}, {3.676058572113256*^9, 
   3.676058596045274*^9}, {3.676058642791382*^9, 3.676058644013554*^9}, {
   3.676058813787499*^9, 3.676058820285762*^9}, {3.676058881760676*^9, 
   3.67605888720793*^9}, {3.676059331100256*^9, 3.676059335658771*^9}, 
   3.676059770027566*^9, {3.676059830719042*^9, 3.6760599294357233`*^9}, {
   3.6760601138129063`*^9, 3.67606012332051*^9}, {3.679748340894038*^9, 
   3.679748346913802*^9}, {3.679748453387858*^9, 3.679748457200718*^9}, {
   3.679748611824592*^9, 3.679748613408367*^9}, {3.679748698095044*^9, 
   3.679748724496223*^9}, {3.6797488886403112`*^9, 3.6797488894831057`*^9}, {
   3.6797489203128633`*^9, 3.679748988334412*^9}, {3.680263865974887*^9, 
   3.6802639660039787`*^9}, {3.680273205788069*^9, 3.6802732121085873`*^9}, {
   3.688416633173313*^9, 3.688416649754773*^9}, {3.688496329206805*^9, 
   3.688496407311056*^9}, {3.688496570318328*^9, 3.688496616471798*^9}, {
   3.688496670290443*^9, 3.688496742316781*^9}, {3.688496806692589*^9, 
   3.688496817665197*^9}, {3.6884968564135838`*^9, 3.6884969056064463`*^9}, {
   3.688497068167651*^9, 3.688497127973667*^9}, {3.688497163917473*^9, 
   3.688497316093443*^9}, {3.68849743523099*^9, 3.688497522308679*^9}, {
   3.68849755259517*^9, 3.688497552755789*^9}, {3.68849758603631*^9, 
   3.688497675762858*^9}, {3.6884977142518063`*^9, 3.688497717387269*^9}, {
   3.688497759029807*^9, 3.688497773131654*^9}, {3.688497822457529*^9, 
   3.68849782304989*^9}, {3.6884978749959908`*^9, 3.6884979338203487`*^9}, {
   3.68849797215511*^9, 3.6884979732818336`*^9}, {3.68849826021373*^9, 
   3.688498304158477*^9}, {3.68849835973415*^9, 3.688498465429776*^9}, {
   3.6884985047090483`*^9, 3.688498524423489*^9}, {3.688498586375927*^9, 
   3.688498669172081*^9}, {3.688498791811262*^9, 3.688498810210896*^9}, {
   3.688499002313498*^9, 3.688499024257598*^9}, {3.688499069833061*^9, 
   3.6884990889612083`*^9}, {3.688499142425269*^9, 3.6884991753287077`*^9}, {
   3.688499578351625*^9, 3.688499625582683*^9}, {3.688500056949442*^9, 
   3.68850005818894*^9}, {3.688502598449621*^9, 3.6885026051213303`*^9}, {
   3.6885026391722927`*^9, 3.688502680809268*^9}, {3.688502751610351*^9, 
   3.688502776755432*^9}, {3.68869777730236*^9, 3.688697812074387*^9}, {
   3.688699445340794*^9, 3.6886994498212337`*^9}, {3.688701624033401*^9, 
   3.688701641500565*^9}, {3.688705127935446*^9, 3.6887051338484497`*^9}, {
   3.6887052862265053`*^9, 3.688705294461854*^9}, {3.6887057174839783`*^9, 
   3.6887057178280907`*^9}, {3.688740871405038*^9, 3.6887409259968843`*^9}, {
   3.688741355077259*^9, 3.688741356597086*^9}, {3.699369882253406*^9, 
   3.699369887437744*^9}}]
},
ScreenStyleEnvironment->"Condensed",
WindowSize->{1535, 876},
WindowMargins->{{-10, Automatic}, {Automatic, -10}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PaperOrientation"->"Landscape",
"PaperSize"->{Automatic, Automatic},
"PostScriptOutputFile"->"/home/kevin/base_code2d.pdf"},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 9, 2015)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> "10.3 for Linux x86 (64-bit) (October 9, 2015)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 160, 3, 19, "Input"],
Cell[721, 25, 53002, 1434, 1820, "Input"],
Cell[53726, 1461, 32270, 722, 1058, "Input"],
Cell[85999, 2185, 15176, 363, 633, "Input"],
Cell[101178, 2550, 13385, 317, 489, "Input"],
Cell[114566, 2869, 6395, 167, 273, "Input"],
Cell[120964, 3038, 12120, 298, 453, "Input"],
Cell[133087, 3338, 11072, 282, 473, "Input"],
Cell[144162, 3622, 8212, 210, 561, "Input"],
Cell[152377, 3834, 19621, 455, 964, "Input"],
Cell[172001, 4291, 31648, 700, 1463, "Input"],
Cell[203652, 4993, 5322, 141, 219, "Input"],
Cell[208977, 5136, 3527, 100, 264, "Input"],
Cell[212507, 5238, 45853, 770, 1281, "Input"]
}
]
*)

(* End of internal cache information *)
