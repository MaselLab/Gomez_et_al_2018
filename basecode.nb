(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    205797,       4687]
NotebookOptionsPosition[    204561,       4651]
NotebookOutlinePosition[    205366,       4677]
CellTagsIndexPosition[    205323,       4674]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Minor", " ", "Modules"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.688413374061702*^9, 3.688413375285242*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"getUniqueGenotype", "[", "genotypeElem_", "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"genotypeElem", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", 
       RowBox[{"10", "^", "i"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testGenoType", "[", 
     RowBox[{"genotype_", ",", "fitnesscriteria_", ",", "indx_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"genotype", "[", 
        RowBox[{"[", "indx", "]"}], "]"}], "\[Equal]", "fitnesscriteria"}], 
      ",", "True", ",", "False"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getMaxTraitValue", "[", 
     RowBox[{"genotypes_", ",", "traitnumber_"}], "]"}], ":=", 
    RowBox[{"Max", "[", 
     RowBox[{"genotypes", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "traitnumber"}], "]"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getMinTraitValue", "[", 
     RowBox[{"genotypes_", ",", "traitnumber_"}], "]"}], ":=", 
    RowBox[{"Min", "[", 
     RowBox[{"genotypes", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "traitnumber"}], "]"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getNumGenotypes", "[", "genotypes_", "]"}], ":=", 
    RowBox[{"Length", "[", "genotypes", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"groupNewMutantsList", "[", "newmutantgenotypes_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sortedmutantlist", ",", "mutantparentlist"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sortedmutantlist", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"newmutantgenotypes", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"{", "}"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "newmutantgenotypes", "]"}]}], "}"}]}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"mutantparentlist", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"newmutantgenotypes", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "==", 
               RowBox[{
                RowBox[{"sortedmutantlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"sortedmutantlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sortedmutantlist", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"mutantparentlist", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", "2"}], "]"}], "]"}], "}"}]}], "]"}]}], 
             ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", "mutantparentlist", "]"}]}], "}"}]}], 
           "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "sortedmutantlist", "]"}]}], "}"}]}], "]"}],
        ";", "\[IndentingNewLine]", "sortedmutantlist"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getIndicesForSpecificTimes", "[", 
     RowBox[{"timestart_", ",", "timeend_", ",", "times_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"indces", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], ",", 
        RowBox[{"sentval", "=", "1"}], ",", 
        RowBox[{"maxloop", "=", 
         RowBox[{"Length", "[", "times", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"times", "[", 
           RowBox[{"[", "sentval", "]"}], "]"}], "<", "timestart"}], ",", 
         RowBox[{
          RowBox[{"sentval", "+=", "1"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indces", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", "sentval"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"times", "[", 
             RowBox[{"[", "sentval", "]"}], "]"}], "<", "timeend"}], ",", 
           RowBox[{"sentval", "<", "maxloop"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"sentval", "+=", "1"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indces", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", "sentval"}], ";", 
       "\[IndentingNewLine]", "indces"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.688412471806587*^9, 3.6884124739186907`*^9}, {
   3.6884132220453863`*^9, 3.688413269712187*^9}, {3.688413500791074*^9, 
   3.6884135113346977`*^9}, {3.688413551542964*^9, 3.688413552382203*^9}, {
   3.688413624055681*^9, 3.68841365115879*^9}, {3.688413734422659*^9, 
   3.688413752695053*^9}, {3.688413791375156*^9, 3.68841384148593*^9}, {
   3.688416450710711*^9, 3.6884164662284517`*^9}, {3.689022809875592*^9, 
   3.689022894822641*^9}, {3.689022985796865*^9, 3.6890230361401987`*^9}, 
   3.68902350645082*^9, {3.689023538898521*^9, 3.6890235912829323`*^9}, {
   3.689023824555873*^9, 3.689023825017283*^9}, {3.68936074856649*^9, 
   3.689360862614729*^9}, {3.689360921734653*^9, 3.689360967022915*^9}, {
   3.689360997238782*^9, 3.689361049622375*^9}, {3.689361084100686*^9, 
   3.689361382991395*^9}, {3.6893649535009527`*^9, 3.6893650064649467`*^9}, {
   3.689432984987524*^9, 3.689433049354416*^9}, {3.6894331198100224`*^9, 
   3.689433387880692*^9}, {3.689433433456827*^9, 3.689433439856921*^9}, {
   3.689433524816661*^9, 3.689433623697349*^9}, {3.689433670927103*^9, 
   3.689433791735464*^9}, {3.6894338475605392`*^9, 3.689433873462957*^9}, {
   3.689434129974052*^9, 3.6894341471895*^9}, {3.689434485803258*^9, 
   3.689434495203923*^9}, {3.689439513123231*^9, 3.689439527746624*^9}, {
   3.689440389854795*^9, 3.689440393510035*^9}, {3.689440448566277*^9, 
   3.689440449191861*^9}, {3.689541048214299*^9, 3.689541417470614*^9}, {
   3.6896134559829807`*^9, 3.689613459873115*^9}, {3.689613543486578*^9, 
   3.6896135751904373`*^9}, {3.689618656735084*^9, 3.689618657319641*^9}, {
   3.6896191061374903`*^9, 3.689619143497912*^9}, {3.6896191810974913`*^9, 
   3.689619222921636*^9}, {3.689619257809943*^9, 3.689619258846815*^9}, {
   3.689619310402206*^9, 3.689619325532127*^9}, {3.689619396522592*^9, 
   3.689619424585968*^9}, {3.689619467931018*^9, 3.6896194747700453`*^9}, {
   3.6896195255712214`*^9, 3.689619528754867*^9}, {3.689619563674999*^9, 
   3.689619593491666*^9}, {3.6896196342995663`*^9, 3.689619636147263*^9}, {
   3.689632284004088*^9, 3.689632317779997*^9}, {3.689632349116199*^9, 
   3.689632351396144*^9}, {3.689632386044806*^9, 3.689632421412462*^9}, {
   3.6896324624846478`*^9, 3.6896324760069237`*^9}, {3.689632563013093*^9, 
   3.689632570365114*^9}, {3.689632671164804*^9, 3.689632809998295*^9}, {
   3.689632859990484*^9, 3.6896329163827972`*^9}, {3.68963294835081*^9, 
   3.68963322546914*^9}, {3.6896332794566298`*^9, 3.689633321409637*^9}, {
   3.6896334816095257`*^9, 3.689633492572557*^9}, 3.689633543346375*^9, {
   3.689633664266124*^9, 3.689633702146152*^9}, {3.689633759499207*^9, 
   3.689633890267881*^9}, {3.689634034419132*^9, 3.689634039580454*^9}, {
   3.689706687444705*^9, 3.689706911104314*^9}, {3.689707073394923*^9, 
   3.689707210089472*^9}, {3.689707240793353*^9, 3.689707250250153*^9}, {
   3.689707315267625*^9, 3.689707337633005*^9}, {3.689707377504327*^9, 
   3.689707487812552*^9}, {3.689707520147138*^9, 3.689707557602331*^9}, {
   3.689707590765932*^9, 3.689707632867414*^9}, {3.68970806155194*^9, 
   3.6897080622809668`*^9}, {3.6897095864918537`*^9, 
   3.6897096478396606`*^9}, {3.689964826877388*^9, 3.689965131196097*^9}, {
   3.6899651732121687`*^9, 3.689965187253381*^9}, {3.689965217659198*^9, 
   3.689965330415948*^9}, {3.689965457246358*^9, 3.6899655263415422`*^9}, {
   3.689969275991559*^9, 3.689969280756843*^9}, {3.690031822355171*^9, 
   3.690031936450992*^9}, {3.690031973683144*^9, 3.6900321004704437`*^9}, {
   3.690032137915729*^9, 3.690032372837318*^9}, {3.6900324485413513`*^9, 
   3.690032453507702*^9}, {3.690141666854476*^9, 3.69014174288325*^9}, {
   3.690141784862824*^9, 3.6901418726060133`*^9}, {3.690143905194457*^9, 
   3.690143999954196*^9}, {3.694539188448215*^9, 3.694539197760193*^9}, {
   3.697464349799634*^9, 3.697464372709033*^9}, {3.698078688117323*^9, 
   3.698078688557488*^9}, {3.700504470078465*^9, 3.700504552125361*^9}, {
   3.7005047936499863`*^9, 3.7005048052658052`*^9}, {3.7005077750694*^9, 
   3.7005077759726152`*^9}, {3.7005948919837313`*^9, 
   3.7005948970725117`*^9}, {3.7005951934908247`*^9, 3.700595482759246*^9}, {
   3.700595641047035*^9, 3.700595666271315*^9}, {3.700595706728497*^9, 
   3.700595768072362*^9}, {3.700595847714031*^9, 3.700595851937893*^9}, {
   3.70059606675515*^9, 3.7005960700592327`*^9}, {3.700596143517243*^9, 
   3.700596389846373*^9}, {3.700596477320074*^9, 3.700596479547784*^9}, {
   3.7005965262877607`*^9, 3.700596526838683*^9}, {3.7005965812423058`*^9, 
   3.700596589408474*^9}, {3.70059675634702*^9, 3.700596834435401*^9}, {
   3.7005968789006777`*^9, 3.700596925290163*^9}, {3.7005971604397793`*^9, 
   3.700597171182982*^9}, {3.700597204735351*^9, 3.700597226119844*^9}, {
   3.700597371679489*^9, 3.700597372465577*^9}, {3.7005974169524612`*^9, 
   3.7005974447783813`*^9}, {3.700597584141173*^9, 3.7005976828929567`*^9}, {
   3.700598125322444*^9, 3.700598142450499*^9}, {3.700598255852654*^9, 
   3.700598292412166*^9}, {3.7005983502616243`*^9, 3.700598366909827*^9}, {
   3.700598489351056*^9, 3.700598610169509*^9}, {3.7005986461686993`*^9, 
   3.700598655984787*^9}, {3.7006000285601587`*^9, 3.700600029893737*^9}, {
   3.700835361299778*^9, 3.700835751845468*^9}, {3.7008364073795633`*^9, 
   3.7008364181153173`*^9}, {3.7126785279630003`*^9, 3.7126785686397057`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"collectMyData", "[", 
    RowBox[{
    "dataamount_", ",", "globaltime_", ",", "addtime_", ",", "genotypes_", 
     ",", "genotypeabundances_", ",", "popsize_", ",", "\[CapitalDelta]c1_", 
     ",", "\[CapitalDelta]c2_", ",", "mutpfix_", ",", "mutgenotype_"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "timestamp", ",", "rbar", ",", " ", "ibar", ",", "jbar", ",", "var", 
       ",", "vari", ",", "varj", ",", "covij", ",", "subload", ",", 
       "truepopsize", ",", "mutboundary", ",", "linkagedisequilibria", ",", 
       "genotypefrequencies", ",", "unitmatrix"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timestamp", "=", 
       RowBox[{"globaltime", "+", "addtime"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"changetype", " ", "indicates", " ", "0"}], "=", "start"}], 
        ",", 
        RowBox[{"1", "=", "adapt"}], ",", 
        RowBox[{"2", "=", "env"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"COLLECT", " ", "SUMMARY", " ", "DATA", " ", 
         RowBox[{"ONLY", ":", " ", 
          RowBox[{"{", 
           RowBox[{"TIMESTAMP", ",", " ", 
            RowBox[{"MEAN", " ", "FITNESSES"}], ",", " ", "VARIANCES", ",", 
            " ", "COVARIANCES", ",", " ", 
            RowBox[{"SUBSTITUTIONAL", " ", "LOAD"}]}], "}"}]}]}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dataamount", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"truepopsize", "=", 
          RowBox[{"Total", "[", "genotypeabundances", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mutboundary", "=", 
          RowBox[{"getNextMutants", "[", 
           RowBox[{
           "genotypes", ",", "genotypeabundances", ",", "\[CapitalDelta]c1", 
            ",", "\[CapitalDelta]c2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mutboundary", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"genotypes", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"mutboundary", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "mutboundary", "]"}]}], "}"}]}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "ibar", " ", ",", "jbar", ",", "rbar", ",", "covij", ",", "vari", 
            ",", "varj", ",", "var", ",", "subload", ",", "truepopsize", ",", 
            "linkagedisequilibria"}], "}"}], "=", 
          RowBox[{"getSummaryResults", "[", 
           RowBox[{
           "genotypes", ",", "genotypeabundances", ",", "\[CapitalDelta]c1", 
            ",", "\[CapitalDelta]c2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Sow", "[", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "timestamp", ",", "ibar", ",", "jbar", ",", "rbar", ",", "covij",
               ",", "vari", ",", "varj", ",", "var", ",", "subload", ",", 
              "truepopsize", ",", "linkagedisequilibria", ",", "mutpfix", ",",
               "mutgenotype"}], "}"}], ",", "16"}], "]"}], "]"}], ";"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"COLLECT", " ", "ALL", " ", 
          RowBox[{"DATA", ":", " ", 
           RowBox[{"{", 
            RowBox[{
            "TIMESTAMP", ",", " ", "GENOTYPES", ",", " ", 
             "GENOTYPEABUNDANCES"}], "}"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dataamount", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ibar", ",", "jbar"}], "}"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"Total", "[", "genotypeabundances", "]"}]}], ")"}], 
             RowBox[{
              RowBox[{"{", "genotypeabundances", "}"}], ".", "genotypes"}]}], 
            ")"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Sow", "[", 
          RowBox[{"{", 
           RowBox[{
           "timestamp", ",", "genotypes", ",", "genotypeabundances", ",", 
            RowBox[{"{", 
             RowBox[{"ibar", ",", "jbar"}], "}"}], ",", "mutgenotype", ",", 
            "mutpfix"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.676057217710558*^9, 3.676057257543845*^9}, {
   3.676057313582016*^9, 3.676057330942709*^9}, {3.6760574615549297`*^9, 
   3.6760574839326487`*^9}, {3.676139454986308*^9, 3.67613947117892*^9}, 
   3.679678585386517*^9, {3.6796793377317533`*^9, 3.679679355731744*^9}, 
   3.679679397947184*^9, {3.679679514947815*^9, 3.679679549708643*^9}, {
   3.679679659508453*^9, 3.679679722403511*^9}, {3.679679765539963*^9, 
   3.6796798085641212`*^9}, {3.679680042637319*^9, 3.679680045044932*^9}, {
   3.6797465829771423`*^9, 3.679746607425165*^9}, 3.6797481496574306`*^9, {
   3.67974857410098*^9, 3.6797485776874113`*^9}, {3.679748804526732*^9, 
   3.679748875214695*^9}, {3.680264010592164*^9, 3.680264026418696*^9}, {
   3.688413387638962*^9, 3.68841339254344*^9}, {3.688413536310575*^9, 
   3.688413537304462*^9}, {3.688499283941951*^9, 3.688499409020886*^9}, {
   3.688499661363214*^9, 3.688499719266878*^9}, {3.68849978660354*^9, 
   3.688499802258658*^9}, {3.688499845250732*^9, 3.688499888178404*^9}, {
   3.688499946490108*^9, 3.688500020954081*^9}, {3.688500100177619*^9, 
   3.688500122641273*^9}, {3.6885004343420877`*^9, 3.688500445143436*^9}, {
   3.688500479135149*^9, 3.6885008203978767`*^9}, {3.688500859214384*^9, 
   3.68850094380514*^9}, {3.68850097563783*^9, 3.688501171965311*^9}, {
   3.6885012110843077`*^9, 3.688501220183997*^9}, {3.688501255708239*^9, 
   3.688501264566325*^9}, {3.688501372667622*^9, 3.688501447819745*^9}, {
   3.688501491420123*^9, 3.688501674579803*^9}, {3.688501711722807*^9, 
   3.6885018429386787`*^9}, {3.688501893162464*^9, 3.6885019020103607`*^9}, {
   3.688501959818295*^9, 3.6885023485532618`*^9}, {3.6885024203688498`*^9, 
   3.688502559223229*^9}, {3.688699770775094*^9, 3.6886997743551693`*^9}, {
   3.688699808835582*^9, 3.688699813280896*^9}, {3.688701414293068*^9, 
   3.688701442878735*^9}, {3.688701599287324*^9, 3.688701606645568*^9}, {
   3.688701716110155*^9, 3.6887017202034388`*^9}, {3.6887018808592243`*^9, 
   3.688701906301113*^9}, {3.688739898802807*^9, 3.688740023523638*^9}, {
   3.688740056579624*^9, 3.688740102652411*^9}, {3.688740584387495*^9, 
   3.688740598176127*^9}, {3.6887534527274513`*^9, 3.688753498066927*^9}, {
   3.688753529303651*^9, 3.688753552337517*^9}, {3.689357067141979*^9, 
   3.689357113071896*^9}, {3.689358014326524*^9, 3.689358026646245*^9}, {
   3.68936723099859*^9, 3.689367295135015*^9}, {3.68936767931957*^9, 
   3.689367743903286*^9}, {3.689368439959461*^9, 3.6893684610554047`*^9}, 
   3.6893694823203573`*^9, {3.689426175940833*^9, 3.689426179619925*^9}, {
   3.689438319399035*^9, 3.6894383483341007`*^9}, {3.6894383809185257`*^9, 
   3.6894384143431587`*^9}, {3.689438458061956*^9, 3.689438527757937*^9}, {
   3.689439018755101*^9, 3.689439038435278*^9}, {3.689439077731921*^9, 
   3.689439084692482*^9}, {3.6894393932025213`*^9, 3.68943939822511*^9}, {
   3.68944125248882*^9, 3.68944128930484*^9}, {3.689441349080769*^9, 
   3.689441377855089*^9}, {3.6894414162966337`*^9, 3.689441475904031*^9}, {
   3.6894415471995583`*^9, 3.689441589521233*^9}, {3.6894416363593073`*^9, 
   3.689441656759499*^9}, {3.68945384971353*^9, 3.6894539376576653`*^9}, {
   3.689453995648777*^9, 3.6894540523572283`*^9}, {3.689454084224292*^9, 
   3.689454099161302*^9}, {3.690032573498331*^9, 3.6900326055951443`*^9}, {
   3.690032652730451*^9, 3.6900327068579407`*^9}, {3.697201610544409*^9, 
   3.697201629032106*^9}, {3.697201659344121*^9, 3.697201761929751*^9}, {
   3.697201820425222*^9, 3.697201824762344*^9}, {3.697202277075926*^9, 
   3.697202282146859*^9}, {3.6972023556298723`*^9, 3.697202507437818*^9}, {
   3.6972025912544622`*^9, 3.6972026616620903`*^9}, {3.6972027095663767`*^9, 
   3.6972027288871098`*^9}, {3.69720276373482*^9, 3.697202768046702*^9}, {
   3.697202803239305*^9, 3.697202829726984*^9}, {3.697202945607668*^9, 
   3.697203050121335*^9}, 3.697203102144354*^9, {3.6972031473522577`*^9, 
   3.697203295874695*^9}, {3.697203345530189*^9, 3.697203362129621*^9}, {
   3.6972035675803347`*^9, 3.69720392073985*^9}, {3.697203950972847*^9, 
   3.697203999015189*^9}, {3.697204065349353*^9, 3.697204084869459*^9}, {
   3.697463676163353*^9, 3.697463777876505*^9}, {3.6974638248527203`*^9, 
   3.6974638338207693`*^9}, {3.697465455568074*^9, 3.697465498597948*^9}, {
   3.697554920317305*^9, 3.6975549569740562`*^9}, {3.69936959164509*^9, 
   3.699369654389179*^9}, {3.700599093301094*^9, 3.700599294778405*^9}, {
   3.700599397192471*^9, 3.700599484119349*^9}, {3.700599542234983*^9, 
   3.700599617073048*^9}, {3.700599654969419*^9, 3.7005997014261227`*^9}, {
   3.700613482753351*^9, 3.7006134934131308`*^9}, {3.7006179856380653`*^9, 
   3.700618033484565*^9}, {3.700618068409227*^9, 3.700618074027358*^9}, {
   3.7006181062800493`*^9, 3.700618110720443*^9}, {3.700618168317329*^9, 
   3.700618248027958*^9}, {3.700618364024975*^9, 3.700618370387192*^9}, 
   3.70061873963666*^9, {3.7006773595017633`*^9, 3.700677381917696*^9}, {
   3.70067762020048*^9, 3.700677736808549*^9}, {3.7006788451987953`*^9, 
   3.700678850231909*^9}, {3.700678897142865*^9, 3.700678933301113*^9}, {
   3.7008353556348057`*^9, 3.7008353591705437`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getSummaryResults", "[", 
    RowBox[{
    "genotypes_", ",", "genotypeabundances_", ",", "\[CapitalDelta]c1_", ",", 
     "\[CapitalDelta]c2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Declaring", " ", "local", " ", "variables"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ibar", ",", "jbar", ",", "rbar", ",", "covij", ",", "vari", ",", 
       "varj", ",", "var", ",", "subload", ",", "mutboundary", ",", "popsize",
        ",", "linkagedisequilibria", ",", "unitmatrix", ",", 
       "genotypefrequencies"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Calculating", " ", "Statistics"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"popsize", "=", 
       RowBox[{"Total", "[", "genotypeabundances", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mutboundary", "=", 
       RowBox[{"getNextMutants", "[", 
        RowBox[{
        "genotypes", ",", "genotypeabundances", ",", "\[CapitalDelta]c1", ",",
          "\[CapitalDelta]c2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mutboundary", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"genotypes", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mutboundary", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "mutboundary", "]"}]}], "}"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ibar", ",", "jbar"}], "}"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "popsize"}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", "genotypeabundances", "}"}], ".", "genotypes"}], 
          ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rbar", "=", 
       RowBox[{"1", "+", 
        RowBox[{"ibar", " ", "\[CapitalDelta]c1"}], "+", 
        RowBox[{"jbar", " ", "\[CapitalDelta]c2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"covij", "=", 
       RowBox[{"\[CapitalDelta]c1", " ", "\[CapitalDelta]c2", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"genotypes", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "ibar"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"genotypes", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", "jbar"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"genotypeabundances", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/", "popsize"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vari", "=", 
       RowBox[{
        SuperscriptBox["\[CapitalDelta]c1", "2"], " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", "ibar"}], ")"}], "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"genotypeabundances", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/", "popsize"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"varj", "=", 
       RowBox[{
        SuperscriptBox["\[CapitalDelta]c2", "2"], " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "jbar"}], ")"}], "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"genotypeabundances", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/", "popsize"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"var", " ", "=", " ", 
       RowBox[{"vari", "+", "varj", "+", 
        RowBox[{"2", "covij"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"subload", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{
             RowBox[{"mutboundary", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "\[CapitalDelta]c1"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"mutboundary", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "\[CapitalDelta]c2"}], "-", 
           "rbar"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "mutboundary", "]"}]}], "}"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"unitmatrix", "=", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"1", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"genotypes", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "-", 
             RowBox[{"Min", "[", 
              RowBox[{"genotypes", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "+", "1"}], 
            ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"genotypes", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "-", 
             RowBox[{"Min", "[", 
              RowBox[{"genotypes", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "+", "1"}]}], 
           "}"}]}], "]"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"genotypefrequencies", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"genotypes", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "-", 
            RowBox[{"Min", "[", 
             RowBox[{"genotypes", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "+", "1"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"genotypes", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "-", 
            RowBox[{"Min", "[", 
             RowBox[{"genotypes", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "+", "1"}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"genotypefrequencies", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"genotypes", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"Min", "[", 
              RowBox[{"genotypes", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "+", "1"}], 
            ",", 
            RowBox[{
             RowBox[{
              RowBox[{"genotypes", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"Min", "[", 
              RowBox[{"genotypes", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "+", "1"}]}], 
           "]"}], "]"}], "=", 
         RowBox[{"genotypeabundances", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"genotypefrequencies", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"Total", "[", 
           RowBox[{"Flatten", "[", "genotypefrequencies", "]"}], "]"}]}], 
         ")"}], "genotypefrequencies"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"linkagedisequilibria", "=", 
       RowBox[{"genotypefrequencies", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"genotypefrequencies", ".", "unitmatrix"}], ")"}], ".", 
         "genotypefrequencies"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "ibar", " ", ",", "jbar", ",", "rbar", ",", "covij", ",", "vari", ",", 
        "varj", ",", "var", ",", "subload", ",", "popsize", ",", 
        "linkagedisequilibria"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6893580316218433`*^9, 3.6893580537226*^9}, {
   3.689358301877377*^9, 3.6893583019428883`*^9}, {3.689358336872244*^9, 
   3.689358337060124*^9}, {3.689614844501265*^9, 3.689614941149366*^9}, {
   3.6896166336530523`*^9, 3.68961664906905*^9}, {3.689616721654586*^9, 
   3.689616735593315*^9}, {3.689616894790782*^9, 3.689616937566642*^9}, {
   3.689616983319069*^9, 3.689616988003171*^9}, {3.689617192000428*^9, 
   3.689617194944036*^9}, {3.690032458192461*^9, 3.69003245912251*^9}, {
   3.690032736833989*^9, 3.690032765059684*^9}, {3.6900328045291157`*^9, 
   3.690032805112669*^9}, 3.697550453517386*^9, 3.699369691076132*^9, {
   3.6993697221243687`*^9, 3.6993697470603857`*^9}, {3.700501859586426*^9, 
   3.700501967300016*^9}, {3.700502025980798*^9, 3.700502224304327*^9}, {
   3.7005022602408857`*^9, 3.70050228683232*^9}, {3.700502319175911*^9, 
   3.700502341745029*^9}, {3.700602833704762*^9, 3.700602917465008*^9}, {
   3.700602951297987*^9, 3.700603050155963*^9}, {3.700603081019923*^9, 
   3.700603088156008*^9}, {3.700611633739087*^9, 3.700611634281125*^9}, {
   3.700612062995213*^9, 3.70061211367706*^9}, {3.700612143806573*^9, 
   3.700612235898883*^9}, {3.700614823582773*^9, 3.70061487624503*^9}, {
   3.700614927811734*^9, 3.7006149886638193`*^9}, {3.700615352593755*^9, 
   3.7006153820141497`*^9}, {3.700615414779642*^9, 3.7006154302765837`*^9}, {
   3.700615541152515*^9, 3.700615567486679*^9}, 3.700615659347947*^9, {
   3.7006158793407383`*^9, 3.700615889292053*^9}, {3.700616203555393*^9, 
   3.700616336337757*^9}, {3.7006171841101913`*^9, 3.70061719663241*^9}, {
   3.700617284925542*^9, 3.700617295174239*^9}, {3.7006173380440483`*^9, 
   3.700617350758548*^9}, {3.7006173915107517`*^9, 3.700617524557908*^9}, 
   3.700617818695833*^9, {3.700617867035018*^9, 3.700617867709795*^9}, {
   3.700678805933538*^9, 3.700678885114352*^9}, {3.700703236923483*^9, 
   3.700703262786652*^9}, {3.700703294289529*^9, 3.700703357344142*^9}, {
   3.700703390428684*^9, 3.700703454725058*^9}, {3.70070349623137*^9, 
   3.700703496801648*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"get1DimDistribution", "[", 
     RowBox[{
     "genotypes_", ",", "genotypeabundances_", ",", "\[CapitalDelta]c1_", ",",
       "\[CapitalDelta]c2_", ",", "meanfitness_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"declaring", " ", "local", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fit1dwave", ",", "classes1d", ",", "sentval"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"initializing", " ", "local", " ", "variables"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"classes1d", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"SetPrecision", "[", 
             RowBox[{
              RowBox[{"1", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}], "-", 
               "meanfitness"}], ",", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"Min", "[", 
                   RowBox[{"\[CapitalDelta]c1", ",", "\[CapitalDelta]c2"}], 
                   "]"}], "]"}], "]"}], "]"}], "+", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fit1dwave", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "classes1d", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"sentval", "=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{"True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Or", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"genotypes", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], 
                    "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"genotypes", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}], 
                    "-", "meanfitness"}], ")"}], "\[Equal]", " ", 
                  RowBox[{"classes1d", "[", 
                   RowBox[{"[", "sentval", "]"}], "]"}]}], ",", 
                 RowBox[{"sentval", "\[GreaterEqual]", " ", 
                  RowBox[{"Length", "[", "classes1d", "]"}]}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"fit1dwave", "[", 
                  RowBox[{"[", "sentval", "]"}], "]"}], "+=", 
                 RowBox[{"genotypeabundances", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ";", 
                RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"sentval", "+=", "1"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fit1dwave", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"{", 
           RowBox[{"classes1d", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"Total", "[", "fit1dwave", "]"}]}], ")"}], 
             "fit1dwave"}]}], "}"}], ")"}], "\[Transpose]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fit1dwave", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"fit1dwave", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<", 
            RowBox[{"#2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "fit1dwave"}]}], "\[IndentingNewLine]", "]"}]}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"addZeros", "[", 
     RowBox[{"i_", ",", "numlength_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numwithzeros", "=", 
        RowBox[{"ToString", "[", "i", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"numlength", "-", 
           RowBox[{"StringLength", "[", "numwithzeros", "]"}]}], ">", "0"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"numwithzeros", "=", 
           RowBox[{"\"\<0\>\"", "<>", "numwithzeros"}]}], ";"}]}], "]"}], ";",
        "\[IndentingNewLine]", "numwithzeros"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getTraitWindowSize", "[", "results_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"windowsize1", "=", "1"}], ",", 
        RowBox[{"windowsize2", "=", "1"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"windowsize1", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"windowsize1", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"results", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "-", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"results", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "+", "1"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"windowsize2", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"windowsize1", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"results", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "-", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"results", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "+", "1"}]}], 
            "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "results", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"windowsize1", ",", "windowsize2"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getSingleTraitDistributions", "[", 
     RowBox[{"genotypes_", ",", "genotypeabundances_", ",", "windowsize_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "singletraitdistribution", ",", "minfit1", ",", "minfit2", ",", " ", 
        "maxfit1", ",", "maxfit2"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"minfit1", ",", "minfit2", ",", "maxfit1", ",", "maxfit2"}], 
         "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"genotypes", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"Min", "[", 
           RowBox[{"genotypes", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"genotypes", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"genotypes", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"singletraitdistribution", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "minfit1", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"maxfit1", ",", 
                RowBox[{"minfit1", "+", 
                 RowBox[{"windowsize", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], "}"}]}], "]"}],
           ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "minfit2", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"maxfit2", ",", 
                RowBox[{"minfit2", "+", 
                 RowBox[{"windowsize", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "}"}]}], 
           "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"singletraitdistribution", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "minfit1", "+", 
               "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+=", 
           RowBox[{"genotypeabundances", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"singletraitdistribution", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", "minfit2", "+", 
               "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+=", 
           RowBox[{"genotypeabundances", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "genotypeabundances", "]"}]}], "}"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "singletraitdistribution"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.700679629760871*^9, {3.7006823946527767`*^9, 3.700682539972343*^9}, {
   3.700683057848825*^9, 3.700683066448998*^9}, {3.7006838523667316`*^9, 
   3.7006840000147943`*^9}, {3.7006840634569893`*^9, 3.700684091278385*^9}, {
   3.7017125985761213`*^9, 3.701712630312091*^9}, {3.701712673352778*^9, 
   3.7017126776406317`*^9}, {3.7017128847472687`*^9, 3.701713155887712*^9}, {
   3.70171336061733*^9, 3.70171350489924*^9}, {3.7017135853254423`*^9, 
   3.701713781727128*^9}, 3.701713885736389*^9, 3.7017140758278427`*^9, {
   3.701714561207512*^9, 3.7017146022797403`*^9}, {3.701714689418047*^9, 
   3.701714692353548*^9}, {3.7017148058799973`*^9, 3.70171486212298*^9}, {
   3.701715221052683*^9, 3.7017152934182463`*^9}, {3.7017153691134243`*^9, 
   3.7017153944801826`*^9}, {3.701715864908964*^9, 3.7017159443746147`*^9}, {
   3.701715974502081*^9, 3.701716038622835*^9}, {3.701717342084972*^9, 
   3.701717400949686*^9}, {3.701717436245945*^9, 3.701717448069952*^9}, {
   3.701717480895823*^9, 3.701717841058988*^9}, {3.701717874068272*^9, 
   3.701718046738535*^9}, {3.701718099806822*^9, 3.701718111101811*^9}, {
   3.701718173913145*^9, 3.7017181767427893`*^9}, 3.701718492107485*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SolveDiffEqs", "[", 
    RowBox[{
    "popsize_", ",", "\[CapitalDelta]c1_", ",", "\[CapitalDelta]c2_", ",", 
     "genotypeabundances_", ",", "genotypes_", ",", "timestep_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIABLES"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "C", ",", "diffeqarray", ",", "X", ",", "system", ",", "sol", ",", 
       "numgenotypes", ",", "rbar"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"INITIALIZE", " ", "LOCAL", " ", "VARIABLES"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"C", "=", 
       RowBox[{"genotypeabundances", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numgenotypes", "=", 
       RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"SOLVE", " ", "DETERMINISTIC", " ", "EQUATIONS"}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"numgenotypes", "\[Equal]", "1"}], "\[IndentingNewLine]", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"IF", " ", "ONLY", " ", "ONE", " ", "GENOTYPE"}], ",", " ", 
          
          RowBox[{"THEN", " ", "USE", " ", "EXACT", " ", "SOLUTION"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"system", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              SuperscriptBox["n1", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"n1", "[", "t", "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
                
                RowBox[{
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}]}], 
               ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"n1", "[", "t", "]"}], "/", "popsize"}]}], ")"}]}]}],
             ",", 
            RowBox[{
             RowBox[{"n1", "[", "0", "]"}], "\[Equal]", "C"}]}], "}"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"sol", "=", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"n1", "[", "t", "]"}], "\[Rule]", 
             RowBox[{"popsize", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"popsize", "/", "C"}], "-", "1"}], ")"}], 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"genotypes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], 
                    "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"genotypes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}]}], 
                    ")"}]}], "t"}], "]"}]}], "+", "1"}], ")"}]}]}], "}"}], 
           "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
         "ELSE", " ", "MORE", " ", "THAN", " ", "ONE", " ", "GENOTYPE", " ", 
          "SO", " ", "FORM", " ", "DERIVATIVE", " ", "AND", " ", "HAVE", " ", 
          "MATHEMATICA", " ", "SOLVE", " ", "THE", " ", "SYSTEM"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"X", "[", "t_", "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<n\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<[t]\>\""}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", "numgenotypes", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rbar", "[", "t_", "]"}], "=", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
                
                RowBox[{
                 RowBox[{
                  RowBox[{"genotypes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}]}], 
               ")"}], 
              RowBox[{
               RowBox[{"X", "[", "t", "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}], "/", 
           "popsize"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"diffeqarray", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"X", "[", "t", "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"genotypes", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}], "-", 
               RowBox[{"rbar", "[", "t", "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"system", " ", "=", " ", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "\[Equal]", "#2"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"X", "[", "t", "]"}], ",", "t"}], "]"}], ",", 
                "diffeqarray"}], "}"}]}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{"see", " ", 
              RowBox[{"tutorial", "/", "DSolveSystemsOfLinearODEs"}]}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "\[Equal]", "#2"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"X", "[", "t", "]"}], "/.", 
                 RowBox[{"t", "\[Rule]", "0"}]}], ",", "genotypeabundances"}],
                "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sol", "=", 
          RowBox[{"NDSolve", "[", 
           RowBox[{"system", ",", " ", 
            RowBox[{"X", "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "timestep"}], "}"}]}], "]"}]}], 
         ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"RETURN", ":", " ", 
        RowBox[{"SYSTEM", " ", "AND", " ", "SOLUTION"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"system", ",", "sol"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQLbC//URf1WtHDosVl0D093l8r0H0ledWYLqAe9tP
EC107wmYltjqztAPpKcXsnOB6CW1X/hA9ImZLQIg+ty5XFEQ3dJ7Qx1EX7qw
VgdEb0k+DqYlMtk9QXR09l0vEC2gvCcURPu+jA0H0euX1USD6J8T38eDaI6d
8d0g+ouW7UQQ/YipYgaYv+nfYhAt08e7BUSbRS3aBaLVnOrjJwDpvLwXCSDa
6/wiYfHq144K721EQTQPW7Y0iNb4MxlM625asRpEz56vugZEB6gs3wKiky/+
BNPrlkustwfSPg89wfSjX3ufgOh8pikvQTQAdfSk+w==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PruneUnfitClasses", "[", 
    RowBox[{"genotypes_", ",", "genotypeabundances_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIABLES"}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "newgenotypes", ",", "newgenotypeabundances", ",", 
       "genotypeskeptindx"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"INITIALIZE", " ", "LOCAL", " ", "VARIABLES"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"genotypeskeptindx", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newgenotypes", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newgenotypeabundances", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "PRUNE", " ", "FITNESS", " ", "CLASSES", " ", "WITH", " ", 
         "ABUNDANCES"}], " ", "<", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i", ">", "0"}], "\[IndentingNewLine]", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
         "RUN", " ", "THROUGH", " ", "GENOTYPE", " ", "LIST", " ", "AND", " ",
           "CHECK", " ", "ABUNDANCES"}], " ", "*)"}], " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"genotypeabundances", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<", "1"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"IF", " ", "genotypeabundance"}], " ", "<", " ", "1"}], 
             ",", " ", 
             RowBox[{
             "GENOTYPE", " ", "WILL", " ", "NOT", " ", "BE", " ", "SAVED", 
              " ", "INTO", " ", "NEW", " ", "LIST"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}], "\[Equal]", "0"}], ",", 
                RowBox[{"newgenotypes", "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"(", "verbose", ")"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{
               "Print", "[", "\"\<WARNING: population extinction!\>\"", "]"}],
                ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"i", "=", 
             RowBox[{"i", "-", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"ELSE", " ", "genotypeabundance"}], " ", ">", " ", 
              "1"}], ",", " ", 
             RowBox[{
             "SO", " ", "SAVE", " ", "TO", " ", "NEW", " ", "LIST"}]}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newgenotypeabundances", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"genotypeabundances", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
               "newgenotypeabundances"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"genotypeskeptindx", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "i", "}"}], ",", "genotypeskeptindx"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"newgenotypes", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"genotypes", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", "newgenotypes"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"i", "=", 
             RowBox[{"i", "-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", 
       RowBox[{"END", "-", "WHILE", "-", "LOOP"}], "*)"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "REPORT", " ", "THE", " ", "NUMBER", " ", "OF", " ", "GENOTYPES", " ", 
        "THAT", " ", "WERE", " ", "DROPPED"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", "veryverbose", ")"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Dropped \>\"", ",", 
           RowBox[{
            RowBox[{"getNumGenotypes", "[", "genotypes", "]"}], "-", 
            RowBox[{"getNumGenotypes", "[", "newgenotypes", "]"}]}], ",", 
           "\"\< unfit genotype class(es) from \>\"", ",", 
           RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], "]"}], 
         ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"RETURN", ":", " ", 
         RowBox[{
         "NEW", " ", "GENOTYPE", " ", "LIST", " ", "AND", " ", "RESPECTIVE", 
          " ", "ABUNDANCES"}]}], ",", " ", 
        RowBox[{
        "AS", " ", "WELL", " ", "AS", " ", "INDICES", " ", "OF", " ", "THOSE",
          " ", "THAT", " ", "WERE", " ", "KEPT", " ", "TO", " ", "REFERENCE", 
         " ", "THEM", " ", "IN", " ", "COMPUTED", " ", "SOLUTIONS"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "newgenotypes", ",", "newgenotypeabundances", ",", 
        "genotypeskeptindx"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getNextMutants", "[", 
    RowBox[{
    "genotypes_", ",", "genotypeabundances_", ",", "\[CapitalDelta]c1_", ",", 
     "\[CapitalDelta]c2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIABLES"}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "trait1min", ",", " ", "trait1max", ",", "trait2min", ",", "trait2max", 
       ",", "newmutantgenotypes", ",", "trait1mean", ",", "trait2mean", ",", 
       "templist1", ",", " ", "templist2", ",", "templist3", ",", "mutdimadd",
        ",", "numbgenotypes"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"time1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"INITIALIZE", " ", "LOCAL", " ", "VARIABLES"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"trait1min", ",", "trait1max"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"getMinTraitValue", "[", 
          RowBox[{"genotypes", ",", "1"}], "]"}], ",", 
         RowBox[{"getMaxTraitValue", "[", 
          RowBox[{"genotypes", ",", "1"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"trait2min", ",", "trait2max"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"getMinTraitValue", "[", 
          RowBox[{"genotypes", ",", "2"}], "]"}], ",", 
         RowBox[{"getMaxTraitValue", "[", 
          RowBox[{"genotypes", ",", "2"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numbgenotypes", "=", 
       RowBox[{"Length", "[", "genotypes", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newmutantgenotypes", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"trait1mean", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"Total", "[", "genotypeabundances", "]"}]}], ")"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"genotypes", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], 
           RowBox[{"genotypeabundances", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"trait2mean", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"Total", "[", "genotypeabundances", "]"}]}], ")"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"genotypes", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], 
           RowBox[{"genotypeabundances", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "genotypes", "]"}]}], "}"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "CONSTRUCT", " ", "EMPTY", " ", "ARRAY", " ", "TO", " ", "STORE", " ", 
        "LIST", " ", "OF", " ", "NEW", " ", "MUTANTS", " ", "AND", " ", 
        "INFO"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"genotypes", "[", 
            RowBox[{"[", 
             RowBox[{"Mod", "[", 
              RowBox[{"i", ",", "numbgenotypes", ",", "1"}], "]"}], "]"}], 
            "]"}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Round", "[", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{"i", "-", "1"}], 
                RowBox[{"2", "numbgenotypes"}]]}], "]"}], ",", 
             RowBox[{"Round", "[", 
              FractionBox["i", 
               RowBox[{"2", "numbgenotypes"}]], "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"2", " ", "numbgenotypes"}]}], "}"}]}], "]"}], " "}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mutdimadd", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Round", "[", 
            RowBox[{"1", "-", 
             FractionBox[
              RowBox[{"i", "-", "1"}], 
              RowBox[{"2", "numbgenotypes"}]]}], "]"}], ",", 
           RowBox[{"Round", "[", 
            FractionBox["i", 
             RowBox[{"2", "numbgenotypes"}]], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"2", " ", "numbgenotypes"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"templist1", "=", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"genotypes", ",", "genotypes"}], "]"}], "+", "mutdimadd"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"templist2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"templist1", "-", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"trait1mean", ",", "trait2mean"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"2", "numbgenotypes"}]}], "}"}]}], "]"}]}], ")"}], ".", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "\[CapitalDelta]c1", "}"}], ",", 
          RowBox[{"{", "\[CapitalDelta]c2", "}"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"templist3", "=", "templist1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"templist1", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"templist1", ",", "genotypes"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"templist2", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{"templist1", ",", 
                RowBox[{
                 RowBox[{"#1", "\[Equal]", 
                  RowBox[{"templist3", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "&"}]}], "]"}], 
              "\[NotEqual]", " ", 
              RowBox[{"{", "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"newmutantgenotypes", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"newmutantgenotypes", ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"i", ",", "numbgenotypes", ",", "1"}], "]"}], ",", 
                 RowBox[{"1", "+", 
                  RowBox[{"Round", "[", 
                   FractionBox["i", 
                    RowBox[{"2", "numbgenotypes"}]], "]"}]}], ",", 
                 RowBox[{"templist3", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "}"}]}], "]"}]}]}],
           "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"2", " ", "numbgenotypes"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newmutantgenotypes", "=", 
       RowBox[{"groupNewMutantsList", "[", "newmutantgenotypes", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"time1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"AbsoluteTime", "[", "]"}], "-", 
        RowBox[{"time1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"RETURN", " ", "NEW", " ", "MUTANT", " ", "INFORMATION"}], 
         " ", "-", " ", 
         RowBox[{"LIST", " ", "OF", " ", "FORM", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"z1_i", ",", " ", "z2_i"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"y1_ij", ",", " ", "y2_ij"}], "}"}], "}"}], ",", " ", 
             "w1_i", ",", " ", "w2_i"}], "}"}], "}"}], " ", "FOR", " ", 
          "i"}]}], " ", "=", " ", 
        RowBox[{
        "ALL", " ", "MUTANT", " ", "FITNESS", " ", "CLASSES", " ", "POSSIBLE",
          " ", "ON", " ", "BOUNDARY"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"z1", " ", "=", " ", "\"\<abs_fit of mutant\>\""}], ",", " ", 
        
        RowBox[{"z2", " ", "=", " ", "\"\<rel_fit of mutant\>\""}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "y1", " ", "=", " ", 
         "\"\<index of genotype that generated mutant\>\""}], ",", " ", 
        RowBox[{
        "y2", " ", "=", " ", 
         "\"\<indicator of whether generated on \
trait1_dimension=1/trait2_dimension=2\>\""}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "w1", " ", "=", " ", "\"\<mutation time, set initially to zero\>\""}],
         ",", " ", 
        RowBox[{
        "w2", " ", "=", " ", 
         "\"\<no. of replications, set initially to zero\>\""}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "newmutantgenotypes"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.688388637496106*^9, 3.6883886500477448`*^9}, {
   3.688407091607911*^9, 3.688407193174913*^9}, {3.6884073473918123`*^9, 
   3.688407447207672*^9}, {3.6884074816635313`*^9, 3.688407494311516*^9}, {
   3.6884075388555307`*^9, 3.688407541439126*^9}, {3.688407607703397*^9, 
   3.688407609990333*^9}, {3.6884077816472397`*^9, 3.688407791110772*^9}, {
   3.6884080307106543`*^9, 3.688408077759555*^9}, {3.688409070199697*^9, 
   3.68840933727011*^9}, {3.688409367893943*^9, 3.688409398461399*^9}, {
   3.688409610358603*^9, 3.688409618134457*^9}, {3.688409689262982*^9, 
   3.688409700045207*^9}, {3.6884103818288794`*^9, 3.688410387220907*^9}, {
   3.6884106263880167`*^9, 3.688410651491928*^9}, {3.688411324085638*^9, 
   3.688411328284094*^9}, 3.68841249683856*^9, {3.6884126066116257`*^9, 
   3.688412672393848*^9}, {3.6884136637598543`*^9, 3.688413668696025*^9}, {
   3.688416506087736*^9, 3.688416525239599*^9}, {3.699310957794427*^9, 
   3.699311014098439*^9}, {3.699311072747064*^9, 3.699311115899822*^9}, {
   3.699366803206854*^9, 3.699366976599895*^9}, {3.6993670499919653`*^9, 
   3.6993670546720877`*^9}, {3.699367094640757*^9, 3.699367103176506*^9}, {
   3.699368475110579*^9, 3.699368497614932*^9}, {3.6993708162192698`*^9, 
   3.6993708234105387`*^9}, {3.699371027083659*^9, 3.699371041235577*^9}, {
   3.6993716230221663`*^9, 3.699371711902821*^9}, {3.699389792062358*^9, 
   3.699389855438548*^9}, {3.700504255618018*^9, 3.700504256077507*^9}, {
   3.700506007068624*^9, 3.700506103559141*^9}, {3.700506233463879*^9, 
   3.700506385408228*^9}, {3.700506419191566*^9, 3.7005065275504303`*^9}, {
   3.700506571342106*^9, 3.700506666190885*^9}, {3.700506742700639*^9, 
   3.700507026474011*^9}, {3.70050707408105*^9, 3.7005070836729*^9}, {
   3.700507142047785*^9, 3.700507315568016*^9}, {3.700507349350328*^9, 
   3.700507407847598*^9}, {3.700507479776453*^9, 3.700507528729987*^9}, {
   3.700507573458066*^9, 3.70050761453687*^9}, 3.7005076649783688`*^9, {
   3.700507820307783*^9, 3.700507981821657*^9}, {3.7005080210943613`*^9, 
   3.700508028334499*^9}, {3.7005082367449207`*^9, 3.700508393524117*^9}, {
   3.700508444122588*^9, 3.700508516219596*^9}, {3.700509505402647*^9, 
   3.700509581794654*^9}, {3.700509629978692*^9, 3.7005096636509647`*^9}, {
   3.700509744155457*^9, 3.700509946421694*^9}, {3.700517787339405*^9, 
   3.700517908412251*^9}, 3.700576115458956*^9, {3.700576415795308*^9, 
   3.700576545043954*^9}, {3.700576640962998*^9, 3.7005766821562366`*^9}, {
   3.7005767377313004`*^9, 3.700576741443057*^9}, {3.700576856419354*^9, 
   3.70057687647549*^9}, {3.70057690905166*^9, 3.700577027348751*^9}, {
   3.7005771440040693`*^9, 3.700577255976516*^9}, {3.700577299280147*^9, 
   3.700577301615007*^9}, {3.700577333422594*^9, 3.7005773579818583`*^9}, {
   3.700577458965035*^9, 3.70057746629326*^9}, {3.7005775913329782`*^9, 
   3.700577654828785*^9}, {3.700577742540823*^9, 3.7005777950367193`*^9}, {
   3.700577980054584*^9, 3.700577980869594*^9}, {3.7005783419221077`*^9, 
   3.700578368616601*^9}, {3.7005785010694523`*^9, 3.700578559571657*^9}, {
   3.7005785956058617`*^9, 3.700578619012333*^9}, {3.700578755791057*^9, 
   3.700578813559651*^9}, {3.700578949440233*^9, 3.700579133291481*^9}, {
   3.700579176500228*^9, 3.700579251005859*^9}, {3.700579292670587*^9, 
   3.700579359583777*^9}, {3.700579445138137*^9, 3.700579538649802*^9}, {
   3.70057994209274*^9, 3.700579955868463*^9}, {3.70058005602857*^9, 
   3.700580081916944*^9}, {3.700581224447324*^9, 3.700581226047904*^9}, {
   3.7005812960393753`*^9, 3.700581319263014*^9}, {3.7005813627197857`*^9, 
   3.700581372143684*^9}, {3.700581413879652*^9, 3.700581441008206*^9}, {
   3.700583127269121*^9, 3.700583197013513*^9}, {3.700583333304392*^9, 
   3.700583334297092*^9}, {3.700583407601469*^9, 3.700583542485918*^9}, 
   3.7005835786682777`*^9, {3.700584084731254*^9, 3.700584246892518*^9}, {
   3.700584305157583*^9, 3.7005843363251266`*^9}, {3.700584511335269*^9, 
   3.700584555655859*^9}, {3.7005846880808973`*^9, 3.700584688472209*^9}, {
   3.700584851090166*^9, 3.700584855697742*^9}, {3.700586289925232*^9, 
   3.700586358078059*^9}, 3.700586624564028*^9, {3.7005866716442137`*^9, 
   3.7005866721962843`*^9}, {3.7005867714160223`*^9, 3.700586780278533*^9}, {
   3.700587014065118*^9, 3.700587075952826*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NextMutation", "[", 
    RowBox[{
    "popsize_", ",", "\[CapitalDelta]c1_", ",", "\[CapitalDelta]c2_", ",", 
     "U1_", ",", "U2_", ",", "sol_", ",", "genotypes_", ",", 
     "genotypeabundances_", ",", "starttime_", ",", "timestep_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIABLES"}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "U", ",", "F", ",", "numgenotypes", ",", "newbirths", ",", "newmutants",
        ",", "nummutants", ",", "nextmutationtime", ",", "mutantindx", ",", 
       "rbar", ",", "newmutantfixation", ",", "newmutantpfix", ",", 
       "parentfitclassindices", ",", "m"}], "}"}], ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"INITIALIZE", " ", "LOCAL", " ", "VARIABLES"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numgenotypes", "=", 
       RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newmutants", "=", 
       RowBox[{"getNextMutants", "[", 
        RowBox[{
        "genotypes", ",", "genotypeabundances", ",", "\[CapitalDelta]c1", ",",
          "\[CapitalDelta]c2"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "get", " ", "set", " ", "of", " ", "mutants", " ", "on", " ", "the", 
        " ", "boundary"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"nummutants", "=", 
       RowBox[{"getNumGenotypes", "[", "newmutants", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nextmutationtime", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"U", "=", 
       RowBox[{"{", 
        RowBox[{"U1", ",", "U2"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"F", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nummutants"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newmutantfixation", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"newmutantpfix", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time2", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "FORM", " ", "ALGEBRAIC", " ", "EXPRESSIONS", " ", "FOR", " ", 
        "SOLUTION", " ", "VECTOR", " ", 
        RowBox[{"X", "[", "t", "]"}], "AND", " ", "MEAN", " ", "FITNESS", " ", 
        RowBox[{"rbar", "[", "t", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "[", "t_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<n\>\"", "<>", 
           RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<[t]\>\""}], "]"}], 
         "&"}], "/@", 
        RowBox[{"Range", "[", "numgenotypes", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rbar", "[", "t_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
             RowBox[{
              RowBox[{
               RowBox[{"genotypes", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}]}], ")"}], 
           RowBox[{
            RowBox[{"X", "[", "t", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}], "/", 
        "popsize"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "COMPUTE", " ", "MUTATION", " ", "TIME", " ", "AND", " ", 
         "REPLICATIONS", " ", "FOR", " ", "EACH", " ", "MUTANT", " ", "CLASS",
          " ", "ON", " ", "BOUNDARY"}], " ", "-", " ", 
        RowBox[{
        "FILL", " ", "QUEUE", " ", "TO", " ", "BE", " ", "EXAMINED"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"newmutants", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], "+=", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"ExponentialDistribution", "[", "1", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newbirths", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"X", "[", "t", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"genotypes", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], 
                    "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"genotypes", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}], 
                    "-", 
                    RowBox[{"rbar", "[", "t", "]"}]}], ")"}]}], " ", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                  ")"}], "/.", 
                 RowBox[{"sol", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/.", 
               RowBox[{"t", "\[Rule]", "#"}]}], ")"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ">", "0"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"NDSolveValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"y", "'"}], "[", "t", "]"}], "\[Equal]", 
               RowBox[{"newbirths", "[", "t", "]"}]}], ",", 
              RowBox[{
               RowBox[{"y", "[", "starttime", "]"}], "\[Equal]", "0"}]}], 
             "}"}], ",", "y", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "starttime", ",", "timestep"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Sometimes", " ", "when", " ", "pop", " ", "is", " ", 
            "declining"}], ",", " ", 
           RowBox[{
            RowBox[{"no", " ", 
             RowBox[{"F", "[", "t", "]"}], " ", "will", " ", "ever", " ", 
             "be", " ", "high", " ", "enough"}], ";", " ", 
            RowBox[{"check", " ", "for", " ", "this"}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"F", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", "timestep", "]"}], "<", 
            RowBox[{
             RowBox[{"newmutants", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "IF", " ", "MUTATION", " ", "TIME", " ", "OCCURED", " ", "AFTER", 
             " ", "timeuntilnextenvchange"}], " ", "*)"}], " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"newmutants", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"timestep", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "ELSE", " ", "MUTATION", " ", "TIME", " ", "OCCURS", " ", 
              "PRIOR", " ", "TO", " ", "timeuntilnextenvchange"}], ",", " ", 
             RowBox[{
             "SO", " ", "SOLVE", " ", "FOR", " ", "MUTATION", " ", "TIME"}]}],
             " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"newmutants", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "=", 
             RowBox[{"(", 
              RowBox[{"tm", "/.", 
               RowBox[{"FindRoot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"F", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "tm", "]"}], 
                  "\[Equal]", 
                  RowBox[{
                   RowBox[{"newmutants", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], " ", ",", 
                 RowBox[{"{", 
                  RowBox[{"tm", ",", "starttime", ",", "timestep"}], "}"}], 
                 ",", 
                 RowBox[{"Method", "->", "\"\<Brent\>\""}]}], "]"}]}], 
              ")"}]}], ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nummutants"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"LOOP", " ", "THROUGH", " ", "MUTANT", " ", "LIST"}], ",", 
        " ", 
        RowBox[{
        "FIND", " ", "MINUMUM", " ", "MUTATION", " ", "TIME", " ", "AND", " ",
          "CHECK", " ", "FOR", " ", 
         RowBox[{"ESTABLISHMENT", ".", " ", "IF"}], " ", "DOES", " ", "NOT", 
         " ", "ESTABLISH", " ", "UPDATE", " ", "MUTATION", " ", "TIME", " ", 
         "TO", " ", "SECOND", " ", "MUTATION", " ", "OCCURRENCE"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "CONTINUE", " ", "CHECKING", " ", "FOR", " ", "ESTABLISHEMENT", " ", 
        "BY", " ", "ORDER", " ", "OF", " ", "MUTATION", " ", 
        RowBox[{"TIME", "/", " ", "OR"}], " ", "TAKE", " ", 
        "\"\<timeuntilnextenvchange+1\>\"", " ", "IF", " ", "NO", " ", 
        "MUTATION", " ", "TIMES", " ", "OCCUR", " ", "BEFORE", " ", 
        "\"\<timeuntilnextenvchange\>\""}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"!", "newmutantfixation"}], " ", "&&", " ", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"nextmutationtime", " ", ">", " ", "timestep"}], ")"}]}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"STEP", " ", "1"}], ":", " ", 
          RowBox[{
          "FIND", " ", "THE", " ", "NEXT", " ", "MINIMUM", " ", "MUTATION", 
           " ", "TIME", " ", "AND", " ", "CHECK", " ", "THAT", " ", "ITS", 
           " ", "SMALLER", " ", "THAN", " ", 
           RowBox[{"timeuntilnextenvchange", ".", " ", "IF"}], " ", "NOT", 
           " ", "EXIT", " ", "LOOP", " ", "WITH", " ", "NO", " ", 
           "ESTABLISHMENT", " ", "EVENT", " ", "AND", " ", "PROCEED", " ", 
           "WITH", " ", "EXITING", " ", "MODULE"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mutantindx", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"newmutants", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{"newmutants", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "get", " ", "index", " ", "of", " ", "mutant", " ", "class", " ", 
           "with", " ", "lowest", " ", "mutation", " ", "time"}], " ", "*)"}],
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"STEP", " ", "2"}], ":", " ", 
            RowBox[{
            "FOR", " ", "MINIMUM", " ", "MUTATION", " ", "TIME", " ", 
             "FOUND"}]}], ",", " ", 
           RowBox[{"CHECK", " ", "IF", " ", "IT", " ", 
            RowBox[{"ESTABLISHES", ".", " ", "IF"}], " ", "SO", " ", "EXIT", 
            " ", "LOOP", " ", "WITH", " ", "ESTABLISHEMENT", " ", "INFO"}], 
           ",", " ", 
           RowBox[{
           "OTHERWISE", " ", "UPDATE", " ", "MUTATION", " ", "TIME", " ", 
            "FOR", " ", "MUTANT", " ", "CHECKED", " ", "AND", " ", "LOOP", 
            " ", "AGAIN"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"newmutants", "[", 
             RowBox[{"[", 
              RowBox[{"mutantindx", ",", "3"}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"(", 
             RowBox[{"timestep", "+", "1"}], ")"}]}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "IF", " ", "NEXT", " ", "MUTATION", " ", "EVENT", " ", "DOES", 
             " ", "NOT", " ", "OCCUR", " ", "BEFORE", " ", 
             "timeuntilnextenvchange"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nextmutationtime", "=", 
             RowBox[{"newmutants", "[", 
              RowBox[{"[", 
               RowBox[{"mutantindx", ",", "3"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"parentfitclassindices", "=", 
             RowBox[{"{", "}"}]}], ";", "  ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "This", " ", "is", " ", "needed", " ", "in", " ", "the", " ", 
               "main", " ", "module", " ", "to", " ", "track", " ", "growth", 
               " ", "of", " ", "the", " ", "mutant", " ", "fitness", " ", 
               "class"}], ",", " ", 
              RowBox[{
              "should", " ", "be", " ", "empty", " ", "if", " ", "not", " ", 
               "new", " ", "mutant", " ", "establishes"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"newmutants", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", "veryverbose", ")"}], ",", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Next mutation not estimated before \>\"", ",", 
                 "timestep", ",", "\"\<, starting at \>\"", ",", 
                 "starttime"}], "]"}], ";"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "ELSE", " ", "A", " ", "MUTATION", " ", "DID", " ", "OCCUR", " ", 
             "BEFORE", " ", "timeuntilnextenvchange", " ", "SO", " ", "CHECK",
              " ", "IF", " ", "IT", " ", "FIXES", " ", "AND", " ", "PROCEED", 
             " ", "ACCORDINGLY"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nextmutationtime", "=", 
             RowBox[{"newmutants", "[", 
              RowBox[{"[", 
               RowBox[{"mutantindx", ",", "3"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"newmutantpfix", "=", 
             RowBox[{"CalcPfix", "[", 
              RowBox[{
              "popsize", ",", "\[CapitalDelta]c1", ",", "\[CapitalDelta]c2", 
               ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"rbar", "[", "t", "]"}], ")"}], "/.", 
                   RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], " ", "/.", 
                 RowBox[{"t", "\[Rule]", "nextmutationtime"}]}], ")"}], ",", 
               RowBox[{
                RowBox[{"newmutants", "[", 
                 RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"newmutantfixation", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"RandomReal", "[", "]"}], "<", "newmutantpfix"}], 
              ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"!", "newmutantfixation"}], ")"}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
              RowBox[{"(*", " ", 
               RowBox[{
               "IF", " ", "NEW", " ", "MUTANT", " ", "DID", " ", "NOT", " ", 
                "FIX", " ", "UPDATE", " ", "ITS", " ", "MUTATION", " ", 
                "TIME"}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"newmutants", "[", 
                  RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "+=", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"ExponentialDistribution", "[", "1", "]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"F", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", "timestep", 
                   "]"}], "<", 
                  RowBox[{
                   RowBox[{"newmutants", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", 
                 ",", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "IF", " ", "NEXT", " ", "MUTATION", " ", "TIME", " ", 
                   "OCCURED", " ", "AFTER", " ", "timeuntilnextenvchange"}], 
                  " ", "*)"}], " ", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
                   RowBox[{"timestep", "+", "1"}]}], ";"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                   "ELSE", " ", "NEXT", " ", "MUTATION", " ", "TIME", " ", 
                    "OCCURS", " ", "PRIOR", " ", "TO", " ", 
                    "timeuntilnextenvchange"}], ",", " ", 
                   RowBox[{
                   "SO", " ", "SOLVE", " ", "FOR", " ", "MUTATION", " ", 
                    "TIME"}]}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "=", 
                   RowBox[{"(", 
                    RowBox[{"tm", "/.", 
                    RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"F", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", "tm", "]"}],
                     "\[Equal]", 
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], " ", ",", 
                    RowBox[{"{", 
                    RowBox[{"tm", ",", 
                    RowBox[{
                    RowBox[{"newmutants", "[", 
                    RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "timestep"}], "}"}], 
                    ",", 
                    RowBox[{"Method", "->", "\"\<Brent\>\""}]}], "]"}]}], 
                    ")"}]}], ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
              "\[IndentingNewLine]", ",", " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"ELSE", " ", "NEW", " ", "MUTANT", " ", "FIXED"}], 
                ",", " ", 
                RowBox[{
                "SO", " ", "EXIT", " ", "LOOP", " ", "AND", " ", "RETURN", 
                 " ", "NEW", " ", "MUTANT", " ", "DATA"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"parentfitclassindices", "=", 
                RowBox[{
                 RowBox[{"newmutants", "[", 
                  RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"newmutants", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"newmutants", "[", 
                   RowBox[{"[", "mutantindx", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}]}], ";", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"(", "veryverbose", ")"}], ",", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<establishment probability = \>\"", ",", 
                    "newmutantpfix", ",", 
                    "\"\<, new mutant established = \>\"", ",", " ", 
                    "newmutantfixation", ",", "\"\<, at time = \>\"", ",", 
                    RowBox[{"globaltime", "+", "nextmutationtime"}]}], "]"}], 
                  ";"}]}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"END", " ", "WHILE", " ", "LOOP"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"time2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"AbsoluteTime", "[", "]"}], "-", 
        RowBox[{"time2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "RETURN", " ", "EARLIEST", " ", "OCCURING", " ", "MUTANT", " ", 
        "FITNESS", " ", "CLASS", " ", "THAT", " ", 
        RowBox[{"FIXES", "/", "OR"}], " ", 
        RowBox[{"{", "}"}], " ", "IF", " ", "IT", " ", "DOES", " ", "NOT", 
        " ", "EXISTS"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "The", " ", "returned", " ", "type", " ", "is", " ", "a", " ", 
        "single", " ", "list", " ", "of", " ", "type", " ", 
        RowBox[{"{", 
         RowBox[{"t1", ",", 
          RowBox[{"{", 
           RowBox[{"z1", ",", "z2"}], "}"}], ",", "f1", ",", "p1"}], "}"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "t1", " ", "=", " ", "\"\<time until next establishing mutation\>\""}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"z1", " ", "=", " ", "\"\<trait1 of mutant\>\""}], ",", " ", 
        RowBox[{"z2", " ", "=", " ", "\"\<trait2 of mutant\>\""}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "f1", " ", "=", " ", 
        "\"\<flag designating whether new mutant has established\>\""}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "p1", " ", "=", " ", 
        "\"\<fixation probability of new mutant class\>\""}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "nextmutationtime", ",", "newmutants", ",", "newmutantfixation", ",", 
        "newmutantpfix", ",", "parentfitclassindices"}], "}"}]}]}], " ", 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.67605872922714*^9, 3.676058785879277*^9}, {
   3.6760589728838377`*^9, 3.6760589775291224`*^9}, {3.676059046446055*^9, 
   3.676059088142056*^9}, {3.676059208336916*^9, 3.6760592634544363`*^9}, {
   3.6760593199371643`*^9, 3.6760593204670677`*^9}, {3.680263663362485*^9, 
   3.6802636698576508`*^9}, {3.68026373026501*^9, 3.68026373336432*^9}, {
   3.680263790405897*^9, 3.6802638464847517`*^9}, {3.688388774289509*^9, 
   3.6883887961130447`*^9}, 3.688388861616127*^9, {3.6883889567695217`*^9, 
   3.688388977068997*^9}, 3.688389074474472*^9, {3.6884141123182783`*^9, 
   3.688414123634696*^9}, {3.688414160233964*^9, 3.688414232762239*^9}, {
   3.688414376002849*^9, 3.6884145270576878`*^9}, {3.688414580443822*^9, 
   3.6884146131386414`*^9}, {3.688414681123252*^9, 3.6884147163384857`*^9}, {
   3.688414769978508*^9, 3.6884148546227007`*^9}, {3.6884150816828423`*^9, 
   3.688415111085552*^9}, {3.6884154290658092`*^9, 3.6884154326890697`*^9}, {
   3.6884154678897552`*^9, 3.6884154704196253`*^9}, {3.688415702705751*^9, 
   3.68841570925344*^9}, {3.688415758985351*^9, 3.688415818738036*^9}, {
   3.688416079776984*^9, 3.688416084274168*^9}, {3.688416167536558*^9, 
   3.6884161755912113`*^9}, {3.688416667304035*^9, 3.688416769281951*^9}, {
   3.688495426699238*^9, 3.688495520837965*^9}, {3.688495583114293*^9, 
   3.68849564794582*^9}, {3.688496248279244*^9, 3.6884962739112253`*^9}, {
   3.688496999099991*^9, 3.688497047142899*^9}, {3.688574671243636*^9, 
   3.688574707907712*^9}, {3.688574745400867*^9, 3.688574845922297*^9}, {
   3.688688032319854*^9, 3.688688038236038*^9}, {3.688688106368167*^9, 
   3.688688114129993*^9}, {3.688688176839487*^9, 3.688688183182222*^9}, {
   3.6886883017409554`*^9, 3.6886883268500767`*^9}, {3.688688477094051*^9, 
   3.6886884913428164`*^9}, {3.6886885256758003`*^9, 3.688688547714519*^9}, {
   3.6886885918554068`*^9, 3.68868861114928*^9}, {3.68868866534132*^9, 
   3.688688665826858*^9}, {3.68868870947077*^9, 3.6886887402960377`*^9}, {
   3.688689136996621*^9, 3.6886891741796103`*^9}, {3.688689231729515*^9, 
   3.688689232599723*^9}, {3.688689267455682*^9, 3.688689279116002*^9}, {
   3.688689311109185*^9, 3.688689318779788*^9}, {3.688689419289076*^9, 
   3.6886894204835653`*^9}, 3.6886895795391283`*^9, {3.688689632599852*^9, 
   3.688689680969531*^9}, {3.688689781529714*^9, 3.688689811691188*^9}, {
   3.688689842647768*^9, 3.688689917312696*^9}, {3.688690025279429*^9, 
   3.688690052889867*^9}, {3.688690169159748*^9, 3.688690217991741*^9}, {
   3.68869061831262*^9, 3.688690627572927*^9}, {3.688690807181691*^9, 
   3.6886908196930656`*^9}, {3.68869085034577*^9, 3.6886908608454723`*^9}, {
   3.688690901367303*^9, 3.688690963868598*^9}, {3.688691151616807*^9, 
   3.6886912969604807`*^9}, 3.688691433547421*^9, {3.6887052389707623`*^9, 
   3.688705249822854*^9}, {3.688705305073885*^9, 3.6887053155013943`*^9}, {
   3.6887056749476843`*^9, 3.6887057047805443`*^9}, 3.69003116968622*^9, {
   3.690031468098833*^9, 3.690031468786695*^9}, 3.699369764494238*^9, {
   3.699369833678035*^9, 3.6993698406138287`*^9}, {3.700586372080475*^9, 
   3.700586426009736*^9}, 3.7005864878105297`*^9, 3.7005866326780853`*^9, {
   3.7005866649979753`*^9, 3.700586665688901*^9}, {3.700586758017494*^9, 
   3.7005867639980307`*^9}, {3.700587085107285*^9, 3.700587122611858*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CalcPfix", "[", 
    RowBox[{
    "popsize_", ",", "\[CapitalDelta]c1_", ",", "\[CapitalDelta]c2_", ",", 
     "rbar_", ",", "newmutants_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIABLES"}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "RETURN", " ", "ANALYTICAL", " ", "FIXATION", " ", "PROBABILITY", " ", 
       "ASSUMING", " ", "N", " ", "CONSTANT", " ", 
       RowBox[{"(", 
        RowBox[{"demographic", " ", "equilibrium"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"newmutants", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
           RowBox[{
            RowBox[{"newmutants", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}]}], ")"}], 
         "-", "rbar"}], ">", "0"}], "\[IndentingNewLine]", ",", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "IF", " ", "PER", " ", "BIRTH", " ", "RATE", " ", "EXCEED", " ", 
          "DEATH", " ", "RATE"}], ",", " ", 
         RowBox[{
         "RETURN", " ", "ANALYTIC", " ", "FIXATION", " ", "PROBABILITY"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"newmutants", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
          RowBox[{
           RowBox[{"newmutants", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}], "-", 
          "rbar"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{
           RowBox[{"newmutants", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[CapitalDelta]c1"}], "+", 
          RowBox[{
           RowBox[{"newmutants", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[CapitalDelta]c2"}], "-", 
          "rbar"}], ")"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"IF", " ", "DEATH", " ", "RATE", " ", "GREATER"}], ",", " ", 
         
         RowBox[{"THEN", " ", "RETURN", " ", "0", " ", "PROBABILITY"}]}], " ",
         "*)"}], "\[IndentingNewLine]", "0"}], "]"}]}], "\[IndentingNewLine]",
     "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.6760570728175077`*^9, {3.688495054072056*^9, 3.6884952444872713`*^9}, {
   3.688495278909875*^9, 3.688495304110862*^9}, {3.6884953345264893`*^9, 
   3.688495345926388*^9}, {3.688702932224207*^9, 3.6887029731882887`*^9}, {
   3.688704265758654*^9, 3.6887042966066017`*^9}, {3.688704328447584*^9, 
   3.688704334533352*^9}, {3.688704432118758*^9, 3.6887045030850563`*^9}, {
   3.688704561724106*^9, 3.688704584512712*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CalcEstablishmentTime", "[", "pfix_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIALBES"}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ran", ",", "v0"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "GET", " ", "INITIAL", " ", "SIZE", " ", "OF", " ", "ESTABLISHED", " ", 
       "MUTANT"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ran", "=", 
       RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v0", "=", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", "ran"}], "]"}], "pfix"]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "RETURN", " ", "ESTABLISHEMENT", " ", "TIME", " ", "AND", " ", 
        "INITIAL", " ", "SIZE"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ran", ",", "v0"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{3.67605708473843*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RunSimulationCheckEachMutation2", "[", 
    RowBox[{
    "popsize_", ",", "\[CapitalDelta]c1_", ",", "\[CapitalDelta]c2_", ",", 
     "U1_", ",", "U2_", ",", "maxtime_", ",", "timestepsize_", ",", 
     "initgenotype_", ",", "initgenotypeabundances_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"LOCAL", " ", "VARIABLES"}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "genotypeabundances", ",", "genotypes", ",", "globaltime", ",", 
       "numgenotypes", ",", "system", ",", "sol", ",", "mutationtime", ",", 
       "pfix", ",", "v0", ",", "\[IndentingNewLine]", "establishtimeran", ",",
        "fixation", ",", "fixationran", ",", "timestep", ",", "q", ",", 
       "history", ",", "newmutants", ",", "oldgenotypesindx", ",", 
       "parentindices"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"ivals", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"qvals", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"INITIALIZE", " ", "LOCAL", " ", "VARIABLES"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"genotypes", ",", "genotypeabundances"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"initgenotype", ",", "initgenotypeabundances"}], "}"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"numgenotypes", "=", 
       RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"globaltime", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"timestep", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"timestepsize", ",", "maxtime"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fixation", "=", "False"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Weird", " ", "context", " ", "conflicts", " ", "were", " ", 
        "occuring", " ", "when", " ", "using", " ", "Parallel", " ", "unless",
         " ", "these", " ", "symbols", " ", "have", " ", "already", " ", 
        "been", " ", 
        RowBox[{"used", ".", " ", "Ideally"}], " ", "should", " ", "not", " ",
         "be", " ", 
        RowBox[{"here", "!"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "n1", ",", "n2", ",", "n3", ",", "n4", ",", "n5", ",", "n6", ",", "n7",
         ",", "n8", ",", "n9", ",", "n10", ",", "n11", ",", "n12", ",", "n13",
         ",", "n14", ",", "n15", ",", "n16", ",", "n17", ",", "n18", ",", 
        "n19", ",", "n20", ",", "n21", ",", "n22", ",", "n23", ",", "n24", 
        ",", "n25", ",", "n26", ",", "n27", ",", "n28", ",", "n29", ",", 
        "n30", ",", "n31", ",", "n32", ",", "\[IndentingNewLine]", "n33", ",",
         "n34", ",", "n35", ",", "n36", ",", "n37", ",", "n38", ",", "n39", 
        ",", "n40", ",", "n41", ",", "n42", ",", "n43", ",", "n44", ",", 
        "n45", ",", "n46", ",", "n47", ",", "n48", ",", "n49", ",", "n50", 
        ",", "n51", ",", "n52", ",", "n53", ",", "n54", ",", "n55", ",", 
        "n56", ",", "n57", ",", "n58", ",", "n59", ",", "n60", ",", "n61", 
        ",", "n62", ",", "\[IndentingNewLine]", "n63", ",", "n64", ",", "n65",
         ",", "n66", ",", "n67", ",", "n68", ",", "n69", ",", "n70", ",", 
        "n71", ",", "n72", ",", "n73", ",", "n74", ",", "n75", ",", "n76", 
        ",", "n77", ",", "n78", ",", "n79", ",", "n80", ",", "n81", ",", 
        "n82", ",", "n83", ",", "n84", ",", "n85", ",", "n86", ",", "n87", 
        ",", "n88", ",", "n89", ",", "n90", ",", "n91", ",", "n92", ",", 
        "\[IndentingNewLine]", "n93", ",", "n94", ",", "n95", ",", "n96", ",",
         "n97", ",", "n98", ",", "n99", ",", "n100"}], "}"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"MAIN", " ", "CODE", " ", "FOR", " ", "SIMULATION"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"history", "=", "\[IndentingNewLine]", 
       RowBox[{"Reap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"collectMyData", "[", 
          RowBox[{
          "fulldata", ",", "globaltime", ",", "0", ",", "genotypes", ",", 
           "genotypeabundances", ",", "popsize", ",", "\[CapitalDelta]c1", 
           ",", "\[CapitalDelta]c2", ",", "0", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"globaltime", "<", "maxtime"}], " ", "\[IndentingNewLine]",
            "\[IndentingNewLine]", ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "WHILE", " ", "LOCAL", " ", "TIME", " ", "OF", " ", "SIMULATION", 
             " ", "IS", " ", "LESS", " ", "THAN", " ", "maxtime"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", "veryverbose", ")"}], ",", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Step starting at time = \>\"", ",", "globaltime", ",", 
                 "\"\<, next time step size = \>\"", ",", "timestep", ",", 
                 "\"\<, genotypeabundances = \>\"", ",", 
                 "genotypeabundances"}], "]"}], ";"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"time3", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", 
             RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"system", ",", "sol"}], "}"}], "=", 
             RowBox[{"SolveDiffEqs", "[", 
              RowBox[{
              "popsize", ",", "\[CapitalDelta]c1", ",", "\[CapitalDelta]c2", 
               ",", "genotypeabundances", ",", "genotypes", ",", "timestep"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"time3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"time3", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", 
              RowBox[{"AbsoluteTime", "[", "]"}], "-", 
              RowBox[{"time3", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"fixation", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{"pfix", "=", "0"}], ";", "\[IndentingNewLine]", 
            RowBox[{"mutationtime", "=", "0"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"GET", " ", "NEXT", " ", "ESTABLISHING", " ", "MUTANT"}],
              " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "mutationtime", ",", "newmutants", ",", "fixation", ",", "pfix",
                ",", "parentindices"}], "}"}], "=", 
             RowBox[{"NextMutation", "[", 
              RowBox[{
              "popsize", ",", "\[CapitalDelta]c1", ",", "\[CapitalDelta]c2", 
               ",", "U1", ",", "U2", ",", "sol", ",", "genotypes", ",", 
               "genotypeabundances", ",", "mutationtime", ",", "timestep"}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "ASSIGN", " ", "NEW", " ", "MUTATION", " ", "THAT", " ", "HAS", 
               " ", "ESTABLISHED", " ", "BEFORE", " ", "timestep", " ", "AN", 
               " ", "ABUNDANCE", " ", "AND", " ", "UPDATE", " ", "GENOTYPE", 
               " ", "INFO"}], ",", " ", 
              RowBox[{"IF", " ", "IT", " ", "EXISTS"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"fixation", " ", "&&", " ", 
                RowBox[{"mutationtime", "<", "timestep"}]}], ")"}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "IF", " ", "MUTANT", " ", "HAS", " ", "ESTABLISHED", " ", 
                 "BEFORE", " ", "timestep"}], ",", " ", 
                RowBox[{
                "GET", " ", "ITS", " ", "INITIAL", " ", "SIZE", " ", "AND", 
                 " ", "UPDATE", " ", 
                 RowBox[{"genotypes", "/", "genotypeabundances"}], " ", "AND",
                  " ", "PRUNE", " ", "CLASSES"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"establishtimeran", ",", "v0"}], "}"}], "=", 
                RowBox[{"CalcEstablishmentTime", "[", "pfix", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"(", "veryverbose", ")"}], ",", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<establishes at freq=\>\"", ",", "v0", ",", " ", 
                    "\"\< at local time=\>\"", ",", "mutationtime", ",", 
                    "\"\<+global time \>\"", ",", "globaltime"}], "]"}], 
                  ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"globaltime", "=", 
                RowBox[{"globaltime", "+", "mutationtime"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"timestep", "=", 
                RowBox[{"timestep", "-", "mutationtime"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"genotypeabundances", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", 
                   RowBox[{"t", "\[Rule]", "mutationtime"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "genotypes", ",", "genotypeabundances", ",", 
                  "oldgenotypesindx"}], "}"}], "=", 
                RowBox[{"PruneUnfitClasses", "[", 
                 RowBox[{"genotypes", ",", "genotypeabundances"}], "]"}]}], 
               ";", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                "odlgenotypesindx", " ", "stores", " ", "old", " ", "index", 
                 " ", "of", " ", "new", " ", "trimmed", " ", "genotypes", " ",
                  "list"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"genotypeabundances", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"oldgenotypesindx", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", 
                    RowBox[{"t", "\[Rule]", "mutationtime"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "oldgenotypesindx", "]"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"{", "v0", "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"genotypes", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"genotypes", ",", "newmutants"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"numgenotypes", "=", 
                RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"(", "veryverbose", ")"}], ",", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<add a genotype class, genotypeabundances = \>\"", ",",
                     "genotypeabundances", ",", " ", "\"\< time = \>\"", ",", 
                    "mutationtime", ",", "\"\<, global time \>\"", ",", 
                    "globaltime", ",", " ", "\"\< genotypes=\>\"", ",", 
                    "genotypes"}], "]"}], ";"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"collectMyData", "[", 
                RowBox[{
                "fulldata", ",", "globaltime", ",", "0", ",", "genotypes", 
                 ",", "genotypeabundances", ",", "popsize", ",", 
                 "\[CapitalDelta]c1", ",", "\[CapitalDelta]c2", ",", "pfix", 
                 ",", 
                 RowBox[{"newmutants", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "ELSE", " ", "NO", " ", "NEW", " ", "MUTANT", " ", 
                 "ESTABLISHED"}], ",", " ", 
                RowBox[{
                "SO", " ", "JUST", " ", "PRUNE", " ", "CLASSES", " ", "AND", 
                 " ", "PROGRESS", " ", "TO", " ", "timestep"}]}], " ", "*)"}],
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fixation", "=", "False"}], ";", "\[IndentingNewLine]", 
               RowBox[{"globaltime", "=", 
                RowBox[{"globaltime", "+", "timestep"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"genotypeabundances", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", 
                   RowBox[{"t", "\[Rule]", "timestep"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "numgenotypes"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"timestep", "=", 
                RowBox[{"Min", "[", 
                 RowBox[{"timestepsize", ",", 
                  RowBox[{"maxtime", "-", "globaltime"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"(", "veryverbose", ")"}], ",", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<time step reached at \>\"", ",", " ", "timestep", 
                    ",", "\"\< before mutant at time \>\"", ",", 
                    "mutationtime", ",", "\"\<+\>\"", ",", "globaltime", ",", 
                    "\"\<=\>\"", ",", 
                    RowBox[{"mutationtime", "+", "globaltime"}], ",", 
                    "\"\< abundances=\>\"", ",", "genotypeabundances"}], 
                   "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "genotypes", ",", "genotypeabundances", ",", 
                  "oldgenotypesindx"}], "}"}], "=", 
                RowBox[{"PruneUnfitClasses", "[", 
                 RowBox[{"genotypes", ",", "genotypeabundances"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"numgenotypes", "=", 
                RowBox[{"getNumGenotypes", "[", "genotypes", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"collectMyData", "[", 
                RowBox[{
                "fulldata", ",", "globaltime", ",", "0", ",", "genotypes", 
                 ",", "genotypeabundances", ",", "popsize", ",", 
                 "\[CapitalDelta]c1", ",", "\[CapitalDelta]c2", ",", "0", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "]"}], 
         RowBox[{"(*", 
          RowBox[{"END", "-", "WHILE", "-", "LOOP"}], "*)"}], ";"}], 
        "\[IndentingNewLine]", "]"}]}], 
      RowBox[{"(*", 
       RowBox[{"END", "-", "REAP"}], "*)"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"RETURN", " ", "history"}], " ", "*)"}], "\[IndentingNewLine]",
       "history"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 PageWidth->Infinity,
 CellChangeTimes->{{3.670356562190632*^9, 3.670356567643033*^9}, {
   3.670356693408765*^9, 3.670356710731172*^9}, {3.670356807531117*^9, 
   3.6703568257650003`*^9}, {3.670356862160179*^9, 3.670356871153842*^9}, {
   3.67035694380952*^9, 3.670356953576495*^9}, {3.670356985759572*^9, 
   3.67035699268412*^9}, {3.670357033929352*^9, 3.670357041410798*^9}, {
   3.670357239351856*^9, 3.670357316284492*^9}, {3.670357392261166*^9, 
   3.670357393340271*^9}, {3.6703574382955437`*^9, 3.6703574408478737`*^9}, {
   3.670357723027022*^9, 3.6703577235488243`*^9}, {3.670359709642407*^9, 
   3.670359834821047*^9}, {3.670360565381609*^9, 3.6703605685879*^9}, {
   3.6703606043738623`*^9, 3.670360651244526*^9}, {3.6703607296486692`*^9, 
   3.67036073515836*^9}, {3.6703607790714397`*^9, 3.670360847021422*^9}, {
   3.670361918124465*^9, 3.670362012670764*^9}, {3.670362077384261*^9, 
   3.6703620859434347`*^9}, {3.670362258961775*^9, 3.670362283670586*^9}, {
   3.670362338548586*^9, 3.670362340113411*^9}, {3.6703646936317167`*^9, 
   3.670364718469558*^9}, {3.670364773911393*^9, 3.6703648556097803`*^9}, {
   3.670365341275918*^9, 3.670365353570187*^9}, {3.6703658337925873`*^9, 
   3.670365859401249*^9}, {3.670516779082911*^9, 3.6705168402920322`*^9}, {
   3.670516900500416*^9, 3.670516993430625*^9}, {3.670523364798726*^9, 
   3.670523377202325*^9}, {3.670523463200057*^9, 3.670523490498218*^9}, 
   3.670523565137623*^9, {3.670523707724503*^9, 3.670523735680366*^9}, 
   3.670523780266176*^9, {3.670523823756312*^9, 3.670523851685417*^9}, {
   3.670523972230878*^9, 3.670524009821166*^9}, {3.6705240719958763`*^9, 
   3.670524160411227*^9}, {3.670524194415951*^9, 3.670524246722595*^9}, {
   3.670524293397299*^9, 3.670524296772727*^9}, {3.670524349035576*^9, 
   3.670525033210642*^9}, {3.6705250972354307`*^9, 3.670525953821394*^9}, {
   3.6705259885761967`*^9, 3.670526186975424*^9}, {3.67052622847024*^9, 
   3.670526334174573*^9}, {3.670526504292678*^9, 3.6705265076348677`*^9}, {
   3.670526565054915*^9, 3.6705268845202827`*^9}, {3.6705269721217823`*^9, 
   3.670527008567441*^9}, {3.6705270460735893`*^9, 3.6705270832388783`*^9}, {
   3.670527116953678*^9, 3.6705273832576923`*^9}, {3.6705274429563828`*^9, 
   3.670527499209242*^9}, {3.67052754124842*^9, 3.670527574670185*^9}, 
   3.670527826401846*^9, 3.670528071735876*^9, 3.6705281738248262`*^9, {
   3.670528270480358*^9, 3.67052827864258*^9}, {3.670528358394718*^9, 
   3.670528485842485*^9}, {3.670528554345542*^9, 3.670528634609971*^9}, 
   3.6705286752348423`*^9, 3.670528706169422*^9, {3.670528747952447*^9, 
   3.670528843644143*^9}, {3.670528882239346*^9, 3.67052895920405*^9}, {
   3.6705289946439943`*^9, 3.670529097423847*^9}, {3.6705291665343*^9, 
   3.670529177423895*^9}, 3.67052928871332*^9, {3.6705293998547993`*^9, 
   3.670529400182781*^9}, {3.670529457349422*^9, 3.670529532356968*^9}, {
   3.670529730480777*^9, 3.670529793022018*^9}, {3.670529825238182*^9, 
   3.670529835298493*^9}, {3.6705299236020308`*^9, 3.670530036566554*^9}, {
   3.670530074053618*^9, 3.670530107832684*^9}, {3.670530138346479*^9, 
   3.6705301692949333`*^9}, {3.6705311540518017`*^9, 3.670531159062324*^9}, {
   3.6705312032253923`*^9, 3.6705312330911818`*^9}, {3.670531297168397*^9, 
   3.670531331363014*^9}, {3.670531362933538*^9, 3.670531433807078*^9}, 
   3.670531574612813*^9, 3.670531643561922*^9, {3.670531910371409*^9, 
   3.670531922221066*^9}, {3.670532252646906*^9, 3.670532254701584*^9}, {
   3.67053230825454*^9, 3.670532317303954*^9}, {3.670532411135992*^9, 
   3.670532414520883*^9}, {3.67053252552943*^9, 3.670532758547863*^9}, {
   3.670532860217764*^9, 3.670532888078017*^9}, {3.670532940182729*^9, 
   3.670532974595663*^9}, {3.670533315363595*^9, 3.670533370794919*^9}, {
   3.670534014854618*^9, 3.670534033421879*^9}, {3.670534400166285*^9, 
   3.670534606020483*^9}, {3.6705346459664593`*^9, 3.670534672105516*^9}, {
   3.67053501132838*^9, 3.670535023352476*^9}, {3.6705354052316732`*^9, 
   3.67053545382314*^9}, {3.670535601784696*^9, 3.6705356730325317`*^9}, {
   3.6705357553947573`*^9, 3.6705357768684883`*^9}, {3.6705359473618393`*^9, 
   3.6705359483509817`*^9}, {3.670536069346773*^9, 3.670536070074139*^9}, {
   3.6705362282242126`*^9, 3.670536232345647*^9}, {3.670536502360993*^9, 
   3.670536508769745*^9}, {3.670536603692418*^9, 3.67053665853302*^9}, {
   3.6705367076989527`*^9, 3.670536708155847*^9}, {3.670536789965708*^9, 
   3.670536791436079*^9}, {3.670536842459796*^9, 3.670536842935246*^9}, {
   3.670537414845881*^9, 3.6705376031120977`*^9}, {3.670537736022749*^9, 
   3.670537756296533*^9}, {3.6705380961508837`*^9, 3.670538114402482*^9}, {
   3.6705386432388268`*^9, 3.670538780149303*^9}, {3.670538903069407*^9, 
   3.670538910349527*^9}, {3.6705389702811327`*^9, 3.67053897832115*^9}, {
   3.670539013595799*^9, 3.67053905488877*^9}, {3.6705391201163177`*^9, 
   3.670539120547078*^9}, {3.6705398988850603`*^9, 3.6705399222435207`*^9}, {
   3.670540026032256*^9, 3.6705400774509172`*^9}, {3.670540211297657*^9, 
   3.670540235511104*^9}, {3.670540265993376*^9, 3.670540324521476*^9}, {
   3.670540871055225*^9, 3.670540923109696*^9}, {3.670540960907531*^9, 
   3.6705410776452923`*^9}, {3.6705411091428843`*^9, 
   3.6705411092866497`*^9}, {3.67054118069937*^9, 3.6705412009870853`*^9}, {
   3.67054263798612*^9, 3.670542642202742*^9}, 3.670542810202125*^9, {
   3.670542854152804*^9, 3.670542957300795*^9}, {3.670543003796193*^9, 
   3.670543081619728*^9}, {3.670543320604617*^9, 3.670543353890668*^9}, 
   3.670543594156927*^9, {3.6705436965881033`*^9, 3.670543697240726*^9}, {
   3.6705437981853313`*^9, 3.6705438680670643`*^9}, {3.670543908903754*^9, 
   3.670543909374093*^9}, {3.670543941134489*^9, 3.67054394599268*^9}, {
   3.6705440197190228`*^9, 3.67054402001597*^9}, {3.670544131421336*^9, 
   3.6705441564550037`*^9}, {3.670544492526307*^9, 3.6705444935838633`*^9}, {
   3.670544691291791*^9, 3.6705447011075563`*^9}, {3.670544938214341*^9, 
   3.670544940795288*^9}, {3.6705451158577137`*^9, 3.670545120590414*^9}, {
   3.670545197953994*^9, 3.670545209089452*^9}, {3.670545376588293*^9, 
   3.670545377767112*^9}, {3.670545427228798*^9, 3.670545470717579*^9}, {
   3.670545509423564*^9, 3.670545512812866*^9}, {3.67054559361694*^9, 
   3.670545609632379*^9}, {3.670545672906041*^9, 3.670545673271845*^9}, {
   3.670545763677589*^9, 3.6705457718461113`*^9}, {3.6705464717355003`*^9, 
   3.670546479828764*^9}, 3.670546903349882*^9, {3.670546974277256*^9, 
   3.670547083005207*^9}, {3.670547113757298*^9, 3.670547136781336*^9}, {
   3.6705473108618813`*^9, 3.670547369981491*^9}, {3.6705486834636917`*^9, 
   3.670548699311245*^9}, {3.670548900335397*^9, 3.670548934500874*^9}, {
   3.6705490250348883`*^9, 3.670549038127067*^9}, {3.670549080022711*^9, 
   3.6705490904740677`*^9}, {3.670549130816181*^9, 3.6705491435036297`*^9}, {
   3.670549305555669*^9, 3.6705493105193644`*^9}, {3.670549378599478*^9, 
   3.670549422808186*^9}, {3.6705495442433853`*^9, 3.670549550904387*^9}, {
   3.6705496249027576`*^9, 3.670549625378272*^9}, {3.670549781290946*^9, 
   3.670549803433857*^9}, {3.6705505601499*^9, 3.670550615760517*^9}, {
   3.67055100149368*^9, 3.670551077181278*^9}, {3.670551198924508*^9, 
   3.670551255200418*^9}, {3.670551294401877*^9, 3.670551313347643*^9}, {
   3.670551380728045*^9, 3.670551382906291*^9}, {3.670551860490925*^9, 
   3.670551915734779*^9}, {3.670552226834111*^9, 3.670552249769073*^9}, {
   3.670586953558219*^9, 3.670586954924114*^9}, {3.67058827873197*^9, 
   3.6705882936037827`*^9}, {3.6705885090384703`*^9, 3.670588509373764*^9}, {
   3.670588548021658*^9, 3.67058856940521*^9}, {3.6711940654913816`*^9, 
   3.671194080793737*^9}, {3.671199707513309*^9, 3.671199729255982*^9}, {
   3.671200731738317*^9, 3.6712007589457912`*^9}, {3.671200801276085*^9, 
   3.6712009487720213`*^9}, {3.671201005572872*^9, 3.6712010341466007`*^9}, {
   3.671201082469863*^9, 3.671201109816463*^9}, {3.671201149754551*^9, 
   3.671201183307169*^9}, {3.6712016213724613`*^9, 3.671201628743011*^9}, 
   3.671201682813333*^9, {3.671201916132823*^9, 3.671201919172264*^9}, {
   3.671202282410433*^9, 3.671202343004863*^9}, {3.671202492533311*^9, 
   3.671202522252872*^9}, {3.6712028423508797`*^9, 3.671202915805457*^9}, {
   3.671203131919198*^9, 3.6712031448347073`*^9}, {3.67120324274104*^9, 
   3.671203251518977*^9}, {3.671203303309552*^9, 3.6712033454981833`*^9}, {
   3.6712033778001328`*^9, 3.671203408527597*^9}, {3.671203548038331*^9, 
   3.6712035543466663`*^9}, {3.671203601884531*^9, 3.6712038170340347`*^9}, {
   3.6712045343874483`*^9, 3.671204534486915*^9}, {3.671204627639621*^9, 
   3.6712046277317057`*^9}, {3.671204880972237*^9, 3.671204883337672*^9}, {
   3.67120686737704*^9, 3.671206932757902*^9}, {3.671207029372373*^9, 
   3.671207048769476*^9}, {3.671207134049567*^9, 3.671207134554914*^9}, {
   3.67120759043025*^9, 3.671207611188944*^9}, {3.671208411071556*^9, 
   3.671208419457506*^9}, {3.671208451175344*^9, 3.671208451873219*^9}, {
   3.671208526657365*^9, 3.671208530604973*^9}, {3.671208852600308*^9, 
   3.67120920013632*^9}, {3.6712095220527678`*^9, 3.6712095224432*^9}, {
   3.671210895833181*^9, 3.671210979984849*^9}, {3.671211278340674*^9, 
   3.671211287787136*^9}, {3.671211323095389*^9, 3.671211353713006*^9}, {
   3.6712114245246677`*^9, 3.671211427110957*^9}, {3.671211556195915*^9, 
   3.671211558842135*^9}, {3.671211589696371*^9, 3.67121160397545*^9}, 
   3.671211653059739*^9, {3.671211806616798*^9, 3.671211826280311*^9}, {
   3.671211897557344*^9, 3.671211899880557*^9}, 3.671211936072083*^9, {
   3.671212183288465*^9, 3.671212230363537*^9}, {3.6712123010224047`*^9, 
   3.671212484558601*^9}, {3.671212526345896*^9, 3.67121252661933*^9}, {
   3.671212604153481*^9, 3.6712126082223*^9}, {3.671212937376696*^9, 
   3.6712129535598*^9}, {3.671214629641066*^9, 3.671214656477254*^9}, {
   3.671215413394806*^9, 3.671215426035392*^9}, {3.671215820841425*^9, 
   3.671215840265011*^9}, {3.671216028448979*^9, 3.6712160376448298`*^9}, {
   3.671216268043681*^9, 3.6712162685435534`*^9}, {3.6712163509957*^9, 
   3.671216359299574*^9}, {3.6712165001284037`*^9, 3.671216500907797*^9}, {
   3.671218535642226*^9, 3.6712185439605637`*^9}, {3.671221987720746*^9, 
   3.6712220201312304`*^9}, {3.671222213831801*^9, 3.67122222352055*^9}, {
   3.6716385511762743`*^9, 3.6716385731616488`*^9}, {3.671638734361377*^9, 
   3.6716387346644*^9}, {3.671638766074671*^9, 3.671638836684657*^9}, 
   3.671640764411723*^9, {3.6716409061674633`*^9, 3.671640945995964*^9}, 
   3.6716461373130207`*^9, {3.671646496245761*^9, 3.671646534408902*^9}, 
   3.6716466871487722`*^9, {3.6716467531474733`*^9, 3.6716467726451197`*^9}, {
   3.671647961184664*^9, 3.671647994747402*^9}, {3.6716487164225197`*^9, 
   3.671648771928178*^9}, {3.671649024324279*^9, 3.67164902766835*^9}, {
   3.671654379008458*^9, 3.671654411277875*^9}, 3.671654457525532*^9, 
   3.671655283342457*^9, 3.67173330761314*^9, {3.67173471960561*^9, 
   3.671734719779223*^9}, {3.671737961963223*^9, 3.671738004040555*^9}, {
   3.671742737443988*^9, 3.671742750314929*^9}, {3.6717428124328423`*^9, 
   3.671742820482506*^9}, {3.671743461057829*^9, 3.6717434641117563`*^9}, {
   3.6718425809602957`*^9, 3.671842582323599*^9}, {3.6724071124393997`*^9, 
   3.672407210399076*^9}, {3.672407387937533*^9, 3.672407390313285*^9}, {
   3.672407446379964*^9, 3.6724074916042957`*^9}, {3.672408220545745*^9, 
   3.672408232681695*^9}, {3.672667627893003*^9, 3.672667655194415*^9}, {
   3.6726677395404587`*^9, 3.67266774739662*^9}, {3.672667779276676*^9, 
   3.6726678435909843`*^9}, {3.672667886548992*^9, 3.672668047214531*^9}, {
   3.6726680799108467`*^9, 3.672668312354904*^9}, {3.6726684003987293`*^9, 
   3.672668430607095*^9}, {3.672668472694881*^9, 3.6726685555112667`*^9}, {
   3.6726685855272617`*^9, 3.672668637319372*^9}, {3.672668742735978*^9, 
   3.6726688011626*^9}, {3.672668891083778*^9, 3.672668922452417*^9}, {
   3.67266895883585*^9, 3.6726690303263407`*^9}, {3.672669134809958*^9, 
   3.672669146373296*^9}, {3.672669247011711*^9, 3.672669283516217*^9}, {
   3.672669352043758*^9, 3.672669373322082*^9}, 3.67266942268687*^9, {
   3.6726697347186003`*^9, 3.6726697516521597`*^9}, {3.672689011426238*^9, 
   3.672689044806589*^9}, {3.6726891245788116`*^9, 3.672689145318737*^9}, {
   3.672689183941723*^9, 3.672689290097014*^9}, {3.672689358723166*^9, 
   3.672689369085565*^9}, {3.67268962325987*^9, 3.672689727690465*^9}, {
   3.672689822470252*^9, 3.6726898735505238`*^9}, {3.672689913738142*^9, 
   3.6726899201738567`*^9}, {3.6726899622609158`*^9, 3.672690106149609*^9}, {
   3.672690256230131*^9, 3.672690274503188*^9}, 3.6726903406064*^9, {
   3.672690415064909*^9, 3.672690656738212*^9}, {3.672690697183647*^9, 
   3.672690711591754*^9}, {3.6726907962826853`*^9, 3.672690840550642*^9}, 
   3.672690987282339*^9, {3.6726910179071503`*^9, 3.6726911268437443`*^9}, {
   3.672691168049294*^9, 3.672691174305048*^9}, {3.672691296913415*^9, 
   3.672691630291977*^9}, {3.672691730974183*^9, 3.67269174723531*^9}, {
   3.672691779380065*^9, 3.672691786445977*^9}, {3.672691831193062*^9, 
   3.672691857291298*^9}, {3.6726918910996227`*^9, 3.672691906571472*^9}, {
   3.6726919424034033`*^9, 3.6726919710113993`*^9}, {3.672692025523993*^9, 
   3.6726921249641647`*^9}, {3.672692373378798*^9, 3.672692397463386*^9}, {
   3.67269252810394*^9, 3.672692550112605*^9}, {3.672692594134253*^9, 
   3.672692766458047*^9}, {3.672692824505804*^9, 3.672692853980986*^9}, {
   3.672692885233768*^9, 3.672693094279583*^9}, {3.6726931305951138`*^9, 
   3.6726931398587027`*^9}, {3.672693524387909*^9, 3.672693551548135*^9}, {
   3.6726935998847713`*^9, 3.672693632749387*^9}, {3.6726937259568768`*^9, 
   3.672693843370707*^9}, 3.672693944613657*^9, {3.67269400844032*^9, 
   3.672694067189702*^9}, {3.67269409898378*^9, 3.672694112539206*^9}, {
   3.672694187083549*^9, 3.672694189222487*^9}, {3.672694246525628*^9, 
   3.6726943536472473`*^9}, {3.672694391943015*^9, 3.672694505181711*^9}, {
   3.672694559350322*^9, 3.672694577814125*^9}, {3.672694655718596*^9, 
   3.6726946930611486`*^9}, {3.672694723990568*^9, 3.672694724943056*^9}, {
   3.672694855166526*^9, 3.672694913155439*^9}, {3.6726951553099422`*^9, 
   3.672695203101695*^9}, {3.67269536826511*^9, 3.6726953821282473`*^9}, {
   3.672695552854991*^9, 3.6726955738793983`*^9}, {3.672695752262329*^9, 
   3.672695752365918*^9}, {3.672695824490589*^9, 3.6726958792152853`*^9}, {
   3.6726959431211042`*^9, 3.6726959670481873`*^9}, {3.672696017918066*^9, 
   3.6726960274815683`*^9}, {3.67269613970462*^9, 3.6726962229860067`*^9}, {
   3.672696287737165*^9, 3.672696328547615*^9}, {3.67269747154923*^9, 
   3.672697472038979*^9}, {3.6726976914140797`*^9, 3.672697695460619*^9}, {
   3.672698102387224*^9, 3.672698105180998*^9}, {3.672700035264449*^9, 
   3.672700040152289*^9}, {3.672700084672333*^9, 3.672700087320628*^9}, {
   3.672700708068287*^9, 3.6727007117081633`*^9}, {3.6727007995159807`*^9, 
   3.672700803338045*^9}, {3.672701089065866*^9, 3.6727010919369802`*^9}, {
   3.672701484781591*^9, 3.672701497144752*^9}, {3.672701560355649*^9, 
   3.6727015682250757`*^9}, {3.672701677753438*^9, 3.6727016928572617`*^9}, 
   3.6727017587797937`*^9, {3.672701807251649*^9, 3.6727018077472687`*^9}, {
   3.672701854353104*^9, 3.672701878565934*^9}, {3.672702057929041*^9, 
   3.672702061744937*^9}, {3.6727021234171047`*^9, 3.672702180689454*^9}, {
   3.672702218665371*^9, 3.67270224271599*^9}, {3.6727023372226152`*^9, 
   3.672702356533304*^9}, {3.672702400161747*^9, 3.672702475109668*^9}, {
   3.672702570700927*^9, 3.672702571142228*^9}, {3.672702636017701*^9, 
   3.672702703568791*^9}, {3.67270273385254*^9, 3.6727027347396*^9}, {
   3.672702807871664*^9, 3.672702811483864*^9}, {3.6727529627228603`*^9, 
   3.672752979883024*^9}, {3.672753129734693*^9, 3.672753130282076*^9}, {
   3.672753696974927*^9, 3.672753697108047*^9}, 3.67301208212906*^9, {
   3.6730322972644587`*^9, 3.673032304888184*^9}, {3.673098271982088*^9, 
   3.673098281902074*^9}, {3.673101061992713*^9, 3.6731010928408623`*^9}, {
   3.67310178520047*^9, 3.673101820768058*^9}, {3.673101876656198*^9, 
   3.6731018837285633`*^9}, {3.673101927024683*^9, 3.673101941432461*^9}, {
   3.6731020301070757`*^9, 3.6731020662405367`*^9}, {3.673358025075101*^9, 
   3.673358115418865*^9}, {3.673358165658869*^9, 3.6733581805141573`*^9}, {
   3.673358250105185*^9, 3.6733584613533907`*^9}, 3.673358661304319*^9, {
   3.673358967757855*^9, 3.6733590035256166`*^9}, {3.673874817913553*^9, 
   3.673874917256021*^9}, {3.6738749685463123`*^9, 3.673874984842207*^9}, 
   3.673877075691533*^9, {3.6738875993359833`*^9, 3.6738876013905573`*^9}, {
   3.6738876605762444`*^9, 3.673887709029273*^9}, 3.673888007843915*^9, {
   3.6738882524999228`*^9, 3.673888271283836*^9}, {3.6738883377377357`*^9, 
   3.67388834674135*^9}, {3.6738886113558397`*^9, 3.673888652243003*^9}, {
   3.673888707700097*^9, 3.6738887308344193`*^9}, {3.673891909775126*^9, 
   3.673891915972452*^9}, {3.6738949101254883`*^9, 3.673894955517169*^9}, {
   3.673895004301632*^9, 3.673895040812294*^9}, {3.67389509656043*^9, 
   3.673895113555835*^9}, {3.6739019536232233`*^9, 3.67390195959647*^9}, {
   3.673901995605878*^9, 3.673902059752323*^9}, {3.673902090853119*^9, 
   3.673902094812497*^9}, {3.6739033080192547`*^9, 3.673903310722788*^9}, {
   3.673903375076022*^9, 3.673903378009913*^9}, {3.673903734485278*^9, 
   3.673903736746828*^9}, {3.673904556289222*^9, 3.6739045769191723`*^9}, {
   3.673904760102078*^9, 3.673904810167603*^9}, 3.673906316462513*^9, 
   3.673906862727273*^9, 3.673906894778244*^9, {3.6739069759109163`*^9, 
   3.6739069791259317`*^9}, {3.673907687048004*^9, 3.673907734416007*^9}, {
   3.673980640599923*^9, 3.6739806410445147`*^9}, {3.674211377975418*^9, 
   3.674211454469534*^9}, {3.674211681028718*^9, 3.674211683262289*^9}, {
   3.6742118312275133`*^9, 3.6742119378369226`*^9}, {3.67421270242515*^9, 
   3.67421271783281*^9}, {3.674212794200244*^9, 3.674212826918982*^9}, {
   3.6742409601830187`*^9, 3.6742409798948803`*^9}, {3.6742427859287252`*^9, 
   3.674242788599822*^9}, {3.6742435455748463`*^9, 3.674243575568511*^9}, {
   3.674244107045616*^9, 3.6742441578368587`*^9}, {3.674248146569025*^9, 
   3.674248147824648*^9}, {3.674248474542336*^9, 3.674248524526622*^9}, {
   3.674248676541396*^9, 3.674248688363146*^9}, {3.6742487235025167`*^9, 
   3.674248807116983*^9}, 3.6742489704306602`*^9, {3.6742490355443687`*^9, 
   3.6742490619659348`*^9}, {3.6742492033108387`*^9, 
   3.6742492331107817`*^9}, {3.67424929212682*^9, 3.674249408694014*^9}, {
   3.674249449913291*^9, 3.674249512337346*^9}, {3.674249544233197*^9, 
   3.6742495454066343`*^9}, {3.674249613822822*^9, 3.674249663504469*^9}, {
   3.674249796963423*^9, 3.6742497989818983`*^9}, {3.674249852433365*^9, 
   3.674249996755879*^9}, {3.6742501171241426`*^9, 3.674250122276148*^9}, {
   3.6742501985826387`*^9, 3.674250201742154*^9}, {3.674250238231061*^9, 
   3.674250359041584*^9}, {3.6742996530171537`*^9, 3.674299863008119*^9}, {
   3.6742999394414253`*^9, 3.6743000104326143`*^9}, {3.674301427391222*^9, 
   3.67430149153786*^9}, {3.674301523251935*^9, 3.6743015620399733`*^9}, {
   3.674301595660828*^9, 3.67430161392607*^9}, {3.674301657180964*^9, 
   3.6743016966962442`*^9}, {3.674301733103218*^9, 3.674301871217772*^9}, {
   3.674301943013172*^9, 3.67430195447812*^9}, {3.6743019955890207`*^9, 
   3.674302027987605*^9}, {3.674302078423712*^9, 3.6743021256987553`*^9}, {
   3.67430216578376*^9, 3.67430222351124*^9}, {3.674302267613106*^9, 
   3.674302493443345*^9}, {3.674302634084964*^9, 3.674302685517054*^9}, {
   3.674302780708331*^9, 3.6743028063311*^9}, {3.674302845460978*^9, 
   3.67430287427168*^9}, {3.6743033328080053`*^9, 3.674303376831204*^9}, {
   3.674303516527814*^9, 3.674303523395761*^9}, {3.674303932152179*^9, 
   3.674304041208248*^9}, 3.674304873373579*^9, 3.6743050159308233`*^9, {
   3.6743051297394857`*^9, 3.674305140745101*^9}, {3.674305238749601*^9, 
   3.674305297444996*^9}, {3.674306246397758*^9, 3.6743062826777*^9}, {
   3.67430631979215*^9, 3.674306395709548*^9}, {3.674308656461747*^9, 
   3.674308660589966*^9}, {3.6743086966783524`*^9, 3.674308740730666*^9}, {
   3.674308778843265*^9, 3.6743087806005983`*^9}, {3.6743093775854673`*^9, 
   3.674309413336793*^9}, {3.6743094544435883`*^9, 3.674309483867872*^9}, {
   3.6743095994088507`*^9, 3.6743096711395884`*^9}, {3.6743101220279303`*^9, 
   3.674310154693549*^9}, {3.6743102638356752`*^9, 3.6743102724535427`*^9}, {
   3.6743103441851177`*^9, 3.674310397153015*^9}, {3.674310427633232*^9, 
   3.674310432697427*^9}, {3.674313282541847*^9, 3.674313292312448*^9}, {
   3.674313382664526*^9, 3.6743133851872053`*^9}, {3.6743350805814877`*^9, 
   3.6743351096853867`*^9}, {3.674335141237241*^9, 3.6743352042262487`*^9}, {
   3.67434293719524*^9, 3.67434296561924*^9}, {3.674343378287632*^9, 
   3.674343400605236*^9}, {3.674344321745956*^9, 3.674344326260524*^9}, {
   3.674344375946013*^9, 3.674344395756649*^9}, {3.674344434747725*^9, 
   3.674344451059972*^9}, {3.674344521364704*^9, 3.674344524474246*^9}, {
   3.674346183576919*^9, 3.674346262446266*^9}, {3.674346299553946*^9, 
   3.674346339587463*^9}, {3.674346410423072*^9, 3.6743464663933*^9}, {
   3.674346496793838*^9, 3.674346515720117*^9}, {3.67434656623132*^9, 
   3.674346706325735*^9}, {3.674346745424098*^9, 3.6743467913708963`*^9}, {
   3.674346893019315*^9, 3.6743469015448523`*^9}, {3.674347085557316*^9, 
   3.674347086835973*^9}, {3.6743471621534986`*^9, 3.674347172462667*^9}, {
   3.674347229228416*^9, 3.674347263706582*^9}, {3.6743474493846407`*^9, 
   3.674347455711891*^9}, {3.67434748716045*^9, 3.674347506663555*^9}, {
   3.674347583847559*^9, 3.6743475873631496`*^9}, {3.6743486580983458`*^9, 
   3.6743487051469297`*^9}, {3.674409869008679*^9, 3.674409887140244*^9}, {
   3.674409924193639*^9, 3.674409970123204*^9}, {3.674410079978239*^9, 
   3.674410101492516*^9}, 3.6744871906523542`*^9, {3.6760471531214123`*^9, 
   3.676047170677*^9}, {3.676048547819709*^9, 3.676048549423305*^9}, {
   3.676048616616145*^9, 3.676048700056699*^9}, {3.676048798061676*^9, 
   3.676048806136372*^9}, {3.676049106306778*^9, 3.6760492732588654`*^9}, {
   3.67604931427066*^9, 3.6760495029459476`*^9}, {3.6760496400118427`*^9, 
   3.676049666152979*^9}, {3.676049700568548*^9, 3.676049938399273*^9}, {
   3.676050097851817*^9, 3.6760502323341618`*^9}, {3.676050265189188*^9, 
   3.676050456243586*^9}, {3.6760505983396606`*^9, 3.676050725889217*^9}, {
   3.676050819053259*^9, 3.676050883983387*^9}, {3.6760509750434732`*^9, 
   3.676050993779171*^9}, {3.676051174094154*^9, 3.676051215595016*^9}, {
   3.676051247906414*^9, 3.676051281994763*^9}, {3.6760515117992277`*^9, 
   3.676051532945312*^9}, {3.676051574525729*^9, 3.6760516308808737`*^9}, {
   3.676051701373907*^9, 3.676051738187151*^9}, {3.676051768990121*^9, 
   3.6760517713241463`*^9}, {3.676051875375017*^9, 3.676051877066955*^9}, 
   3.676051946292514*^9, {3.676052013153243*^9, 3.676052014753112*^9}, {
   3.67605206152334*^9, 3.676052099456677*^9}, {3.6760522887177153`*^9, 
   3.676052316513753*^9}, {3.676052409730052*^9, 3.6760524422800713`*^9}, {
   3.676053289435965*^9, 3.676053290620812*^9}, {3.676053324845545*^9, 
   3.676053353404633*^9}, {3.676053388513157*^9, 3.676053492047226*^9}, {
   3.676053603425272*^9, 3.6760536994379063`*^9}, {3.676053732819481*^9, 
   3.6760537409668503`*^9}, {3.676053803887218*^9, 3.676053820667923*^9}, {
   3.676053883298531*^9, 3.676053903443747*^9}, {3.6760539349272747`*^9, 
   3.676053961825531*^9}, {3.676054153510824*^9, 3.676054215339883*^9}, {
   3.6760543099133673`*^9, 3.676054325454887*^9}, {3.676054411504983*^9, 
   3.676054433028955*^9}, {3.676054503428403*^9, 3.676054678368531*^9}, 
   3.676054711966275*^9, {3.676054753106022*^9, 3.6760548133113413`*^9}, {
   3.676055533410301*^9, 3.676055973210986*^9}, {3.676056048223258*^9, 
   3.6760561940897293`*^9}, {3.6760568301374273`*^9, 3.676056830320964*^9}, 
   3.676056872559063*^9, {3.676056914066873*^9, 3.676057025438158*^9}, {
   3.676057067158854*^9, 3.676057087970922*^9}, 3.6760575343916807`*^9, {
   3.676057790459848*^9, 3.676057889167351*^9}, {3.676058572113256*^9, 
   3.676058596045274*^9}, {3.676058642791382*^9, 3.676058644013554*^9}, {
   3.676058813787499*^9, 3.676058820285762*^9}, {3.676058881760676*^9, 
   3.67605888720793*^9}, {3.676059331100256*^9, 3.676059335658771*^9}, 
   3.676059770027566*^9, {3.676059830719042*^9, 3.6760599294357233`*^9}, {
   3.6760601138129063`*^9, 3.67606012332051*^9}, {3.679748340894038*^9, 
   3.679748346913802*^9}, {3.679748453387858*^9, 3.679748457200718*^9}, {
   3.679748611824592*^9, 3.679748613408367*^9}, {3.679748698095044*^9, 
   3.679748724496223*^9}, {3.6797488886403112`*^9, 3.6797488894831057`*^9}, {
   3.6797489203128633`*^9, 3.679748988334412*^9}, {3.680263865974887*^9, 
   3.6802639660039787`*^9}, {3.680273205788069*^9, 3.6802732121085873`*^9}, {
   3.688416633173313*^9, 3.688416649754773*^9}, {3.688496329206805*^9, 
   3.688496407311056*^9}, {3.688496570318328*^9, 3.688496616471798*^9}, {
   3.688496670290443*^9, 3.688496742316781*^9}, {3.688496806692589*^9, 
   3.688496817665197*^9}, {3.6884968564135838`*^9, 3.6884969056064463`*^9}, {
   3.688497068167651*^9, 3.688497127973667*^9}, {3.688497163917473*^9, 
   3.688497316093443*^9}, {3.68849743523099*^9, 3.688497522308679*^9}, {
   3.68849755259517*^9, 3.688497552755789*^9}, {3.68849758603631*^9, 
   3.688497675762858*^9}, {3.6884977142518063`*^9, 3.688497717387269*^9}, {
   3.688497759029807*^9, 3.688497773131654*^9}, {3.688497822457529*^9, 
   3.68849782304989*^9}, {3.6884978749959908`*^9, 3.6884979338203487`*^9}, {
   3.68849797215511*^9, 3.6884979732818336`*^9}, {3.68849826021373*^9, 
   3.688498304158477*^9}, {3.68849835973415*^9, 3.688498465429776*^9}, {
   3.6884985047090483`*^9, 3.688498524423489*^9}, {3.688498586375927*^9, 
   3.688498669172081*^9}, {3.688498791811262*^9, 3.688498810210896*^9}, {
   3.688499002313498*^9, 3.688499024257598*^9}, {3.688499069833061*^9, 
   3.6884990889612083`*^9}, {3.688499142425269*^9, 3.6884991753287077`*^9}, {
   3.688499578351625*^9, 3.688499625582683*^9}, {3.688500056949442*^9, 
   3.68850005818894*^9}, {3.688502598449621*^9, 3.6885026051213303`*^9}, {
   3.6885026391722927`*^9, 3.688502680809268*^9}, {3.688502751610351*^9, 
   3.688502776755432*^9}, {3.68869777730236*^9, 3.688697812074387*^9}, {
   3.688699445340794*^9, 3.6886994498212337`*^9}, {3.688701624033401*^9, 
   3.688701641500565*^9}, {3.688705127935446*^9, 3.6887051338484497`*^9}, {
   3.6887052862265053`*^9, 3.688705294461854*^9}, {3.6887057174839783`*^9, 
   3.6887057178280907`*^9}, {3.688740871405038*^9, 3.6887409259968843`*^9}, {
   3.688741355077259*^9, 3.688741356597086*^9}, {3.699369882253406*^9, 
   3.699369887437744*^9}, {3.700586448785181*^9, 3.7005864783296003`*^9}, {
   3.700586641037364*^9, 3.700586656854373*^9}, {3.7005867333912363`*^9, 
   3.7005867487669687`*^9}, {3.7005871437786703`*^9, 3.700587184067267*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"simulateNoseEstablishment", "[", 
    RowBox[{"sol_", ",", "U_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "mutants", "}"}], ","}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"simulate", " ", "apearance", " ", "of", " ", "mutants"}], " ", 
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "simulate", " ", "growth", " ", "of", " ", "current", " ", "mutants"}], 
     "*)"}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7119116168569317`*^9, 3.711911661105701*^9}, {
  3.711911711474403*^9, 3.7119117929715014`*^9}}]
},
ScreenStyleEnvironment->"Condensed",
WindowSize->{1598, 823},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PaperOrientation"->"Landscape",
"PaperSize"->{Automatic, Automatic},
"PostScriptOutputFile"->"/home/kevin/base_code2d.pdf"},
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (December 10, 2015)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> 
  "10.3 for Microsoft Windows (64-bit) (December 10, 2015)", StyleDefinitions -> 
  "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 160, 3, 19, "Input"],
Cell[721, 25, 27410, 701, 542, "Input"],
Cell[28134, 728, 12417, 251, 380, "Input"],
Cell[40554, 981, 14237, 349, 478, "Input"],
Cell[54794, 1332, 22724, 595, 920, "Input"],
Cell[77521, 1929, 11072, 282, 470, "Input"],
Cell[88596, 2213, 8212, 210, 560, "Input"],
Cell[96811, 2425, 16790, 386, 751, "Input"],
Cell[113604, 2813, 32431, 717, 1499, "Input"],
Cell[146038, 3532, 5322, 141, 219, "Input"],
Cell[151363, 3675, 3527, 100, 264, "Input"],
Cell[154893, 3777, 46636, 785, 1317, "Input"],
Cell[201532, 4564, 3025, 85, 129, "Input"]
}
]
*)

(* End of internal cache information *)
